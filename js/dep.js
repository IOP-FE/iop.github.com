define("esui/validator/Validity",["require","underscore"],function(require){function e(){this.states=[],this.stateIndex={},this.customMessage="",this.customValidState=null}var t=require("underscore");return e.prototype.addState=function(e,t){if(this.stateIndex[e]){if(this.stateIndex[e]===t)return;for(var i=0;i<this.states.length;i++)if(this.states[i]===this.stateIndex[e]){this.states.splice(i,1);break}}this.states.push(t),this.stateIndex[e]=t},e.prototype.getState=function(e){return this.stateIndex[e]||null},e.prototype.getStates=function(){return this.states.slice()},e.prototype.getCustomMessage=function(){return this.customMessage},e.prototype.setCustomMessage=function(e){this.customMessage=e},e.prototype.setCustomValidState=function(e){this.customValidState=e},e.prototype.isValid=function(){return t.all(this.getStates(),function(e){return e.getState()})},e.prototype.getValidState=function(){return this.customValidState||(this.isValid()?"valid":"invalid")},e}),define("esui/validator/RequiredRule",["require","./Rule","./ValidityState","../lib","../main"],function(require){function e(){t.apply(this,arguments)}var t=require("./Rule"),i=require("./ValidityState");return e.prototype.type="required",e.prototype.errorMessage="${title}不能为空",e.prototype.check=function(e,t){return new i(!!e,this.getErrorMessage(t))},require("../lib").inherits(e,t),require("../main").registerRule(e,0),e}),define("esui/validator/PatternRule",["require","./Rule","./ValidityState","../lib","../main"],function(require){function e(){t.apply(this,arguments)}var t=require("./Rule"),i=require("./ValidityState");return e.prototype.type="pattern",e.prototype.errorMessage="${title}格式不符合要求",e.prototype.check=function(e,t){var n=new RegExp(this.getLimitCondition(t));return new i(!e||n.test(e),this.getErrorMessage(t))},require("../lib").inherits(e,t),require("../main").registerRule(e,200),e}),define("esui/validator/MinRule",["require","./Rule","./ValidityState","../lib","../main"],function(require){function e(){t.apply(this,arguments)}var t=require("./Rule"),i=require("./ValidityState");return e.prototype.type="min",e.prototype.errorMessage="${title}不能小于${min}",e.prototype.check=function(e,t){var n=+e,r=!isNaN(n)&&n>=this.getLimitCondition(t);return new i(!e||r,this.getErrorMessage(t))},require("../lib").inherits(e,t),require("../main").registerRule(e,300),e}),define("esui/validator/MinLengthRule",["require","./Rule","./ValidityState","../lib","../main"],function(require){function e(){t.apply(this,arguments)}var t=require("./Rule"),i=require("./ValidityState");return e.prototype.type="minLength",e.prototype.errorMessage="${title}不能小于${minLength}个字符",e.prototype.check=function(e,t){return new i(e.length>=this.getLimitCondition(t),this.getErrorMessage(t))},require("../lib").inherits(e,t),require("../main").registerRule(e,100),e}),define("esui/validator/MinByteLengthRule",["require","./Rule","./ValidityState","../lib","../main"],function(require){function e(){t.apply(this,arguments)}var t=require("./Rule"),i=require("./ValidityState");return e.prototype.type="minByteLength",e.prototype.errorMessage="${title}不能小于${minByteLength}个字符",e.prototype.check=function(e,t){var n=e.replace(/[^\x00-\xff]/g,"xx").length;return new i(n>=this.getLimitCondition(t),this.getErrorMessage(t))},require("../lib").inherits(e,t),require("../main").registerRule(e,100),e}),define("esui/validator/MaxRule",["require","./Rule","./ValidityState","../lib","../main"],function(require){function e(){t.apply(this,arguments)}var t=require("./Rule"),i=require("./ValidityState");return e.prototype.type="max",e.prototype.errorMessage="${title}不能大于${max}",e.prototype.check=function(e,t){var n=+e,r=!isNaN(n)&&n<=this.getLimitCondition(t);return new i(!e||r,this.getErrorMessage(t))},require("../lib").inherits(e,t),require("../main").registerRule(e,301),e}),define("esui/validator/MaxByteLengthRule",["require","./Rule","./ValidityState","../lib","../main"],function(require){function e(){t.apply(this,arguments)}var t=require("./Rule"),i=require("./ValidityState");return e.prototype.type="maxByteLength",e.prototype.errorMessage="${title}不能超过${maxByteLength}个字符",e.prototype.check=function(e,t){var n=e.replace(/[^\x00-\xff]/g,"xx").length;return new i(n<=this.getLimitCondition(t),this.getErrorMessage(t))},require("../lib").inherits(e,t),require("../main").registerRule(e,100),e}),define("esui/validator/MathOnly",["require","./Rule","./ValidityState","../lib","../main"],function(require){function e(){t.apply(this,arguments)}var t=require("./Rule"),i=require("./ValidityState");return e.prototype.type="math",e.prototype.errorMessage="请填写数字",e.prototype.check=function(e,t){var n=this.getLimitCondition(t),r=e+0,a=!1,o=/^[1-9]?[0-9]*$/;if("negative"===n){var a=!isNaN(r)&&0>r&&o.test(+r);this.errorMessage="请填写负整数"}else if("positive"===n){var a=!isNaN(r)&&(0===r||o.test(r));this.errorMessage="请填写正整数"}else if("positiveReal"===n){var a=!isNaN(r)&&r>=0;this.errorMessage="请填写正实数"}else if("negativeReal"===n){var a=!isNaN(r)&&0>r;this.errorMessage="请填写负实数"}else var a=!isNaN(r);return new i(a||!e,this.getErrorMessage(t))},require("../lib").inherits(e,t),require("../main").registerRule(e,10),e}),define("esui/lib/lang",["require","underscore"],function(require){var e=require("underscore"),t={},i=8785925;return t.getGUID=function(e){return e=e||"esui",e+i++},t.inherits=function(e,t){var i=function(){};i.prototype=t.prototype;var n=e.prototype,r=e.prototype=new i;for(var a in n)r[a]=n[a];return e.prototype.constructor=e,e.superClass=t.prototype,e},t.clone=function(i){if(!i||"object"!=typeof i)return i;var n=i;if(e.isArray(i))n=e.clone(i);else if("[object Object]"==={}.toString.call(i)&&"isPrototypeOf"in i){n={};for(var r in i)if(i.hasOwnProperty(r))n[r]=t.deepClone(i[r])}return n},t.deepClone=t.clone,t.toDictionary=function(t){var i={};return e.each(t,function(e){i[e]=!0}),i},t.isArray=e.isArray,t.toArray=e.toArray,t.extend=e.extend,t.bind=e.bind,t.curry=e.partial,t.indexOf=e.indexOf,t.decodeHTML=e.unescape,t.encodeHTML=e.escape,t}),define("esui/lib/page",["require"],function(require){var e=document.documentElement,t=document.body,i="BackCompat"===document.compatMode?t:e,n={};return n.getWidth=function(){return Math.max(e?e.scrollWidth:0,t?t.scrollWidth:0,i?i.clientWidth:0,0)},n.getHeight=function(){return Math.max(e?e.scrollHeight:0,t?t.scrollHeight:0,i?i.clientHeight:0,0)},n.getViewWidth=function(){return i?i.clientWidth:0},n.getViewHeight=function(){return i?i.clientHeight:0},n.getScrollTop=function(){return window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0},n.getScrollLeft=function(){return window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0},n.getClientTop=function(){return document.documentElement.clientTop||document.body.clientTop||0},n.getClientLeft=function(){return document.documentElement.clientLeft||document.body.clientLeft||0},{page:n}}),define("esui/lib/event",["require","./dom","./page"],function(require){var e=require("./dom"),t=require("./page").page,i={};return i.preventDefault=function(e){if(e=e||window.event,e.preventDefault)e.preventDefault();else e.returnValue=!1},i.stopPropagation=function(e){if(e=e||window.event,e.stopPropagation)e.stopPropagation();else e.cancelBubble=!0},i.getMousePosition=function(e){if(e=e||window.event,"number"!=typeof e.pageX)e.pageX=e.clientX+t.getScrollLeft()-t.getClientLeft();if("number"!=typeof e.pageY)e.pageY=e.clientY+t.getScrollTop()-t.getClientTop();return e},i.getTarget=function(e){return e=e||window.event,e.target||e.srcElement},{on:function(t,i,n){if(t=e.g(t),t.addEventListener)t.addEventListener(i,n,!1);else if(t.attachEvent)t.attachEvent("on"+i,n)},un:function(t,i,n){if(t=e.g(t),t.addEventListener)t.removeEventListener(i,n,!1);else if(t.attachEvent)t.detachEvent("on"+i,n)},event:i}}),define("esui/lib/date",["require","moment"],function(require){var e=require("moment"),t={};return t.dateFormats=["YYYYMMDDHHmmss","YYYY-MM-DD HH:mm:ss","YYYY/MM/DD HH:mm:ss","YYYY-MM-DDTHH:mm:ss.SSSZ"],t.format=function(t,i){return e(t).format(i)},t.parse=function(i,n){var r=e(i,n||t.dateFormats);return r.toDate()},{date:t}}),define("esui/lib/class",["require","underscore","./dom"],function(require){function e(e){return e.className?e.className.split(/\s+/):[]}var t=require("underscore"),i=require("./dom"),n={};return n.hasClass=function(n,r){if(n=i.g(n),""===r)throw new Error("className must not be empty");if(!n||!r)return!1;if(n.classList)return n.classList.contains(r);var a=e(n);return t.contains(a,r)},n.addClass=function(n,r){if(n=i.g(n),""===r)throw new Error("className must not be empty");if(!n||!r)return n;if(n.classList)return n.classList.add(r),n;var a=e(n);if(t.contains(a,r))return n;else return a.push(r),n.className=a.join(" "),n},n.addClasses=function(n,r){if(n=i.g(n),!n||!r)return n;if(n.classList)return t.each(r,function(e){n.classList.add(e)}),n;var a=e(n),o=t.union(a,r);if(o.length>a.length)n.className=o.join(" ");return n},n.removeClass=function(t,n){if(t=i.g(t),""===n)throw new Error("className must not be empty");if(!t||!n)return t;if(t.classList)return t.classList.remove(n),t;for(var r=e(t),a=!1,o=0;o<r.length;o++)if(r[o]===n)r.splice(o,1),o--,a=!0;if(a)t.className=r.join(" ");return t},n.removeClasses=function(n,r){if(n=i.g(n),!n||!r)return n;if(n.classList)return t.each(r,function(e){n.classList.remove(e)}),n;var a=e(n),o=t.difference(a,r);if(o.length<a.length)n.className=o.join(" ");return n},n.toggleClass=function(t,n){if(t=i.g(t),""===n)throw new Error("className must not be empty");if(!t||!n)return t;if(t.classList)return t.classList.toggle(n),t;for(var r=e(t),a=!1,o=0;o<r.length;o++)if(r[o]===n)r.splice(o,1),a=!0,o--;if(!a)r.push(n);return t.className=r.join(" "),t},n}),define("esui/helper/template",["require","underscore"],function(require){var e=require("underscore"),t={id:function(e,t){return t.helper.getId(e)},"class":function(e,t){return t.helper.getPartClassName(e)},part:function(e,t,i){return i.helper.getPartHTML(e,t)}},i={};return i.setTemplateEngine=function(e){if(this.templateEngine=e,!e.esui)this.initializeTemplateEngineExtension()},i.initializeTemplateEngineExtension=function(){e.each(t,function(e,t){this.addFilter(t,e)},this.templateEngine)},i.renderTemplate=function(e,i){var n=this;i=i||{};var r={get:function(e){if("instance"===e)return n.control;if("function"==typeof i.get)return i.get(e);var r=e,a=null,o=e.lastIndexOf(".");if(o>0){r=e.substring(0,o);var s=e.substring(o+1);if(s&&t.hasOwnProperty(s))a=t[s]}var l=i.hasOwnProperty(r)?i[r]:r;if(a)l=a(l,n.control);return l}};if(!this.templateEngine)throw new Error("No template engine attached to this control");return this.templateEngine.render(e,r)},i}),define("esui/helper/life",["require","underscore","../main"],function(require){var e={NEW:0,INITED:1,RENDERED:2,DISPOSED:4},t=require("underscore"),i=require("../main"),n={};return n.initViewContext=function(){var e=this.control.viewContext||i.getViewContext();this.control.viewContext=null,this.control.setViewContext(e)},n.initExtensions=function(){var e=this.control.extensions;if(!t.isArray(e))e=this.control.extensions=[];Array.prototype.push.apply(e,i.createGlobalExtensions());for(var n={},r=0;r<e.length;r++){var a=e[r];if(!n[a.type])a.attachTo(this.control),n[a.type]=!0}},n.isInStage=function(t){if(null==e[t])throw new Error("Invalid life cycle stage: "+t);return this.control.stage===e[t]},n.changeStage=function(t){if(null==e[t])throw new Error("Invalid life cycle stage: "+t);this.control.stage=e[t]},n.dispose=function(){if(this.control.disposeChildren(),this.control.children=null,this.control.childrenIndex=null,this.clearDOMEvents(),t.invoke(this.control.extensions,"dispose"),this.control.extensions=null,this.control.parent)this.control.parent.removeChild(this.control);if(this.control.viewContext)this.control.viewContext.remove(this.control);this.control.renderOptions=null},n.beforeDispose=function(){this.control.fire("beforedispose")},n.afterDispose=function(){this.changeStage("DISPOSED"),this.control.fire("afterdispose"),this.control.destroyEvents()},n}),define("esui/helper/html",["require"],function(require){var e={},t={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0};return e.getPartBeginTag=function(e,t){var i="<"+t+' id="'+this.getId(e)+'" class="'+this.getPartClassName(e)+'">';return i},e.getPartEndTag=function(e,i){var n=t.hasOwnProperty(i)?" />":"</"+i+">";return n},e.getPartHTML=function(e,t){return this.getPartBeginTag(e,t)+this.getPartEndTag(e,t)},e}),define("mini-event/EventQueue",["require","./lib"],function(require){function e(e,t,i){return e&&e.handler===t&&e.thisObject==i}function t(){this.queue=[]}var i=require("./lib");return t.prototype.add=function(t,n){if(t!==!1&&"function"!=typeof t)throw new Error("event handler must be a function or const false");var r={handler:t};i.extend(r,n);for(var a=0;a<this.queue.length;a++){var o=this.queue[a];if(e(o,t,r.thisObject))return}this.queue.push(r)},t.prototype.remove=function(t,i){if(!t)return void this.clear();for(var n=0;n<this.queue.length;n++){var r=this.queue[n];if(e(r,t,i))return void(this.queue[n]=null)}},t.prototype.clear=function(){this.queue.length=0},t.prototype.execute=function(e,t){for(var i=this.queue,n=0;n<i.length;n++){if("function"==typeof e.isImmediatePropagationStopped&&e.isImmediatePropagationStopped())return;var r=i[n];if(r){var a=r.handler;if(a===!1){if("function"==typeof e.preventDefault)e.preventDefault();if("function"==typeof e.stopPropagation)e.stopPropagation()}else a.call(r.thisObject||t,e);if(r.once)this.remove(r.handler,r.thisObject)}else;}},t.prototype.getLength=function(){for(var e=0,t=0;t<this.queue.length;t++)if(this.queue[t])e++;return e},t.prototype.length=t.prototype.getLength,t.prototype.dispose=function(){this.clear(),this.queue=null},t}),define("esui/helper/event",["require","underscore","mini-event/EventQueue","../lib","mini-event"],function(require){function e(e){if(e===window)return s.window;if(e===document)return s.document;if(e===document.documentElement)return s.documentElement;if(e===document.body)return s.body;else return null}function t(t,i){var n=e(t);if(n){var r=n[i.type];if(r)l.each(r,function(e){if(e)a(e,t,i)})}}function i(e,t){t=t||150;var i=0;return function(n){clearTimeout(i);var r=this;n=n||window.event,n={type:n.type,srcElement:n.srcElement,target:n.target,currentTarget:n.currentTarget},i=setTimeout(function(){e.call(r,n)},t)}}function n(n,r,a){var o=e(a);if(!o)return!1;var s=o[r];if(!s){s=o[r]=[];var u=l.partial(t,a);if("resize"===r||"scroll"===r)u=i(u);s.handler=u,c.on(a,r,s.handler)}if(!(l.indexOf(s,n)>=0))return s.push(n),!0}function r(t,i,n){var r=e(n);if(!r)return!1;if(!r[i])return!0;for(var a=r[i],o=0;o<a.length;o++)if(a[o]===t){a[o]=null;break}var s=l.all(a,function(e){return null==e});if(s){var u=a.handler;c.un(n,i,u),r[i]=null}return!0}function a(e,t,i){i=i||window.event;var n=l.any(e.ignoreStates,function(t){return e.hasState(t)});if(!n){if(!i.target)i.target=i.srcElement;if(!i.currentTarget)i.currentTarget=t;if(!i.preventDefault)i.preventDefault=function(){i.returnValue=!1};if(!i.stopPropagation)i.stopPropagation=function(){i.cancelBubble=!0};var r=e.domEvents[i.currentTarget[o]][i.type];if(r)r.execute(i,e)}}var o="_esuiDOMEvent",s={window:{},document:{},documentElement:{},body:{}},l=require("underscore"),u=require("mini-event/EventQueue"),c=require("../lib"),f={};return f.addDOMEvent=function(e,t,i){if("string"==typeof e)e=this.getPart(e);if(!this.control.domEvents)this.control.domEvents={};var r=e[o];if(!r)r=e[o]=c.getGUID();var s=this.control.domEvents[r];if(!s)s=this.control.domEvents[r]={element:e};var f=n(this.control,t,e),d=s[t];if(!d)if(d=s[t]=new u,!f)d.handler=l.partial(a,this.control,e),c.on(e,t,d.handler);d.add(i)},f.delegateDOMEvent=function(e,t,i){var n=function(e){var t=require("mini-event").fromDOMEvent(e);if(this.fire(i||e.type,t),t.isDefaultPrevented())c.event.preventDefault(e);if(t.isPropagationStopped())c.event.stopPropagation(e)};this.addDOMEvent(e,t,n)},f.removeDOMEvent=function(e,t,i){if("string"==typeof e)e=this.getPart(e);if(this.control.domEvents){var n=e[o],a=this.control.domEvents[n];if(a&&a[t])if(!i)a[t].clear();else{var s=a[t];if(s.remove(i),!s.getLength())r(this.control,t,e)}}},f.clearDOMEvents=function(e){if("string"==typeof e)e=this.getPart(e);if(this.control.domEvents){if(!e)return l.each(l.pluck(this.control.domEvents,"element"),this.clearDOMEvents,this),void(this.control.domEvents=null);var t=e[o],i=this.control.domEvents[t];delete i.element,l.each(i,function(t,i){var n=r(this.control,i,e);if(!n){var a=t.handler;t.dispose(),t.handler=null,c.un(e,i,a)}},this),delete this.control.domEvents[t]}},f}),define("esui/helper/dom",["require","underscore","../lib","../main"],function(require){function e(e){var t=e.styleType||e.type;return t.toLowerCase()}function t(){return[].slice.call(arguments,0).join("-")}var i=require("underscore"),n=require("../lib"),r=require("../main"),a={};a.getPartClasses=function(i){if(i&&this.partClassCache&&this.partClassCache.hasOwnProperty(i))return this.partClassCache[i].slice();var n=e(this.control),a=this.control.skin,o=r.getConfig("uiClassPrefix"),s=r.getConfig("skinClassPrefix"),l=[];if(i){if(l.push(t(o,n,i)),a)l.push(t(s,a,n,i));if(!this.partClassCache)this.partClassCache={},this.partClassCache[i]=l.slice()}else if(l.push(t(o,"ctrl")),l.push(t(o,n)),a)l.push(t(s,a),t(s,a,n));return l},a.getPartClassName=function(e){return this.getPartClasses(e).join(" ")},a.getPrimaryClassName=function(i){var n=e(this.control);if(i)return t(r.getConfig("uiClassPrefix"),n,i);else return t(r.getConfig("uiClassPrefix"),n)},a.addPartClasses=function(e,t){if("string"==typeof t)t=this.getPart(t);if(t=t||this.control.main)n.addClasses(t,this.getPartClasses(e))},a.removePartClasses=function(e,t){if("string"==typeof t)t=this.getPart(t);if(t=t||this.control.main)n.removeClasses(t,this.getPartClasses(e))},a.getStateClasses=function(i){if(this.stateClassCache&&this.stateClassCache.hasOwnProperty(i))return this.stateClassCache[i].slice();var n=e(this.control),a=r.getConfig,o=[t(a("uiClassPrefix"),n,i),t(a("stateClassPrefix"),i)],s=this.control.skin;if(s){var l=a("skinClassPrefix");o.push(t(l,s,i),t(l,s,n,i))}if(!this.stateClassCache)this.stateClassCache={},this.stateClassCache[i]=o.slice();return o},a.addStateClasses=function(e){var t=this.control.main;if(t)n.addClasses(t,this.getStateClasses(e))},a.removeStateClasses=function(e){var t=this.control.main;if(t)n.removeClasses(t,this.getStateClasses(e))},a.getId=function(e){if(e=e?"-"+e:"",!this.control.domIDPrefix)this.control.domIDPrefix=this.control.viewContext&&this.control.viewContext.id;var t=this.control.domIDPrefix?this.control.domIDPrefix+"-":"";return"ctrl-"+t+this.control.id+e},a.createPart=function(e,t){t=t||"div";var i=document.createElement(t);return i.id=this.getId(e),this.addPartClasses(e,i),i},a.getPart=function(e){return n.g(this.getId(e))},a.isPart=function(e,t){var i=this.getPartClasses(t)[0];return n.hasClass(e,i)};var o={type:!0,name:!0,alt:!0,autocomplete:!0,autofocus:!0,checked:!0,dirname:!0,disabled:!0,form:!0,formaction:!0,formenctype:!0,formmethod:!0,formnovalidate:!0,formtarget:!0,width:!0,height:!0,inputmode:!0,list:!0,max:!0,maxlength:!0,min:!0,minlength:!0,multiple:!0,pattern:!0,placeholder:!0,readonly:!0,required:!0,size:!0,src:!0,step:!0,value:!0};a.replaceMain=function(e){e=e||this.control.createMain();var t=this.control.main;t.setAttribute(r.getConfig("instanceAttr"),n.getGUID());for(var i=t.attributes,a=0;a<i.length;a++){var s=i[a],l=s.name;if(n.hasAttribute(t,l)&&!o.hasOwnProperty(l))if(n.setAttribute(e,l,s.value),0===l.indexOf(r.getConfig("uiPrefix")))t.removeAttribute(l),a--}return n.insertBefore(e,t),t.parentNode.removeChild(t),this.control.main=e,t};var s={name:{name:"name"},maxlength:{name:"maxLength",type:"number"},required:{name:"required",type:"boolean"},pattern:{name:"pattern"},min:{name:"min",type:"number"},max:{name:"max",type:"number"},autofocus:{name:"autoFocus",type:"boolean"},disabled:{name:"disabled",type:"boolean"},readonly:{name:"readOnly",type:"boolean"}};return a.extractOptionsFromInput=function(e,t){var r={};if(i.each(s,function(t,i){var a=n.hasAttribute(e,i);if(a){var o=n.getAttribute(e,i);switch(t.type){case"boolean":o=a;break;case"number":o=parseInt(o,10)}r[t.name]=o}}),n.hasAttribute(e,"value")||"select"!==e.nodeName.toLowerCase()&&e.value)r.value=e.value;return i.defaults(t||{},r)},a}),define("esui/extension/TableSubrow",["require","../Extension","../lib","../controlHelper","../main","../Table"],function(require){function e(e,t){return C.getId(e,t)}function t(e,t){return C.getPartClasses(e,t).join(" ")}function i(e,t){return w.getAttribute(e,"data-"+t)}function n(e,t,i){w.setAttribute(e,"data-"+t,i)}function r(e){return!("undefined"==typeof e||null===e)}function a(t,i){return e(t,"subrow")+i}function o(t,i){return e(t,"subentry")+i}function s(e,t){return{subrow:e.subrow&&"false"!==e.subrow}}function l(e,t){u(this,e)}function u(e,t){var i=/subentry-opened/.test(t.className),n="subentry-hover";if(i)n="subentry-opened-hover";C.addPartClasses(e,n,t)}function c(e,t){f(this,e)}function f(e,t){C.removePartClasses(e,"subentry-hover",t),C.removePartClasses(e,"subentry-opened-hover",t)}function d(e,t){var n=this,r=i(e,"index"),a=n.datasource,o=a instanceof Array&&a.length;if(o&&!(r>=o)){if(!i(e,"subrowopened")){var s=a[r],l={index:r,item:s};if(l=n.fire("subrowopen",l),!l.isDefaultPrevented())p(n,r,e)}else h(n,r,e);u(n,e)}}function h(e,t,i){var r={index:t,item:e.datasource[t]};if(r=e.fire("subrowclose",r),!r.isDefaultPrevented())return f(e,i),e.subrowIndex=null,C.removePartClasses(e,"subentry-opened",i),C.removePartClasses(e,"row-unfolded",e.getRow(t)),n(i,"title",e.subEntryOpenTip),n(i,"subrowopened",""),w.g(a(e,t)).style.display="none",!0;else return!1}function p(e,t,i){var s=e.subrowIndex,l=1;if(r(s))l=h(e,s,w.g(o(e,s)));if(l)C.addPartClasses(e,"subentry-opened",i),C.addPartClasses(e,"row-unfolded",e.getRow(t)),n(i,"title",e.subEntryCloseTip),n(i,"subrowopened","1"),w.g(a(e,t)).style.display="",e.subrowMutex&&(e.subrowIndex=t)}function m(e,i,n,r,a,s){var l=s.subrow,u=l&&n.subEntry,c={notInText:!0,width:e.subEntryWidth,align:"right"};if(u){var f="function"==typeof n.isSubEntryShow?n.isSubEntryShow.call(e,i,r,a):!0;if(f!==!1)c.html=w.format(T,{className:t(e,"subentry"),id:o(e,r),title:e.subEntryOpenTip,index:r});c.colClass=t(e,"subentryfield")}return c}function g(e,i,n){var r=e.datasource?e.datasource.length:0;return n.subrow?'<div id="'+a(e,i)+'" class="'+t(e,"subrow")+" "+(r===i+1?t(e,"subrow-last"):"")+'" style="display:none"></div>':""}function v(e,t){return w.g(a(e,t))}function y(t,i){var n=v(t,i),r=e(t,"subrow-panel-"+i),a=t.viewContext.get(r);if(!a)n.innerHTML=w.format(M,{id:r,index:i}),t.initChildren(n),a=t.viewContext.get(r),t.addChild(a);return a}function b(){x.apply(this,arguments)}var x=require("../Extension"),w=require("../lib"),C=require("../controlHelper"),k=require("../main"),_=require("../Table"),T='<div class="${className}" id="${id}" title="${title}" data-index="${index}"></div>',M='<div data-ui="type:Panel;id:${id}" data-index="${index}"></div>';return b.prototype.type="TableSubrow",b.prototype.activate=function(){var e=this.target;if(e instanceof _){var t=C.getPartClasses,i=t(e,"subentry")[0];e.addRowBuilders([{index:0,getRowArgs:s,getColHtml:m,getSubrowHtml:g}]),e.addHandlers("click",{handler:d,matchFn:i}),e.addHandlers("mouseover",{handler:l,matchFn:i}),e.addHandlers("mouseout",{handler:c,matchFn:i}),e.getSubrow=function(e){return v(this,e)},e.setSubrowContent=function(e,t){var i=y(this,t);if(i)i.set("content",e)},e.getSubrowContainer=function(e){return y(this,e)},x.prototype.activate.apply(this,arguments)}},b.prototype.inactivate=function(){var e=this.target;if(e instanceof _)delete e.getSubrow,x.prototype.inactivate.apply(this,arguments)},w.inherits(b,x),k.registerExtension(b),b}),define("esui/validator/ValidityState",[],function(){function e(e,t){this.state=e,this.message=t||""}return e.prototype.getMessage=function(){return this.message},e.prototype.getState=function(){return this.state},e.prototype.setMessage=function(e){this.message=e},e.prototype.setState=function(e){this.state=e},e}),define("esui/validator/Rule",["require","./ValidityState","../lib"],function(require){function e(){}return e.prototype.type=null,e.prototype.errorMessage="${title}验证失败",e.prototype.check=function(e,t){var i=require("./ValidityState");return new i(!0,"")},e.prototype.getErrorMessage=function(e){var t=require("../lib"),i=e.get(this.type+"ErrorMessage")||this.errorMessage;return t.format(i,e)},e.prototype.getLimitCondition=function(e){return e.get(this.type)},e.prototype.getName=function(){return this.type},e}),define("esui/validator/MaxLengthRule",["require","./Rule","./ValidityState","../lib","../main"],function(require){function e(){t.apply(this,arguments)}var t=require("./Rule"),i=require("./ValidityState");return e.prototype.type="maxLength",e.prototype.errorMessage="${title}不能超过${maxLength}个字符",e.prototype.check=function(e,t){return new i(e.length<=this.getLimitCondition(t),this.getErrorMessage(t))},e.prototype.getErrorMessage=function(e){var t=require("../lib"),i=e.get(this.type+"ErrorMessage")||this.errorMessage,n=this.getLimitCondition(e),r={title:e.get("title"),maxLength:n,length:n};return t.format(i,r)},e.prototype.getLimitCondition=function(e){return e.get("length")||e.get("maxLength")},require("../lib").inherits(e,t),require("../main").registerRule(e,100),e}),define("esui/extension/TableEdit",["require","../validator/MaxLengthRule","../validator/MaxRule","../validator/MinRule","../validator/RequiredRule","../validator/PatternRule","../Extension","../lib","../controlHelper","../main","../Table","../validator/ValidityState","../validator/Validity"],function(require){function e(e,i){if(ne=e,Q=i.rowIndex,Z=i.columnIndex,!J)J=O.layer.create(),document.body.appendChild(J),J.className=e.helper.getPartClassName("editor"),t();J.style.zIndex=e.zIndex||"",n(i)}function t(){a(),i()}function i(){var e=N.init(J);te=o(e,V),ie=o(e,W),te.on("click",f()),ie.on("click",m()),w(1)}function n(e){if(e.field&&re!==e.field){ee&&ee.dispose(),ee=null;var t=B+ae++,i=F+ae,n=I.g(z),r=I.g($);n.innerHTML=I.format(X,{inputId:t}),r.innerHTML=I.format(G,{validId:i});var a={properties:{}};a.properties[t]=I.extend({id:t,width:145,height:20,validityLabel:F+ae},e.field.editRules),ee=N.init(n,a)[0],N.init(r),ee.on("enter",f()),re=e.field}}function r(e){if(e===ne){s(),ee.dispose(),te.dispose(),ie.dispose();try{J&&document.body.removeChild(J)}catch(t){}J=null,ee=null,te=null,ie=null,ne=null,re=null}}function a(){J.innerHTML=I.format(j,{inputFieldId:z,okId:V,cancelId:W,okText:q,cancelText:U,optClass:ne.helper.getPartClassName("editor-opt"),errorClass:ne.helper.getPartClassName("editor-error"),errorId:$})}function o(e,t){for(var i=e.length-1;i>=0;i--){var n=e[i];if(n.id===t)return n}}function s(e){J&&(J.style.display="none")}function l(e){J&&(J.style.display="")}function u(e){if(e){var t=new Y;t.addState("TableEditCustomRule",new H(!1,e)),ee.showValidity(t)}}function c(e){var t=new Y;t.addState("TableEditCustomRule",new H(!0)),ee.showValidity(t)}function f(){return function(){d()}}function d(){if(ee.validate()){var e={value:k(),rowIndex:Q,columnIndex:Z,field:ne.realFields[Z]};if(e=ne.fire("saveedit",e),P(ne,"saveedit",e),!e.isDefaultPrevented())h.call(ne,e);else p.call(ne,e)}}function h(e){if(this===ne)s(),K=0}function p(e){if(this===ne&&e.errorMsg)u(e.errorMsg)}function m(){return function(){b()}}function g(){if(this===ne)y(this)}function v(){if(this===ne)y(this)}function y(e){if(J){var t=I.g(e.getBodyCellId(Q,Z));if(t)O.layer.attachTo(J,t)}}function b(){K=0,s(),w(1);var e={rowIndex:Q,columnIndex:Z,field:ne.realFields[Z]};e=ne.fire("canceledit",e),P(ne,"canceledit",e)}function x(t,i){if(K&&ne)b();K=1,e(t,i),w(0),l();var n=I.g(t.getBodyCellId(i.rowIndex,i.columnIndex));O.layer.attachTo(J,n),C(i.value),c()}function w(e){te.setDisabled(e),ie.setDisabled(e)}function C(e){ee.setValue(e)}function k(){return ee.getValue()}function _(e,t){var i=this;if(i.startEdit){var n=I.getAttribute(e,"data-row"),r=I.getAttribute(e,"data-col");i.startEdit(n,r,e)}}function T(e,t,i){if(this.editable){var n=this.realFields[t],r={rowIndex:e,columnIndex:t,field:n};if(r=this.fire("startedit",r),P(this,"startedit",r),!r.isDefaultPrevented()){var a=this.datasource[e],o=n.editContent,s="function"==typeof o?o.call(this,a,e,t):a[n.field];x(this,{field:n,rowIndex:e,columnIndex:t,element:i,value:s})}}}function M(){if(this===ne)b()}function S(){if(this===ne)s()}function L(){if(this===ne)l()}function D(e,t,i,n,r,a){var o=i.editable;if("function"==typeof o)o=o.call(e,t,n,r,a);if(e.editable&&o)return{textClass:e.getClass("cell-editable"),html:I.format(oe,{className:e.getClass("cell-editentry"),row:n,col:r})};else return void 0}function P(e,t,i){var n=i.field["on"+t];if(n&&"[object Function]"===Object.prototype.toString.call(n))n.call(e,i)}function A(){E.apply(this,arguments)}require("../validator/MaxLengthRule"),require("../validator/MaxRule"),require("../validator/MinRule"),require("../validator/RequiredRule"),require("../validator/PatternRule");var E=require("../Extension"),I=require("../lib"),O=require("../controlHelper"),N=require("../main"),R=require("../Table"),H=require("../validator/ValidityState"),Y=require("../validator/Validity"),j=['<div class="${optClass}">','<div id="${inputFieldId}"></div>','<div data-ui="id:${okId};type:Button;">${okText}</div>','<div data-ui="id:${cancelId};type:Button;">',"${cancelText}","</div>","</div>",'<div class="${errorClass}" id="${errorId}"></div>'].join(""),z="ctrl-table-editor-inputField",B="ctrl-table-editorInput",F="ctrl-table-editor-validityLabel",V="ctrl-table-editor-ok",W="ctrl-table-editor-cancel",$="ctrl-table-editor-error",q="确定",U="取消",X='<input data-ui="type:TextBox;id:${inputId}"/>',G='<label data-ui="type:Validity;id:${validId}"></label>',Q=-1,Z=-1,K=0,J=null,ee=null,te=null,ie=null,ne=null,re=null,ae=1,oe='<div class="${className}" data-row="${row}" data-col="${col}"></div>';return A.prototype.type="TableEdit",A.prototype.activate=function(){var e=this.target;if(e instanceof R)e.startEdit=T,e.cancelEdit=M,e.hideEditLayer=S,e.showEditError=L,e.addRowBuilders([{index:3,getColHtml:D}]),e.addHandlers("click",{handler:_,matchFn:O.getPartClasses(e,"cell-editentry")[0]}),e.on("enddrag",g),e.on("resize",v),E.prototype.activate.apply(this,arguments)},A.prototype.inactivate=function(){var e=this.target;if(e instanceof R)delete e.startEdit,delete e.cancelEdit,e.un("enddrag",g),e.un("resize",v),r(e),E.prototype.inactivate.apply(this,arguments)},I.inherits(A,E),N.registerExtension(A),A}),define("esui/extension/CustomData",["require","../Extension","../main","../lib"],function(require){function e(){t.apply(this,arguments)}var t=require("../Extension");e.prototype.type="CustomData";var i=/^data[A-Z0-9]/;return e.prototype.activate=function(){t.prototype.activate.apply(this,arguments);var e=this.target.data;if("object"!=typeof e)e=require("../main").parseAttribute(this.target.data);for(var n in this.target)if(this.target.hasOwnProperty(n)&&i.test(n)){var r=n.charAt(4).toLowerCase()+n.slice(5);e[r]=this.target[n]}this.target.getData=function(t){return e[t]},this.target.setData=function(t,i){e[t]=i}},e.prototype.inactivate=function(){t.prototype.inactivate.apply(this,arguments),delete this.target.getData,delete this.target.setData},require("../lib").inherits(e,t),require("../main").registerExtension(e),e}),define("esui/extension/Command",["require","underscore","../lib","../Extension","mini-event","../main"],function(require){function e(e){if(e=e||{},!e.events)e.events=["click"];else e.events=i.splitTokenList(e.events);n.apply(this,arguments)}var t=require("underscore"),i=require("../lib"),n=require("../Extension");return e.prototype.type="Command",
e.prototype.handleCommand=function(e){for(var t=e.target,i=this.main&&this.main.parentNode;t&&t!==i;){if(1===t.nodeType&&(t.disabled!==!0||"click"!==e.type)){var n=t.getAttribute("data-command");if(n){var r=t.getAttribute("data-command-args"),a=require("mini-event").fromDOMEvent(e,"command",{name:n,triggerType:e.type,args:r});if(a=this.fire("command",a),a.isPropagationStopped())return}}t=t.parentNode}},e.prototype.activate=function(){for(var e=0;e<this.events.length;e++)this.target.helper.addDOMEvent(this.target.main,this.events[e],this.handleCommand);n.prototype.activate.apply(this,arguments)},e.prototype.inactivate=function(){for(var e=0;e<this.events.length;e++)this.target.helper.removeDOMEvent(this.target.main,this.events[e],this.handleCommand);n.prototype.inactivate.apply(this,arguments)},e.createDispatcher=function(e){var n=e;if(t.isArray(e)){n={};for(var r=0;r<e.length;r++){var a=e[r],o=a.triggerType?a.triggerType+":"+a.name:a.name;n[o]=a.handler}}return function(e){var t=n[e.triggerType+":"+e.name];if(!t)t=n[e.name];if(!t){var r="execute"+i.pascalize(e.name)+i.pascalize(e.triggerType);t=this[r]}if("function"!=typeof t){var r="execute"+i.pascalize(e.name);t=this[r]}if("function"!=typeof t)t=n[e.triggerType+":*"];if(!t)t=n["*"];if("function"==typeof t)t.apply(this,arguments)}},i.inherits(e,n),require("../main").registerExtension(e),e}),define("esui/extension/AutoSort",["require","underscore","../Table","../Extension","../lib","../main"],function(require){function e(){r.apply(this,arguments)}function t(e){function t(t,i){var r=n(t,i);return"asc"===e.order?r:-r}var n=e.field.comparer;if(!n){var r=e.field.field;n=function(e,t){if(r)e=e[r],t=t[r];return i.isString(e)&&i.isString(t)?e.localeCompare(t):e-t}}var a=this.datasource;a.sort(t),this.setDatasource(a)}var i=require("underscore"),n=require("../Table"),r=require("../Extension");return e.prototype.type="AutoSort",e.prototype.activate=function(){if(this.target instanceof n)this.target.on("sort",t),r.prototype.activate.apply(this,arguments)},e.prototype.inactivate=function(){if(this.target instanceof n)this.target.un("sort",t),r.prototype.inactivate.apply(this,arguments)},require("../lib").inherits(e,r),require("../main").registerExtension(e),e}),define("esui/Wizard",["require","underscore","./lib","./Control","./painters","./main"],function(require){function e(){a.apply(this,arguments)}function t(e,t,i){var n=t&&t.panel&&r.g(t.panel);if(n){var a=i?"removePartClasses":"addPartClasses";e.helper[a]("panel-hidden",n)}}function i(e){for(var i="",n=0;n<e.steps.length;n++){var r=e.steps[n],a=e.helper.getPartClasses("node");if(0===n)a.push.apply(a,e.helper.getPartClasses("node-first"));if(n===e.steps.length-1&&!e.finishText)a.push.apply(a,e.helper.getPartClasses("node-last"));if(n===e.activeIndex-1)a.push.apply(a,e.helper.getPartClasses("node-active-prev"));if(n<=e.activeIndex-1)a.push.apply(a,e.helper.getPartClasses("node-done"));var o=n===e.activeIndex;if(t(e,r,o),o)if(a.push.apply(a,e.helper.getPartClasses("node-active")),n===e.steps.length-1)a.push.apply(a,e.helper.getPartClasses("node-last-active"));i+='<li class="'+a.join(" ")+'">',i+=e.getNodeHTML(r),i+="</li>"}if(e.finishText){var a=[].concat(e.helper.getPartClasses("node"),e.helper.getPartClasses("node-last"),e.helper.getPartClasses("node-finish"),e.activeIndex===e.steps.length?e.helper.getPartClasses("node-active"):[]);i+='<li class="'+a.join(" ")+'">',i+="<span>"+e.finishText+"</span>",i+="</li>"}return i}var n=require("underscore"),r=require("./lib"),a=require("./Control");e.prototype.type="Wizard",e.prototype.createMain=function(){return document.createElement("ol")},e.prototype.initOptions=function(e){var t={steps:[],activeIndex:0},i=r.getChildren(this.main);if(!e.steps&&i.length)t.steps=n.map(i,function(e){var t={text:r.getText(e)},i=e.getAttribute("data-for");if(i)t.panel=i;return t});if(n.extend(t,e),"string"==typeof t.activeIndex)t.activeIndex=+t.activeIndex;this.setProperties(t)},e.prototype.nodeTemplate="<span>${text}</span>",e.prototype.getNodeHTML=function(e){return r.format(this.nodeTemplate,{text:r.encodeHTML(e.text)})};var o=require("./painters");return e.prototype.repaint=o.createRepaint(a.prototype.repaint,{name:["steps","finishText"],paint:function(e){e.main.innerHTML=i(e)}},{name:"activeIndex",paint:function(e,i){if(e.helper.isInStage("RENDERED"))for(var n=e.main.getElementsByTagName("li"),r=n.length-1;r>=0;r--){var a=r===e.activeIndex;t(e,e.steps[r],a);var o=n[r],s=a?"addPartClasses":"removePartClasses";if(e.helper[s]("node-active",o),r===e.steps.length-1)e.helper[s]("node-last-active",o);var l=r<=e.activeIndex-1,s=l?"addPartClasses":"removePartClasses";e.helper[s]("node-done",o);var u=r===e.activeIndex-1,s=u?"addPartClasses":"removePartClasses";e.helper[s]("node-active-prev",o)}}}),e.prototype.setProperties=function(e){if(e.hasOwnProperty("steps")){if(e.hasOwnProperty("activeIndex"))this.activeIndex=e.activeIndex,delete e.activeIndex;else this.activeIndex=0;if(e.hasOwnProperty("finishText"))this.finishText=e.finishText,delete e.finishText}var t=a.prototype.setProperties.apply(this,arguments);if(t.hasOwnProperty("steps")||t.hasOwnProperty("activeIndex"))this.fire("enter")},e.prototype.getActiveStep=function(){return this.get("steps")[this.get("activeIndex")]},e.prototype.stepNext=function(){var e=this.finishText?this.steps.length:this.steps.length-1;if(this.activeIndex<e)this.set("activeIndex",this.activeIndex+1)},e.prototype.stepPrevious=function(){if(this.activeIndex>0)this.set("activeIndex",this.activeIndex-1)},require("./main").register(e),r.inherits(e,a),e}),define("esui/Validity",["require","underscore","./lib","./Control","./Helper","./painters","./main"],function(require){function e(){r.apply(this,arguments)}function t(e,t){var i=e.target,n=null;if(i||e.targetType){var r={type:e.targetType||i.type,skin:i&&i.skin};n=new a(r)}var o=e.helper.getPartClasses();if(n)o.push.apply(o,n.getPartClasses("validity-label"));if(t)if(o.push.apply(o,e.helper.getPartClasses(t)),n)o.push.apply(o,n.getPartClasses("validity-label-"+t));if(i&&i.isHidden()||e.isHidden())if(o.push.apply(o,e.helper.getStateClasses("hidden")),i)o.push.apply(o,i.helper.getPartClasses("validity-label-hidden"));return o}var i=require("underscore"),n=require("./lib"),r=require("./Control"),a=require("./Helper");return e.prototype.type="Validity",e.prototype.createMain=function(){return document.createElement("label")},e.prototype.initOptions=function(t){var n=i.extend({},e.defaultProperties,t);r.prototype.initOptions.call(this,n)},e.prototype.display=function(e,t,i){this.main.innerHTML=t},e.prototype.repaint=require("./painters").createRepaint(r.prototype.repaint,{name:["target","targetType"],paint:function(e){var i=e.validity?e.validity.getValidState():"",n=t(e,i);e.main.className=n.join(" ")}},{name:"focusTarget",paint:function(e,t){if("label"===e.main.nodeName.toLowerCase())if(t&&t.id)n.setAttribute(e.main,"for",t.id);else n.removeAttribute(e.main,"for")}},{name:"validity",paint:function(e,n){var r=n&&n.getValidState(),a=t(e,r);if(e.main.className=a.join(" "),e.disposeChildren(),n){var o=n.getCustomMessage();if(!o){var s=i.find(n.getStates(),function(e){return!e.getState()});o=s&&s.getMessage()}if(e.display(r,o||"",n),e.helper.initChildren(),o)e.show();else e.hide()}else e.main.innerHTML="",e.hide()}}),e.prototype.dispose=function(){if(!this.helper.isInStage("DISPOSED")){if(this.target)this.target.validityLabel=null,this.target=null;if(this.focusTarget=null,this.main.parentNode)this.main.parentNode.removeChild(this.main);r.prototype.dispose.apply(this,arguments)}},n.inherits(e,r),require("./main").register(e),e}),define("esui/TreeStrategy",["require","underscore"],function(require){function e(e){var i={defaultExpand:!1};t.extend(this,i,e)}var t=require("underscore");return e.prototype.isLeafNode=function(e){return!e.children||!e.children.length},e.prototype.shouldExpand=function(e){return this.defaultExpand},e.prototype.attachTo=function(e){this.enableToggleStrategy(e),this.enableSelectStrategy(e)},e.prototype.enableToggleStrategy=function(e){e.on("expand",function(e){this.expandNode(e.node.id)}),e.on("collapse",function(e){this.collapseNode(e.node.id,!1)})},e.prototype.enableSelectStrategy=function(e){e.on("select",function(e){this.selectNode(e.node.id)}),e.on("unselect",function(t){if(e.get("allowUnselectNode"))e.unselectNode(t.node.id)})},e}),define("esui/Tree",["require","./Control","./lib","./controlHelper","underscore","./TreeStrategy","./main"],function(require){function e(){v.apply(this,arguments)}function t(){h.apply(this,arguments)}function i(e,t,i,n,r){var a=r-n,o=0===a?"current":1===a?"previous":"far-previous",s=[].concat(m.getPartClasses(e,"node-indicator"),m.getPartClasses(e,"node-indicator-"+i),m.getPartClasses(e,"node-indicator-level-"+n),m.getPartClasses(e,"node-indicator-"+o)),l=0===a?y[i||"collapsed"]:"第"+n+"级",u="<span ";if(0===a)u+='id="'+m.getId(e,"indicator-"+t.id)+'" ';return u+='class="'+s.join(" ")+'">'+l+"</span>"}function n(e,t,n,r){var o=m.getPartClasses(e,"content-wrapper");if(e.selectedNodeIndex[t.id])o=o.concat(m.getPartClasses(e,"content-wrapper-selected"));o=o.join(" ");for(var s=m.getId(e,"content-wrapper-"+t.id),l='<div id="'+s+'" class="'+o+'">',u=e.strategy.isLeafNode(t)?"empty":r?"expanded":"collapsed",c=0;n>=c;c++)l+=i(e,t,u,c,n);var f=m.getPartClasses(e,"item-content");if(l+='<div class="'+f.join(" ")+'">'+e.getItemHTML(t)+"</div>",l+="</div>",r&&!e.strategy.isLeafNode(t)){var d=[].concat(m.getPartClasses(e,"sub-root"),m.getPartClasses(e,"sub-root-"+u));l+='<ul class="'+d.join(" ")+'">';for(var c=0;c<t.children.length;c++){var h=t.children[c];l+=a(e,h,n+1,e.strategy.shouldExpand(h))}l+="</ul>"}return l}function r(e,t,i,n){var r=e.strategy.isLeafNode(t)?"empty":n?"expanded":"collapsed",a=[].concat(m.getPartClasses(e,"node"),m.getPartClasses(e,"node-"+r),m.getPartClasses(e,"node-level-"+i));if(t===e.datasource)a=[].concat(m.getPartClasses(e,"root"),m.getPartClasses(e,"root-"+r),a);return a}function a(e,t,i,a,o){o=o||"li";var s=r(e,t,i,a),l="<"+o+' class="'+s.join(" ")+'" id="'+m.getId(e,"node-"+t.id)+'" data-id="'+t.id+'" data-level="'+i+'">';return l+=n(e,t,i,a),l+="</"+o+">"}function o(e){var t=e.target,i=m.getPartClasses(this,"node-indicator")[0],n=p.hasClass(t,i),r=!n;if(!n){for(var a=m.getPartClasses(this,"content-wrapper")[0];t&&t!==this.main&&!p.hasClass(t,a);)t=t.parentNode;if(p.hasClass(t,a))n=this.wideToggleArea,r=r&&!0}if(n||r){for(;t&&t!==this.main&&!p.hasAttribute(t,"data-id");)t=t.parentNode;var o=t.getAttribute("data-id");if(n)this.triggerToggleStrategy(o);if(r)this.triggerSelectStrategy(o)}}function s(e,t){if(t=t||{},t[e.id]=e,e.children)for(var i=0;i<e.children.length;i++){var n=e.children[i];n.pid=e.id,s(n,t)}return t}function l(e,t){if(e.selectedNodeIndex[t.id])return!1;else return e.selectedNodes.push(t),e.selectedNodeIndex[t.id]=t,!0}function u(e,t){if(e.selectedNodeIndex[t.id]){delete e.selectedNodeIndex[t.id];for(var i=0;i<e.selectedNodes.length;i++)if(e.selectedNodes[i]===t)e.selectedNodes.splice(i,1);return!0}return!1}function c(e,t,i){if(i.force||e.allowUnselectNode){var n=e.nodeIndex[t];if(n){var r=u(e,n);if(r){if(i.modifyDOM){var a=p.g(m.getId(e,"content-wrapper-"+t));m.removePartClasses(e,"content-wrapper-selected",a)}if(!i.silent)e.fire("unselectnode",{node:n}),e.fire("selectionchange")}}}}function f(e,t){var i=m.getPartClasses(e,"node-empty")[0];return p.hasClass(t,i)}function d(e,t){var i=m.getPartClasses(e,"node-expanded")[0];return p.hasClass(t,i)}var h=require("./Control"),p=require("./lib"),m=require("./controlHelper"),g=require("underscore"),v=require("./TreeStrategy");e.prototype.attachTo=function(){},p.inherits(e,v),t.prototype.type="Tree",t.defaultProperties={selectMode:"single",hideRoot:!1},t.prototype.initOptions=function(i){var n={datasource:{},strategy:new e,selectedNodes:[],selectedNodeIndex:{}},r=p.extend(n,t.defaultProperties,i);if(null==r.allowUnselectNode)r.allowUnselectNode="single"!==r.selectMode;this.setProperties(r)},t.prototype.itemTemplate="<span>${text}</span>",t.prototype.getItemHTML=function(e){var t={id:p.encodeHTML(e.id),text:p.encodeHTML(e.text)};return p.format(this.itemTemplate,t)};var y={collapsed:"展开",expanded:"收起",busy:"加载中",empty:"无内容"};return t.prototype.clickNode=function(e){o.apply(this,arguments)},t.prototype.initStructure=function(){this.strategy.attachTo(this)},t.prototype.initEvents=function(){m.addDOMEvent(this,this.main,"click",this.clickNode)},t.prototype.removeNodeFromIndex=function(e){var t=this.nodeIndex[e];if(t)if(this.nodeIndex[e]=void 0,t.children)g.each(t.children,this.removeNodeFromIndex,this)},t.prototype.repaint=m.createRepaint(h.prototype.repaint,{name:"datasource",paint:function(e,t){e.selectedNodes=[],e.selectedNodeIndex={},e.nodeIndex=s(t),e.main.innerHTML=a(e,t,0,!0,"div")}},{name:"hideRoot",paint:function(e,t){var i=t?"addState":"removeState";e[i]("hide-root")}}),t.prototype.triggerSelectStrategy=function(e){var t=this.nodeIndex[e];if(t)if(this.selectedNodeIndex[e])this.fire("unselect",{node:t});else this.fire("select",{node:t})},t.prototype.getSelectedNodes=function(){return this.selectedNodes.slice()},t.prototype.toggleNodeSelection=function(e){var t=this.selectedNodeIndex[e]?"unselectNode":"selectNode";this[t](e)},t.prototype.selectNode=function(e,t){var i=this.nodeIndex[e];if(i){var n=l(this,i);if(n){if("single"===this.selectMode&&this.selectedNodes.length>1)c(this,this.selectedNodes[0].id,{force:!0,silent:!0,modifyDOM:!0});var r=p.g(m.getId(this,"content-wrapper-"+e));if(r)m.addPartClasses(this,"content-wrapper-selected",r);if(!t)this.fire("selectnode",{node:i}),this.fire("selectionchange")}}},t.prototype.unselectNode=function(e,t){c(this,e,{force:!0,silent:t,modifyDOM:!0})},t.prototype.expandNode=function(e,t){var i=p.g(m.getId(this,"node-"+e));if(i){var a=+p.getAttribute(i,"data-level");if(t||"ul"!==i.lastChild.nodeName.toLowerCase()){var o=this.nodeIndex[e];if(!o)return;if(t){if(o.children)for(var l=0;l<o.children.length;l++)c(this,o.children[l].id,{force:!0,silent:!0,modifyDOM:!1}),this.removeNodeFromIndex(o.children[l].id);o.children=t,s(o,this.nodeIndex)}i.innerHTML=n(this,o,a,!0)}else{var u=p.g(m.getId(this,"indicator-"+e));u.innerHTML=y.expanded;var f=[].concat(m.getPartClasses(this,"node-indicator"),m.getPartClasses(this,"node-indicator-level-"+a),m.getPartClasses(this,"node-indicator-current"),m.getPartClasses(this,"node-indicator-expanded"));u.className=f.join(" ");var d=[].concat(m.getPartClasses(this,"sub-root"),m.getPartClasses(this,"sub-root-expanded"));i.lastChild.className=d.join(" ")}var o=this.nodeIndex[e],h=r(this,o,a,!0);i.className=h.join(" ")}},t.prototype.collapseNode=function(e,t){var i=p.g(m.getId(this,"node-"+e));if(i){var n=this.nodeIndex[e],a=i.getElementsByTagName("ul")[0];if(a)if(t){if(a.parentNode.removeChild(a),n.children)for(var o=0;o<n.children.length;o++)c(this,n.children[o].id,{force:!0,silent:!1,modifyDOM:!1})}else{var s=[].concat(m.getPartClasses(this,"sub-root"),m.getPartClasses(this,"sub-root-collapsed"));a.className=s.join(" ")}var l=+p.getAttribute(i,"data-level"),u=r(this,n,l,!1);i.className=u.join(" ");var f=p.g(m.getId(this,"indicator-"+e)),d=[].concat(m.getPartClasses(this,"node-indicator"),m.getPartClasses(this,"node-indicator-level-"+l),m.getPartClasses(this,"node-indicator-current"),m.getPartClasses(this,"node-indicator-collapsed"));f.className=d.join(" "),f.innerHTML=y.collapsed}},t.prototype.toggleNode=function(e,t,i){if(this.nodeIndex[e]){var n=p.g(m.getId(this,"node-"+e));if(n)if(!f(this,n))if(d(this,n))this.collapseNode(e,i);else this.expandNode(e,t)}},t.prototype.triggerToggleStrategy=function(e){var t=this.nodeIndex[e];if(t){var i=p.g(m.getId(this,"node-"+e));if(i)if(!f(this,i))if(d(this,i))this.fire("collapse",{node:t});else this.fire("expand",{node:t})}},t.prototype.indicateNodeLoading=function(e){var t=p.g(m.getId(this,"node-"+e));if(t){for(var i=p.getChildren(t),n=0;!this.helper.isPart(i[n],"item-content");)n++;var r=i[n];r.innerHTML=y.busy;var a=[].concat(m.getPartClasses(this,"node-indicator"),m.getPartClasses(this,"node-indicator-level-"+n),m.getPartClasses(this,"node-indicator-current"),m.getPartClasses(this,"node-indicator-busy"));r.className=a.join(" ")}},t.prototype.dispose=function(){h.prototype.dispose.apply(this,arguments),this.nodeIndex=null,this.selectedNodes=null,this.selectedNodeIndex=null},require("./main").register(t),p.inherits(t,h),t}),define("esui/Toast",["require","./lib","./Control","./painters","./main"],function(require){function e(e){r.apply(this,arguments)}function t(){var e=require("./main").getConfig("uiClassPrefix"),t=e+"-toast-collection-area",i=document.getElementById(t);if(!i)i=document.createElement("div"),i.id=t,this.helper.addPartClasses("collection-area",i),document.body.appendChild(i);return i}function i(i){return function(a,o){if("show"===i)i="normal";o=n.extend({content:a},o),o.messageType=o.messageType||i;var s=new e(o);return r.prototype.hide.apply(s),s.appendTo(t.call(s)),s}}var n=require("./lib"),r=require("./Control");e.defaultProperties={duration:3e3,messageType:"normal",disposeOnHide:!0,autoShow:!1},e.prototype.type="Toast",e.prototype.initOptions=function(t){var i={};if(n.extend(i,e.defaultProperties,t),null==i.content)i.content=this.main.innerHTML;this.setProperties(i)},e.prototype.initStructure=function(){this.main.innerHTML=this.helper.getPartHTML("content","p"),this.addState("hidden")},e.prototype.repaint=require("./painters").createRepaint(r.prototype.repaint,{name:"content",paint:function(e,t){var i=e.main.firstChild;if(i.innerHTML=t,e.autoShow&&e.helper.isInStage("INITED"))e.show()}},{name:"messageType",paint:function(e,t){e.helper.addPartClasses(e.messageType)}}),e.prototype.show=function(){if(!this.helper.isInStage("DISPOSED")){if(!this.main.parentElement&&!this.main.parentNode)this.appendTo(t.call(this));if(this.isHidden())if(r.prototype.show.apply(this,arguments),this.fire("show"),clearTimeout(this.timer),!isNaN(this.duration)&&this.duration!==1/0)this.timer=setTimeout(n.bind(this.hide,this),this.duration)}},e.prototype.hide=function(){if(!this.isHidden())if(r.prototype.hide.apply(this,arguments),clearTimeout(this.timer),this.fire("hide"),this.disposeOnHide)this.dispose()},e.prototype.dispose=function(){if(clearTimeout(this.timer),!this.helper.isInStage("DISPOSED"))n.removeNode(this.main),r.prototype.dispose.apply(this,arguments)};var a=["show","info","alert","error","success"];for(var o in a)if(a.hasOwnProperty(o)){var s=a[o];e[s]=i(s)}return n.inherits(e,r),require("./main").register(e),e}),define("esui/TipLayer",["require","./Button","./Label","./Panel","underscore","./lib","./controlHelper","./Control","./main","./painters"],function(require){function e(e){h.apply(this,arguments)}function t(e){var t=e.main;if(t){for(var i,n=f.getChildren(t),r=n.length,a={};r--;)if(i=n[r].getAttribute("data-role"))a[i]=n[r];e.roles=a}}function i(e,t){if(t)e.title=t.innerHTML;else if(t=document.createElement("h3"),e.main.firstChild)f.insertBefore(t,e.main.firstChild);else e.main.appendChild(t);var i=[].concat(e.helper.getPartClasses("title"));f.addClasses(t,i);var n={main:t,childName:"title"},r=p.create("Label",n);return r.render(),e.addChild(r),r}function n(e,t,i){if(i)e.content=i.innerHTML;else if(i=document.createElement("div"),"body"===t){var n=e.getChild("title");if(n)f.insertAfter(i,n.main);else if(e.main.firstChild)f.insertBefore(i,n,e.main.firstChild);else e.main.appendChild(i)}else e.main.appendChild(i);f.addClasses(i,e.helper.getPartClasses(t+"-panel"));var r={main:i,renderOptions:e.renderOptions},a=p.create("Panel",r);return a.render(),e.addChild(a,t),a}function r(e,t,i){if(e.isShow)e.autoPosition(t,i)}function a(e,t,i,n){if(t)clearTimeout(e.showTimeout),clearTimeout(e.hideTimeout),e.showTimeout=setTimeout(f.bind(e.show,e,i,n),t);else e.show(i,n)}function o(e,t){clearTimeout(e.showTimeout),clearTimeout(e.hideTimeout),e.hideTimeout=setTimeout(f.bind(e.hide,e),t)}function s(e,t){if("string"==typeof t)t=e.viewContext.get(t);return t.main}function l(e){this.helper.addDOMEvent(document.documentElement,"mouseup",e.layer.clickOutsideHideHandler),this.helper.addDOMEvent(this.main,"mouseup",e.layer.preventPopMethod)}function u(e){this.helper.removeDOMEvent(document.documentElement,"mouseup",e.layer.clickOutsideHideHandler),this.helper.removeDOMEvent(this.main,"mouseup",e.layer.clickOutsideHideHandler)}require("./Button"),require("./Label"),require("./Panel");var c=require("underscore"),f=require("./lib"),d=require("./controlHelper"),h=require("./Control"),p=require("./main"),m=require("./painters"),g=0,v=150;return e.prototype={type:"TipLayer",initOptions:function(e){t(e);var i={roles:{},showMode:"manual"};f.extend(i,e),this.setProperties(i)},initStructure:function(){var e=this.main;if(e.parentNode&&"body"!==e.parentNode.nodeName.toLowerCase())document.body.appendChild(e);if(this.main.style.left="-10000px",this.title||this.roles.title)i(this,this.roles.title);if(n(this,"body",this.roles.content),this.foot||this.roles.foot)n(this,"foot",this.roles.foot);if(this.arrow){var t=document.createElement("div");t.id=d.getId(this,"arrow"),t.className=d.getPartClasses(this,"arrow").join(" "),this.main.appendChild(t)}},repaint:d.createRepaint(h.prototype.repaint,m.style("width"),{name:"title",paint:function(e,t){var n=e.getHead();if(null==t){if(n)e.removeChild(n)}else{if(!n)n=i(e);n.setText(t)}}},{name:"content",paint:function(e,t){var i='<div class="${class}" id="${id}">${content}</div>',n=e.getBody(),r=d.getId(e,"body"),a=d.getPartClasses(e,"body"),o={"class":a.join(" "),id:r,content:t};n.setContent(f.format(i,o))}},{name:"foot",paint:function(e,t){var i='<div class="${class}" id="${id}">${content}</div>',r=d.getId(e,"foot"),a=d.getPartClasses(e,"foot"),o=e.getFoot();if(null==t){if(o)e.removeChild(o)}else{var s={"class":a.join(" "),id:r,content:t};if(!o)o=n(e,"foot");o.setContent(f.format(i,s))}}},{name:["targetDOM","targetControl","showMode","positionOpt","delayTime","showDuration"],paint:function(e,t,i,n,r,a,o){var s={targetDOM:t,targetControl:i,showMode:n,delayTime:null!=a?a:g,showDuration:null!=o?o:v};if(r)r=r.split("|"),s.positionOpt={top:r[0]||"top",right:r[1]||"left"};if("manual"!==n)e.attachTo(s)}}),autoPosition:function(e,t){var i=this,n=this.main;t=t||{left:"right",top:"top"};var r=e.getBoundingClientRect(),a=f.getOffset(e),o={top:r.top,right:r.right,bottom:r.bottom,left:r.left,width:r.right-r.left,height:r.bottom-r.top},s=n.style.display;n.style.display="block";var l=n.offsetHeight,u=n.offsetWidth;n.style.display="none";var d=c.omit(t,"targetControl"),h=f.page.getViewWidth(),p=f.page.getViewHeight(),m=o.left-u,g=h-o.right-u,v=p-o.top-l,y=o.bottom-l;if(m>=0)if(g>=0){if(!d.right&&!d.left)if(m>g)d.left="right",d.right=null;else d.right="left",d.left=null}else d.left="right",d.right=null;else d.right="left",d.left=null;if(v>=0)if(y>=0){if(!d.bottom&&!d.top)if(v>y)d.top="top",d.bottom=null;else d.bottom="bottom",d.top=null}else d.top="top",d.bottom=null;else d.bottom="bottom",d.top=null;var b,x={};if(d.right)if(x.left=a.right,d.top)b="lt";else b="lb";else if(d.left)if(x.left=a.left-u,d.top)b="rt";else b="rb";if(d.top)x.top=a.top;else if(d.bottom)x.top=a.bottom-l;n.style.display=s,n.className=""+i.helper.getPartClassName()+" "+i.helper.getPartClassName(b);var w=i.helper.getPart("arrow");if(w)w.className=""+i.helper.getPartClassName("arrow")+" "+i.helper.getPartClassName("arrow-"+b);i.renderLayer(n,x)},renderLayer:function(e,t){var i=f.clone(t||{});if(i.hasOwnProperty("top")&&i.hasOwnProperty("bottom"))i.height=i.bottom-i.top,delete i.bottom;if(i.hasOwnProperty("left")&&i.hasOwnProperty("right"))i.width=i.right-i.left,delete i.right;if(i.hasOwnProperty("top")||i.hasOwnProperty("bottom"))e.style.top="",e.style.bottom="";if(i.hasOwnProperty("left")||i.hasOwnProperty("right"))e.style.left="",e.style.right="";for(var n in i)if(i.hasOwnProperty(n))e.style[n]=i[n]+"px"},attachTo:function(e){var t=this.getInitHandler(e);if(t)switch(e.handler=t,e.showMode){case"auto":this.initAutoMode(e);break;case"over":this.initOverMode(e);break;case"click":this.initClickMode(e);break;case"manual":}},getInitHandler:function(e){var t,i=this;if(e.targetDOM)t=f.g(e.targetDOM);else if(e.targetControl)t=s(this,e.targetControl);if(!t)return null;var n={targetElement:t,layer:{show:function(){if("over"===e.showMode)i.helper.removeDOMEvent(i.main,"mouseover"),i.helper.removeDOMEvent(i.main,"mouseout"),i.helper.addDOMEvent(i.main,"mouseover",c.bind(i.show,i,t,e.positionOpt)),i.helper.addDOMEvent(i.main,"mouseout",function(){n.layer.hide()});a(i,e.delayTime,t,e.positionOpt)},hide:f.curry(o,i,e.delayTime),bind:function(e,r){e=e||"mouseup",i.helper.addDOMEvent(t,e,function(e){if(n.layer.show(),"function"==typeof r)r();e.stopPropagation()})},preventPopMethod:function(e){e.stopPropagation()},clickOutsideHideHandler:function(e){n.layer.hide()},enableOutsideClickHide:function(){l.call(i,n)},disableOutsideClickHide:function(){u.call(i,n)}}};return n},initAutoMode:function(e){var t=e.handler;if(t.layer.show(),!e.showDuration)t.layer.enableOutsideClickHide();else t.layer.hide(e.showDuration);t.layer.bind("mouseup")},initClickMode:function(e){var t=e.handler;t.layer.bind("mouseup"),t.layer.enableOutsideClickHide()},initOverMode:function(e){var t=e.handler;t.layer.bind("mouseover"),this.helper.addDOMEvent(t.targetElement,"mouseout",function(){t.layer.hide()})},getHead:function(){return this.getChild("title")},getBody:function(){return this.getChild("body")},getFoot:function(){return this.getChild("foot")},show:function(e,t){if(d.isInStage(this,"INITED"))this.render();else if(d.isInStage(this,"DISPOSED"))return;if(clearTimeout(this.hideTimeout),d.addDOMEvent(this,window,"resize",f.curry(r,this,e,t)),this.main.style.zIndex=d.layer.getZIndex(e),this.removeState("hidden"),this.autoPosition(e,t),!this.isShow)this.isShow=!0,this.fire("show")},hide:function(){if(this.isShow)this.isShow=!1,this.addState("hidden"),this.fire("hide")},setTitle:function(e){this.setProperties({title:e})},setContent:function(e){this.setProperties({content:e})},setFoot:function(e){this.setProperties({foot:e})},dispose:function(){if(!d.isInStage(this,"DISPOSED")){this.hide();var e=this.main.id;f.removeNode(e),h.prototype.dispose.apply(this,arguments)}}},e.onceNotice=function(e){function t(e){var t=e.onok,i="function"==typeof t;if(i)t(e);e.fire("ok"),e.dispose()}var i="tipLayer-once-notice",n="tipLayer-notice-ok",r=f.encodeHTML(e.content)||"",a={type:"onceNotice",skin:"onceNotice",arrow:!0};f.extend(a,e);var o=document.createElement("div");document.body.appendChild(o);var s=d.getGUID(i);a.id=s,a.main=o,a.type=null;var l=p.create("TipLayer",a);l.setContent(r);var u=e.okText||"知道了";l.setFoot('<div data-ui="type:Button;childName:okBtn;id:'+s+"-"+n+';width:50;"class="'+d.getPartClasses(l,"once-notice")+'">'+u+"</div>"),l.render();var c=l.getFoot().getChild("okBtn");c.on("click",f.curry(t,l,"ok"));var h=f.g(e.targetDOM)||l.viewContext.get(e.targetControl);return l.show(h,{top:"top",right:"left"}),l},f.inherits(e,h),p.register(e),e}),define("esui/Tip",["require","underscore","./Control","./main","./TipLayer","./painters","./lib"],function(require){function e(e){n.apply(this,arguments)}function t(e,t){t.title=t.title||e.getAttribute("title"),e.removeAttribute("title"),t.content=t.content||e.innerHTML,e.innerHTML=""}var i=require("underscore"),n=require("./Control"),r=require("./main");return require("./TipLayer"),e.prototype.type="Tip",e.prototype.initOptions=function(e){var n={title:"",content:"",arrow:!0,showMode:"over",delayTime:500};if(i.extend(n,e),"false"===e.arrow)n.arrow=!1;t(this.main,n),this.setProperties(n)},e.prototype.initStructure=function(){var e=document.createElement("div");document.body.appendChild(e);var t=r.create("TipLayer",{main:e,childName:"layer",content:this.content,title:this.title,arrow:this.arrow,width:this.layerWidth||200,viewContext:this.viewContext});this.addChild(t),t.render();var i={showMode:this.showMode,delayTime:this.delayTime,targetControl:this,positionOpt:{top:"top",right:"left"}};t.attachTo(i)},e.prototype.repaint=require("./painters").createRepaint(n.prototype.repaint,{name:"title",paint:function(e,t){var i=e.getChild("layer");if(i)i.setTitle(t)}},{name:"content",paint:function(e,t){var i=e.getChild("layer");if(i)i.setContent(t)}}),require("./lib").inherits(e,n),r.register(e),e}),define("esui/TextLine",["require","underscore","./lib","./InputControl","./main","./TextBox","./painters"],function(require){function e(e){o.apply(this,arguments)}function t(e){var t='<textarea wrap="off" id="'+e.helper.getId("text")+'"</textarea>',i=[e.helper.getPartBeginTag("num-line","div"),"1",e.helper.getPartEndTag("num-line","div"),e.helper.getPartBeginTag("text-container","div"),t,e.helper.getPartEndTag("text-container","div")];return i.join("")}function i(e){if("input"===e.type||"value"===e.propertyName)n.call(this)}function n(){var e=this.helper.getPart("text").value.split("\n").length;if(e!==this.number){this.number=e;var t=this.helper.getPart("num-line");t.innerHTML=r.range(1,e+1).join("<br />")}this.resetScroll(),this.fire("change")}var r=require("underscore"),a=require("./lib"),o=require("./InputControl"),s=require("./main");return require("./TextBox"),e.prototype={type:"TextLine",initOptions:function(e){var t={width:300,height:200,value:""};if(a.isInput(this.main))this.helper.extractOptionsFromInput(this.main,t);if(r.extend(t,e),!t.hasOwnProperty("title")&&this.main.title)t.title=this.main.title;this.setProperties(t)},initStructure:function(){if(a.isInput(this.main))this.helper.replaceMain();this.main.innerHTML=t(this),this.helper.initChildren()},initEvents:function(){var e=this.helper.getPart("text"),t="oninput"in e?"input":"propertychange";this.helper.addDOMEvent(e,t,i),this.helper.addDOMEvent(e,"scroll",this.resetScroll)},repaint:require("./painters").createRepaint(o.prototype.repaint,{name:"height",paint:function(e,t){t=t||300;var i=e.helper.getPart("num-line");i.style.height=t+"px",e.main.style.height=t+"px"}},{name:"width",paint:function(e,t){t=t||300,e.main.style.width=t+"px"}},{name:"rawValue",paint:function(e,t){var a=e.helper.getPart("text");if(t){if(r.isArray(t))e.value=r.unescape(t.join("\n"));else if("string"==typeof t)e.value=r.unescape(t);var o="oninput"in a?"input":"propertychange";e.helper.removeDOMEvent(a,o,i),a.value=e.value,e.helper.addDOMEvent(a,o,i),n.call(e)}}},{name:["disabled","readOnly"],paint:function(e,t,i){var n=e.helper.getPart("text");n.disabled=!!t,n.readOnly=!!i}}),resetScroll:function(){var e=this.helper.getPart("text"),t=this.helper.getPart("num-line");t.style.height=e.clientHeight+"px",t.scrollTop=e.scrollTop},stringifyValue:function(e){return e.join("\n")},parseValue:function(e){return a.trim(e.replace(/\n{2,}/g,"\n")).split("\n")},getRawValue:function(){return r.unique(this.getValueRepeatableItems())},getValueRepeatableItems:function(){var e=this.helper.getPart("text").value,t=e.split("\n");return r.chain(t).map(a.trim).compact().value()},getRowsNumber:function(){var e=this.getValue().split("\n");return e.length},addLines:function(e){var t=e.join("\n"),i=this.getValue();if(i.length>0)t=i+"\n"+t;this.setRawValue(t)}},a.inherits(e,o),s.register(e),e}),define("esui/Table",["require","./lib","underscore","./controlHelper","./Control","./main"],function(require){function e(e){var t={followHeightArr:[0,0],followWidthArr:[],handlers:[]};Ne.call(this,Ie.extend({},e,t))}function t(e){return!("undefined"==typeof e||null===e)}function i(e){return!t(e)||!e.toString().length}function n(e,t,i){Ee.setAttribute(e,"data-"+t,i)}function r(e,t){return Ee.getAttribute(e,"data-"+t)}function a(e,t){var i=Ee.getStyle(e,t);return""===i?0:parseInt(i,10)||0}function o(e,t){return Oe.getId(e,t)}function s(e,t){return Oe.getPartClasses(e,t).join(" ")}function l(e){return Ee.g(o(e,"head"))}function u(e){return Ee.g(o(e,"body"))}function c(e){return Ee.g(o(e,"foot"))}function f(e,t){return Ee.g(o(e,"row")+t);
}function d(e){return Ee.g(o(e,"select-all"))}function h(e,t){e.selectedIndex=t;for(var i={},n=t.length-1;n>=0;n--)i[t[n]]=1;e.selectedIndexMap=i}function p(e,t){if(e.selectedIndexMap)return!!e.selectedIndexMap[t];else return!1}function m(e){for(var t=0,i=e.realFields,n=e.minColsWidth,r=0,a=i.length;a>r;r++){var o=i[r];t+=o.width||n[r]}return t}function g(e){if(e.width)return e.width;var t=document.createElement("div"),i=e.main.parentNode;i.appendChild(t);var n=t.offsetWidth;return t.parentNode.removeChild(t),n}function v(e){if(e.fields){for(var t=e.fields,i=t.slice(0),n=i.length;n--;)if(!i[n])i.splice(n,1);if(e.realFields=i,e.select)switch(e.select.toLowerCase()){case"multi":i.unshift(fe(e));break;case"single":i.unshift(de(e))}}}function y(e){if(e.followHead)if(x(e),!e.noFollowHeadCache)k(e)}function b(e){if(e.followHead)x(e),k(e)}function x(e){if(e.followHead){for(var t=e.followDoms=[],i=e.main.parentNode.firstChild,n=e.id;i;){if(1===i.nodeType&&r(i,"follow-thead")===n)t.push(i);i=i.nextSibling}C(e),w(e)}}function w(e){var t=e.followDoms,i=e.followHeightArr;i[0]=0;for(var n=0,r=t.length;r>n;n++){var a=t[n];i[n+1]=i[n]+a.offsetHeight}i[n+1]=i[n],i.lenght=n+2}function C(e){for(var t=e.followDoms,i=e.followWidthArr,n=0,r=t.length;r>n;n++){var o=t[n],s=a(o,"padding-left")+a(o,"padding-right")+a(o,"border-left-width")+a(o,"border-right-width");i[n]=s,t[n].style.width=e.realWidth-s+"px"}}function k(e){var t=e.followDoms,i=Ee.getOffset(t[0]||e.main);e.followTop=i.top,e.followLeft=i.left}function _(e){var t=e.realFields,i=[],n=e.fontSize,r=2*e.colPadding+5;if(!e.noHead)for(var a=0,o=t.length;o>a;a++){var s=t[a],l=s.minWidth;if(!l&&!s.breakLine)l=s.title.length*n+r+(e.sortable&&s.sortable?e.sortWidth:0)+(s.tip?e.tipWidth:0);i[a]=l}else for(var u=n+r,a=0,o=t.length;o>a;a++)i[a]=u;e.minColsWidth=i}function T(e){var t=e.realFields,i=[];e.colsWidth=[];var n="auto"===e.overflowX?m(e):e.realWidth;n=Math.max(n,e.realWidth),e.bodyWidth=n;for(var r=n-1,a=0,o=t.length;o>a;a++){var s=t[a],l=s.width;if(l=l?parseInt(l,10):0,e.colsWidth.push(l),r-=l,!s.stable)i.push(a)}for(var o=i.length,u=Math.round(r/o),a=0;o>a;a++){var c=i[a],f=Math.abs(r)<Math.abs(u)?r:u;r-=f,e.colsWidth[c]+=f;var d=e.minColsWidth[c];if(d>e.colsWidth[c])r+=e.colsWidth[c]-d,e.colsWidth[c]=d}if(0>r)for(var a=0;o>a&&0!==r;){var c=i[a],d=e.minColsWidth[c];if(d<e.colsWidth[c]){var f=e.colsWidth[i[a]]-d;f=f>Math.abs(r)?r:-f,r+=Math.abs(f),e.colsWidth[c]+=f}a++}else if(r>0)e.colsWidth[i[0]]+=r}function M(e){var t=c(e);if(!(e.foot instanceof Array))t&&(t.style.display="none");else{if(!t)t=document.createElement("div"),t.id=o(e,"foot"),t.className=s(e,"foot"),n(t,"control-table",e.id),e.main.appendChild(t);if(t.style.display="",e.realWidth)t.style.width=e.realWidth+"px";t.innerHTML=S(e)}}function S(e){var t=[],n=e.foot,r=0,a=e.colsWidth,o=s(e,"fcell"),l=s(e,"fcell-text"),u=e.rowWidthOffset;t.push(Ee.format(Re,{width:"100%",controlTableId:e.id}),"<tr>");for(var c=0,f=n.length;f>c;c++){var d=n[c],h=a[r],p=d.colspan||1,m=[o],g=d.content;if("function"==typeof g)g=g.call(e);if(i(g))g="&nbsp;";for(var v=1;p>v;v++)h+=a[r+v];if(r+=p,d.align)m.push(s(e,"cell-align-"+d.align));h+=u,0>h&&(h=0),t.push('<th id="'+E(e,c)+'" class="'+m.join(" ")+'"',' style="width:'+h+"px;",(h?"":"display:none;")+'">','<div class="'+l+'">',g,"</div></th>")}return t.push("</tr></table>"),t.join("")}function L(e){var t=l(e),i=o(e,"head-panel");if(!t)t=document.createElement("div"),t.id=o(e,"head"),t.className=s(e,"head"),n(t,"control-table",e.id),e.main.appendChild(t),t.innerHTML=Ee.format('<div id="${id}" data-ui="type:Panel;id:${id};"></div>',{id:i}),e.initChildren(t),e.headPanel=e.viewContext.get(i),Oe.addDOMEvent(e,t,"mousemove",Ie.bind(Y,t,e)),Oe.addDOMEvent(e,t,"mousedown",Ie.bind(z,t,e));if(e.noHead)return void(t.style.display="none");if(t.style.display="",e.bodyWidth)t.style.width=e.bodyWidth+"px";Ee.g(i).innerHTML=P(e),D(e,e.viewContext.get(i))}function D(e,t){if(t.children)t.disposeChildren();if(e.hasTip)t.initChildren()}function P(e){var t=e.realFields,n=s(e,"hcell"),r=s(e,"hcell-text"),a=s(e,"cell-break"),l=s(e,"hsort"),u=s(e,"hcell-sel"),c=-1,f=-1,d=e.rowWidthOffset;if(!e.disabled){for(var h=0,p=t.length;p>h;h++)if(!t[h].stable){c=h;break}for(var h=p-1;h>=0;h--)if(!t[h].stable){f=h;break}}var m=[];m.push(Ee.format(Re,{width:"100%",controlTableId:e.id}),"<tr>");for(var h=0,p=t.length;p>h;h++){var g=[n],v=t[h],y=v.title,b=e.sortable&&v.sortable,x=b&&v.field&&v.field===e.orderBy,w=r;if(0===h)w+=" "+s(e,"hcell-text-first");if(h===p-1)w+=" "+s(e,"hcell-text-last");var C="";if(b){if(g.push(s(e,"hcell-sort")),x)g.push(s(e,"hcell-"+e.order));C=Ee.format(He,{className:l})}if(v.align)g.push(s(e,"cell-align-"+v.align));if(e.breakLine||v.breakLine)g.push(a);var k="",_="",T=v.tip;if("function"==typeof T)_=T.call(e);else _=T;if(_)k=Ee.format(Ye,{id:o(e,"htip"+h),className:s(e,"htip"),content:_}),e.hasTip=!0;var M;if("function"==typeof y)M=y.call(e);else M=y;if(i(M))M="&nbsp;";m.push('<th id="'+A(e,h)+'"',' data-index="'+h+'"',' class="'+g.join(" ")+'"',b?' data-sortable="1"':"",h>=c&&f>h?' data-dragright="1"':"",f>=h&&h>c?' data-dragleft="1"':"",' style="',"width:"+(e.colsWidth[h]+d)+"px;",(e.colsWidth[h]?"":"display:none")+'">','<div class="'+w+(v.select?" "+u:"")+'">',k,M,C,"</div></th>")}return m.push("</tr></table>"),m.join("")}function A(e,t){return o(e,"title-cell")+t}function E(e,t){return o(e,"foot-cell")+t}function I(e,t){O(this,e)}function O(e,t){if(!e.isDraging&&!e.dragReady)if(Oe.addPartClasses(e,"hcell-hover",t),e.sortable){e.sortReady=1;var i=r(t,"index"),n=e.realFields[i];if(n&&n.sortable)Oe.addPartClasses(e,"hcell-sort-hover",t)}}function N(e,t){R(this,e)}function R(e,t){if(Oe.removePartClasses(e,"hcell-hover",t),e.sortable)e.sortReady=0,Oe.removePartClasses(e,"hcell-sort-hover",t)}function H(e,t){var i=this;if(i.sortable&&i.sortReady){var n=r(e,"index"),a=i.realFields[n];if(a.sortable){var o=i.orderBy,s=i.order;if(o===a.field)s=!s||"asc"===s?"desc":"asc";else s="desc";i.setProperties({order:s,orderBy:a.field}),i.fire("sort",{field:a,order:s})}}}function Y(e,t){if(e.columnResizable){var i="startdrag",n=8;if(!e.isDraging){var a=t.target;if(a=j(e,a)){var o=this,s=t.pageX||t.clientX+Ee.page.getScrollLeft(),l=Ee.getOffset(a),u=r(a,"sortable");if(r(a,"dragleft")&&s-l.left<n)u&&R(e,a),Oe.addPartClasses(e,i,o),e.dragPoint="left",e.dragReady=1;else if(r(a,"dragright")&&l.left+a.offsetWidth-s<n)u&&R(e,a),Oe.addPartClasses(e,i,o),e.dragPoint="right",e.dragReady=1;else Oe.removePartClasses(e,i,o),u&&O(e,a),e.dragPoint="",e.dragReady=0}}}}function j(e,t){for(;1===t.nodeType;){if("TH"===t.nodeName)return t;t=t.parentNode}return null}function z(e,t){if(e.columnResizable){e.fire("startdrag"),e.fire("dragstart");var i=s(e,"startdrag"),n=t.target;if(n=j(e,n))if(!(Ee.g(o(e,"head")).className.indexOf(i)<0)){e.htmlHeight=document.documentElement.clientHeight,e.isDraging=!0,e.dragIndex=r(n,"index"),e.dragStart=t.pageX||t.clientX+Ee.page.getScrollLeft(),B(e);var a=Ie.partial(F,e),l=function(t){var i=!0;try{i=Ie.partial(U,e)(t)}catch(n){}return Ee.un(document,"mousemove",a),Ee.un(document,"mouseup",l),i};return Ee.on(document,"mousemove",a),Ee.on(document,"mouseup",l),V(e,e.dragStart),Ee.event.preventDefault(t),!1}}}function B(e){var t=Ee.getOffset(e.main);e.top=t.top,e.left=t.left}function F(e,t){var i=t||window.event;return V(e,i.pageX||i.clientX+Ee.page.getScrollLeft()),Ee.event.preventDefault(i),!1}function V(e,t){var i=q(e),n=e.left+e.realWidth,r=e.left+1,a=n-1;if(t=r>t?r:t,t=t>a?a:t,!i)i=$(e);i.style.top=e.top+"px",i.style.left=t+"px",i.style.zIndex=e.zIndex||"";var o=e.htmlHeight-e.top+Ee.page.getScrollTop(),s=e.main.offsetHeight;o=s>o?o:s,i.style.height=o+"px"}function W(e){var t=q(e);t.style.left="-10000px",t.style.top="-10000px"}function $(e){var t=document.createElement("div");return t.id=o(e,"drag-mark"),t.className=s(e,"mark "),t.style.top="-10000px",t.style.left="-10000px",document.body.appendChild(t),t}function q(e){return Ee.g(o(e,"drag-mark"))}function U(e,t){var i=t||window.event,n=parseInt(e.dragIndex,10),r=i.pageX||i.clientX+Ee.page.getScrollLeft(),a=e.realFields,o=a.length,s=0,l=e.colsWidth,u=0;if("left"===e.dragPoint)n--;var c=e.minColsWidth[n],f=r-e.dragStart,d=l[n]+f;if(c>d)f+=c-d,d=c;for(var h=[],p=[],m=n+1;o>m;m++)if(!a[m].stable&&l[m]>0)h.push(m),b=l[m],p.push(b),s+=b;for(var g=f,v=h.length,m=0;v>m;m++){var y=h[m],b=p[m],x=f*b/s,w=g>0?Math.ceil(x):Math.floor(x);if(w=Math.abs(w)<Math.abs(g)?w:g,b-=w,g-=w,c=e.minColsWidth[y],c>b)u+=c-b,b=c;l[y]=b}return d-=u,l[n]=d,ce(e),e.isDraging=!1,W(e),e.fire("enddrag"),e.fire("dragend"),Ee.event.preventDefault(i),!1}function X(e){var t=u(e),i=o(e,"body-panel");if(!t){var n="body",r=o(e,n);t=document.createElement("div"),t.id=r,t.className=s(e,n),e.main.appendChild(t),t.innerHTML=Ee.format('<div id="${id}" data-ui="type:Panel;id:${id}"></div>',{id:i}),e.initChildren(t),e.bodyPanel=e.viewContext.get(i)}var a=t.style;if(a.overflowX="auto",a.overflowY="auto",e.bodyWidth)a.width=e.bodyWidth+"px";e.bodyPanel.disposeChildren(),Ee.g(i).innerHTML=Q(e),e.fire("bodyChange")}function G(e){var t=u(e),i=t.style,n=e.datasource.length,r=e.bodyMaxHeight;if(r>0&&n>0){var a=r,s=Ee.g(o(e,"body-panel"));if(s)a=s.offsetHeight;if(a>=r)return void(i.height=r+"px")}i.height="auto"}function Q(e){var t=e.datasource||[],i=t.length,n=[];if(!i)return Ee.format(je,{className:s(e,"body-nodata"),html:e.noDataHtml});for(var r=e.rowBuilderList,a=0;i>a;a++){var o=t[a];n.push(ee(e,o,a,r))}return n.join("")}function Z(e,t,i){return o(e,"cell")+t+"-"+i}function K(e,i){for(var n=e.rowBuilderList||[],r=0,a=i.length;a>r;r++){var o=i[r];if(o.getColHtml){if(o.getSubrowHtml)e.hasSubrow=!0;if(!t(o.index))o.index=1e3;n.push(o)}else;}n.sort(function(e,t){return e.index-t.index}),e.rowBuilderList=n}function J(e){K(e,[{index:1,getRowArgs:te,getColHtml:ie}])}function ee(e,i,n,r){function a(e,t){return e.index-t.index}for(var s=[],l=e.realFields,u=e.rowWidthOffset,c=[],f=[],d=[],h=0,p=r.length;p>h;h++){var m=r[h],g=m.getRowArgs?m.getRowArgs(e,n)||{}:{};c.push(g),g.rowClass&&f.push(g.rowClass),g.rowAttr&&d.push(g.rowAttr)}for(var h=0,p=l.length;p>h;h++){for(var v=l[h],y=e.colsWidth[h],b=[],x=[],w=[],C=[],k=[],_=[],T=-1,M=0,S=r.length;S>M;M++){var L=r[M].getColHtml(e,i,v,n,h,c[M]);if(L){var D=L.html;if(L.colClass)b.push(L.colClass);if(L.textClass)x.push(L.textClass);if(L.colAttr)w.push(L.colAttr);if(L.textAttr)C.push(L.textAttr);if(t(D))if(L.notInText)L.index=M,_.push(L);else k.push(D),0>T&&(T=M)}else;}var P="";if(k=['<div class="'+x.join(" ")+'" ',C.join(" ")+">",k.join(""),"</div>"].join(""),_.push({html:k,index:T}),_.sort(a),_.length>1){for(var P=['<table width="100%" cellpadding="0" cellspacing="0">',"<tr>"],M=0,S=_.length;S>M;M++){var A=_[M];P.push("<td ",t(A.width)?' width="'+A.width+'" ':"",A.align?' align="'+A.align+'">':">",A.html,"</td>")}P.push("</tr></table>"),P=P.join("")}else P=k;s.push('<td id="'+Z(e,n,h)+'" ','class="'+b.join(" ")+'" ',w.join(" ")+" ",'style="width:'+(y+u)+"px;",(y?"":"display:none")+'" ','data-control-table="'+e.id+'" ','data-row="'+n+'" data-col="'+h+'">',P,"</td>")}if(s.unshift(Ee.format(ze,{id:o(e,"row")+n,className:f.join(" "),attr:d.join(" "),index:n}),Ee.format(Re,{width:"100%",controlTableId:e.id})),s.push("</tr></table></div>"),e.hasSubrow)for(var h=0,p=r.length;p>h;h++){var E=r[h].getSubrowHtml;if(E)s.push(E(e,n,c[h]))}return s.join("")}function te(e,t){var i=e.datasource||[],n=i.length;return{tdCellClass:s(e,"cell"),tdBreakClass:s(e,"cell-break"),tdTextClass:s(e,"cell-text"),fieldLen:e.realFields.length,rowClass:[s(e,"row"),s(e,"row-"+(t%2?"odd":"even")),p(e,t)?s(e,"row-selected"):"",n-1===t?s(e,"row-last"):""].join(" ")}}function ie(e,t,n,r,a,l){var u=l.tdCellClass,c=l.tdBreakClass,f=l.tdTextClass,d=[u],h=[f],p=n.content;if(0===a)h.push(s(e,"cell-text-first"));if(a===l.fieldLen-1)h.push(s(e,"cell-text-last"));if(e.breakLine||n.breakLine)d.push(c);if(n.select)h.push(s(e,"cell-sel"));if(n.align)d.push(s(e,"cell-align-"+n.align));if(n.field&&n.field===e.orderBy)d.push(s(e,"cell-sorted"));var m="function"==typeof p?p.call(e,t,r,a):e.encode?Ee.encodeHTML(t[p]):t[p];if(i(m))m="&nbsp;";return{colClass:d.join(" "),textClass:h.join(" "),html:Ee.format(Be,{colTextId:o(e,"cell-textfield-"+r+"-"+a),content:m})}}function ne(e,t){if(!this.isDraging)Oe.addPartClasses(this,"row-hover",e)}function re(e,t){Oe.removePartClasses(this,"row-hover",e)}function ae(e,t){var i=this,n=Oe.getPartClasses(i,"cell-text")[0];if("line"===i.selectMode&&Ee.hasClass(t.target,n)){if(i.dontSelectLine)return void(i.dontSelectLine=!1);var a=r(e,"index");switch(i.select){case"multi":var s=Ee.g(o(i,"multi-select")+a);pe(i,a,!s.checked),me(i);break;case"single":xe(i,a,!0)}}}function oe(e){e.viewWidth=Ee.page.getViewWidth(),e.viewHeight=Ee.page.getViewHeight();var t=function(){var t=Ee.page.getViewWidth(),i=Ee.page.getViewHeight();if(t!==e.viewWidth||i!==e.viewHeight)e.viewWidth=t,e.viewHeight=i,se(e)};Oe.addDOMEvent(e,window,"resize",t)}function se(e){var t=l(e),i=c(e);e.realWidth=g(e);var n=e.realWidth+"px";if(e.realWidth)e.main.style.width=n;T(e),ce(e);var r=e.bodyWidth+"px";if(e.realWidth)u(e).style.width=r,t&&(t.style.width=r),i&&(i.style.width=n);if(e.followHead)C(e),w(e);B(e),e.fire("resize"),e.topReseter&&e.topReseter()}function le(e,t,i,n){if(e)e.style.top=i+"px",e.style.left=n+"px",e.style.position=t}function ue(e){if(e.followHead&&!e.topReseter){var t=l(e),i=o(e,"top-placeholder"),n=document.createElement("div");n.id=i,n.style.width="100%",n.style.display="none",Ee.insertBefore(n,e.main),n=null,e.topReseter=function(){if(e.followHead){var n=Ee.page.getScrollTop(),r=Ee.ie&&Ee.ie<7?"absolute":"fixed",a=e.main.offsetHeight,o="absolute"===r,s=Ee.g(i),l=e.followDoms;if(e.noFollowHeadCache){var u=t.style.position;if("fixed"!==u&&"absolute"!==u)k(e)}if(n>e.followTop&&(o||n-e.followTop<a)){var c=Ee.page.getScrollLeft(),f=e.followHeightArr,d=f.length;B(e);var h=o?e.left:e.left-c;if(s.style.height=f[d-1]+t.offsetHeight+"px",s.style.display="",Ee.ie&&Ee.ie<8)t.style.zIndex=e.zIndex+1;if(o){for(var p=0,m=l.length;m>p;p++)le(l[p],r,f[p]+n,h);le(t,r,f[d-1]+n,h)}else{for(var p=0,m=l.length;m>p;p++)le(l[p],r,f[p],h);le(t,r,f[d-1],h)}}else{s.style.height=0,s.style.display="none",r="";for(var p=0,m=l.length;m>p;p++)le(l[p],r,0,0);le(t,r,0,0),t.style.zIndex=""}}},Oe.addDOMEvent(e,window,"scroll",e.topReseter)}}function ce(e){var t=e.colsWidth,i=e.foot,n=e.id,a=i instanceof Array&&i.length,o=u(e).getElementsByTagName("td"),s=o.length,l=e.rowWidthOffset;if(a)for(var c=0,f=0;a>f;f++){for(var d=i[f],h=t[c],p=d.colspan||1,m=1;p>m;m++)h+=t[c+m];c+=p;var g=Ee.g(E(e,f));h=Math.max(h+l,0),g.style.width=h+"px",g.style.display=h?"":"none"}if(a=t.length,!e.noHead)for(var f=0;a>f;f++){var h=Math.max(t[f]+l,0),g=Ee.g(A(e,f));g.style.width=h+"px",g.style.display=h?"":"none"}for(var m=0,f=0;s>f;f++){var g=o[f];if(r(g,"control-table")===n){var h=Math.max(t[m%a]+l,0);g.style.width=h+"px",g.style.display=h?"":"none",m++}}}function fe(e){return{width:30,stable:!0,select:!0,title:function(t,i){var n={id:o(e,"select-all"),className:s(e,"select-all"),disabled:e.disabled?'disabled="disabled"':"",index:i};return Ee.format(Fe,n)},content:function(t,i){var n={id:o(e,"multi-select")+i,className:s(e,"multi-select"),disabled:e.disabled?'disabled="disabled"':"",index:i,checked:p(e,i)?'checked="checked"':""};return Ee.format(Ve,n)}}}function de(e){return{width:30,stable:!0,title:"&nbsp;",select:!0,content:function(t,i){var n=o(e,"single-select"),r={id:n+i,name:n,className:s(e,"single-select"),index:i,disabled:e.disabled?'disabled="disabled"':"",checked:p(e,i)?'checked="checked"':""};return Ee.format(We,r)}}}function he(e,t){var i=r(e,"index");pe(this,i),me(this)}function pe(e,i,n){var a="row-selected";if(i>=0){var s=Ee.g(o(e,"multi-select")+i);if(s){t(n)&&(s.checked=n);var l=f(e,i);if(s.checked)Oe.addPartClasses(e,a,l);else Oe.removePartClasses(e,a,l)}}else if(t(n))for(var u=ve(e,"checkbox"),c=0,d=u.length;d>c;c++){var s=u[c];s.checked=n;var h=r(s,"index"),l=f(e,h);if(n)Oe.addPartClasses(e,a,l);else Oe.removePartClasses(e,a,l)}}function me(e){for(var t=d(e),i=ve(e,"checkbox"),n=!0,a=[],s=o(e,"multi-select"),l=0,u=i.length;u>l;l++){var c=i[l];if(c.id.indexOf(s)>=0){var f=r(c,"index");if(!c.checked)n=!1;else a.push(f)}}h(e,a),e.fire("select",{selectedIndex:a}),t.checked=n}function ge(e){ye(this,d(this).checked)}function ve(e,t){for(var i=u(e).getElementsByTagName("input"),n=[],r=0,a=i.length;a>r;r++){var o=i[r],s=o.id;if(o.getAttribute("type")===t&&s)n.push(o)}return n}function ye(e,t){pe(e,-1,t),me(e)}function be(e,t){xe(this,r(e,"index"))}function xe(e,i,n){var r=e.selectedIndex,a=Ee.g(o(e,"single-select")+i);if(a){if(t(n)&&(a.checked=n),e.fire("select",{selectedIndex:i}),r&&r.length)Oe.removePartClasses(e,"row-selected",f(e,r[0]));h(e,[i]),Oe.addPartClasses(e,"row-selected",f(e,i))}}function we(e){e.main.style.zIndex=e.zIndex||""}function Ce(e){for(var t=ve(e,"multi"===e.select?"checkbox":"radio"),i=t.length-1;i>=0;i--)if(e.disabled)t[i].setAttribute("disabled","disabled");else t[i].removeAttribute("disabled");if("multi"===e.select){var n=d(e);if(n)if(e.disabled)n.setAttribute("disabled","disabled");else n.removeAttribute("disabled")}if(e.children&&e.children.length)for(var r=e.children,i=r.length-1;i>=0;i--)r[i].setDisabled(e.disabled)}function ke(e){var t=" "+e+" ";return function(e){var i=" "+e.className+" ";return i.replace($e," ").indexOf(t)>=0}}function _e(e,t){var i=null;if(t)i="function"==typeof t?t:ke(t);return{handler:e,matchFn:i}}function Te(e,t,i){var n=t.id,r=e.handlers[n];if(!r)r=e.handlers[n]={};if(i)if(r=e.handlers[i],!r)r=e.handlers[i]=[];return r}function Me(e,t,i,n){var r=Te(e,t,i),a=[];if(!r.length)De(e,t,i);for(var o=0,s=n.length;s>o;o++){var l=n[o],u=_e(l.handler,l.matchFn);r.push(u),a.push(u)}return a}function Se(e,t,i,n){for(var r=Te(e,t,i),a=0,o=n.length;o>a;a++)for(var s=n[a],l=0,u=r.length;u>l;l++)if(r[l]===s)r.splice(l,1),l--;if(!r.length)Pe(e,t,i)}function Le(e,t,i){return function(n){for(var n=n||window.event,r=n.target;r;){if(1===r.nodeType)for(var a=t.length-1;a>=0;a--){var o=t[a];if(!o.matchFn||o.matchFn(r))o.handler.call(i,r,n)}if(r===e)break;r=r.parentNode}}}function De(e,t,i){var n=Te(e,t,i);Oe.addDOMEvent(e,t,i,Le(t,n,e))}function Pe(e,t,i){Oe.removeDOMEvent(e,t,i)}function Ae(e){var t=Oe.getPartClasses,i=t(e,"row")[0],n=t(e,"hcell")[0],r=t(e,"select-all")[0],a=t(e,"multi-select")[0],o=t(e,"single-select")[0];Me(e,e.main,"mouseover",[{handler:ne,matchFn:i},{handler:I,matchFn:n}]),Me(e,e.main,"mouseout",[{handler:re,matchFn:i},{handler:N,matchFn:n}]),Me(e,e.main,"click",[{handler:ae,matchFn:i},{handler:H,matchFn:n},{handler:ge,matchFn:r},{handler:he,matchFn:a},{handler:be,matchFn:o}])}var Ee=require("./lib"),Ie=require("underscore"),Oe=require("./controlHelper"),Ne=require("./Control");e.defaultProperties={noDataHtml:"没有数据",noFollowHeadCache:!1,followHead:!1,sortable:!1,encode:!1,columnResizable:!1,rowWidthOffset:-1,select:"",selectMode:"box",subrowMutex:1,subEntryOpenTip:"点击展开",subEntryCloseTip:"点击收起",subEntryWidth:18,breakLine:!1,hasTip:!1,hasSubrow:!1,tipWidth:18,sortWidth:9,fontSize:13,colPadding:8,zIndex:0,overflowX:"hidden"};var Re='<table cellpadding="0" cellspacing="0" width="${width}" data-control-table="${controlTableId}">',He='<div class="${className}"></div>',Ye='<div id="${id}" class="${className}" data-ui="type:Tip;id:${id};content:${content}"></div>',je='<div class="${className}">${html}</div>',ze='<div id="${id}" class="${className}" data-index="${index}" ${attr}>',Be='<span id="${colTextId}">${content}</span>',Fe='<input type="checkbox" id="${id}" class="${className}" data-index="${index}" ${disabled}/>',Ve='<input type="checkbox" id="${id}" class="${className}" data-index="${index}" ${disabled} ${checked} />',We='<input type="radio" id="${id}" name="${name}" class="${className}" data-index="${index}" ${disabled} ${checked} />',$e=/[\t\r\n]/g;return e.prototype={type:"Table",initOptions:function(t){var i={};Ie.extend(i,e.defaultProperties,t),this.setProperties(i)},initStructure:function(){if(this.realWidth=g(this),this.realWidth)this.main.style.width=this.realWidth+"px";we(this),J(this),oe(this),Ae(this)},repaint:function(t,i){Ne.prototype.repaint.apply(this,arguments);var n=this;if(!n.realWidth)if(n.realWidth=g(n),n.realWidth)n.main.style.width=n.realWidth+"px";var r=e.defaultProperties,a={};if(!t){for(var o in r)if(r.hasOwnProperty(o))a[o]=!0}else for(var s=0;s<t.length;s++){var l=t[s];a[l.name]=!0}var u=!1,c=!1,f=!1;if(a.fields||a.select||a.selectMode||a.sortable)v(n),u=!0;if(u||a.breakLine||a.colPadding||a.fontSize)_(n),T(n),c=!0;if(u||c||a.noHead||a.order||a.orderBy||a.selectedIndex)L(n);if(a.followHead||a.noFollowHeadCache)y(n),ue(n);if(u||c||a.encode||a.noDataHtml||a.datasource||a.selectedIndex)X(n),f=!0;if(f||a.bodyMaxHeight)G(n);if(u||c||a.foot)M(n);if(n.extraRepaint=Oe.createRepaint([{name:"disabled",paint:Ce},{name:"width",paint:se},{name:"zIndex",paint:we}]),n.extraRepaint(t,i),f&&Oe.isInStage(n,"RENDERED"))switch(n.select){case"multi":h(n,[]),n.fire("select",{selectedIndex:n.selectedIndex})}if(n.realWidth!==g(n))se(n)},getId:function(e){return o(this,e)},getBodyCellId:function(e,t){return Z(this,e,t)},setCellText:function(e,t,n,r){if(r)e=Ee.encodeHTML(e);e=i(e)?"&nbsp":e,Ee.g(o(this,"cell-textfield-"+t+"-"+n)).innerHTML=e},getClass:function(e){return s(this,e)},getRow:function(e){return f(this,e)},addRowBuilders:function(e){K(this,e)},addHandlers:function(e,t){if(!t.length)t=[t];return Me(this,this.main,e,t)},removeHandlers:function(e,t){if(!t.length)t=[t];Se(this,this.main,e,t)},adjustWidth:function(){se(this)},setDatasource:function(e){this.datasource=e,h(this,[]);var t={name:"datasource"},i={name:"selectedIndex"};this.repaint([t,i],{datasource:t,selectedIndex:i})},updateRowAt:function(e,t){t&&(this.datasource[e]=t);var i=this.datasource[e],n=f(this,e);if(i&&n){this.fire("beforerowupdate",{index:e,data:i});var r=document.createElement("div");r.innerHTML=ee(this,t,e,this.rowBuilderList);var a=r.children[0];n.parentNode.replaceChild(a,n),this.fire("afterrowupdate",{index:e,data:i})}},getSelectedItems:function(){var e=this.selectedIndex,t=[];if(e){var i=this.datasource;if(i)for(var n=0;n<e.length;n++)t.push(i[e[n]])}return t},setRowSelected:function(e,t){var i=this,n="multi"===i.select,r=n?pe:xe;if(Ie.isArray(e))if(n)Ie.each(e,function(e){r(i,e,t)});else r(i,e[0],t);else r(i,e,t);if(n)me(i)},setAllRowSelected:function(e){this.setRowSelected(-1,e)},resetFollowHead:function(){b(this)},dispose:function(){if(!Oe.isInStage(this,"DISPOSED")){Oe.beforeDispose(this);var e=this.main;if(e){this.followDoms=null;var t=Ee.g(o(this,"drag-mark"));if(t)document.body.removeChild(t)}this.rowBuilderList=null,this.headPanel.disposeChildren(),this.bodyPanel.disposeChildren(),this.headPanel=null,this.bodyPanel=null,Oe.dispose(this),Oe.afterDispose(this)}}},Ee.inherits(e,Ne),require("./main").register(e),e}),define("esui/Tab",["require","underscore","./lib","./Control","./painters","./main"],function(require){function e(){l.apply(this,arguments)}function t(e){for(var t=[],i=s.getChildren(e),n=0;n<i.length;n++){var r=i[n],a={title:s.getText(r),panel:r.getAttribute("data-for")};if(r.className)a.classes=r.className.split(/\s+/);t.push(a)}return t}function i(e){for(var t=e.target,i=t;i&&"li"!==i.nodeName.toLowerCase();)i=i.parentNode;if(i&&"li"===i.nodeName.toLowerCase())for(var n=i.parentNode,r=s.getChildren(n),a=0;a<r.length;a++)if(r[a]===i){if(this.helper.isPart(t,"close"))this.removeAt(a);else this.set("activeIndex",a);return}}function n(e,t,i,n){var r=document.createElement("li");if(e.helper.addPartClasses("item",r),t.classes)s.addClasses(r,t.classes);if(i)e.helper.addPartClasses("item-active",r);return r.innerHTML=e.getContentHTML(t,n),e.helper.initChildren(r),r}function r(e){var t=e.helper.getPart("navigator"),i=t.parentNode,r=t.nextSibling;t.innerHTML="",t.parentNode.removeChild(t);for(var a=0;a<e.tabs.length;a++){var o=e.tabs[a],s=e.activeIndex===a,l=n(e,o,s,e.allowClose);t.appendChild(l)}i.insertBefore(t,r)}function a(e,t){for(var i=0;i<e.tabs.length;i++){var n=e.tabs[i];if(n.panel){var r=s.g(n.panel);if(r)r.style.display=i===t?"":"none"}var a=e.helper.getPart("navigator"),o=s.getChildren(a),l=o[i],u=i===t?"addPartClasses":"removePartClasses";e.helper[u]("item-active",l)}var c={activeIndex:t,tab:e.tabs[t]};e.fire("activate",c)}var o=require("underscore"),s=require("./lib"),l=require("./Control");return e.prototype.type="Tab",e.prototype.initOptions=function(e){var i={tabs:[],activeIndex:0,allowClose:!1,orientation:"horizontal"};o.extend(i,e);var n=s.getChildren(this.main);if(n.length){for(var r=[],a=0;a<n.length;a++){var l=n[a];if("navigator"===l.getAttribute("data-role")){this.navigatorElement=l,i.tabs=t(l);break}else{var u={title:l.getAttribute("title"),panel:l.id};r.push(u)}}if(!i.tabs.length)i.tabs=r}if("string"==typeof i.activeIndex)i.activeIndex=+i.activeIndex;this.setProperties(i)},e.prototype.initStructure=function(){var e=this.navigatorElement;if(this.navigatorElement=null,!e)e=document.createElement("ul"),this.main.insertBefore(e,this.main.firstChild||null);e.id=this.helper.getId("navigator"),this.helper.addPartClasses("navigator",e)},e.prototype.initEvents=function(){this.helper.addDOMEvent("navigator","click",i)},e.prototype.contentTemplate="<span>${title}</span>",e.prototype.getContentHTML=function(e,t){var i=s.format(this.contentTemplate,{title:o.escape(e.title)});if(t)i+='<span class="'+this.helper.getPartClassName("close")+'">关闭</span>';return i},e.prototype.setProperties=function(e){if(e.tabs){if(null==e.activeIndex){for(var t=this.tabs[this.activeIndex],i=-1,n=0;n<e.tabs.length;n++)if(e.tabs[n]===t){i=n;break}if(-1===i)this.activeIndex=-1,e.activeIndex=0;else this.activeIndex=i}if(null!=e.allowClose)this.allowClose=e.allowClose,delete e.allowClose}l.prototype.setProperties.apply(this,arguments)},e.prototype.repaint=require("./painters").createRepaint(l.prototype.repaint,{name:["tabs","allowClose"],paint:r},{name:"activeIndex",paint:a},{name:"orientation",paint:function(e,t){e.removeState("vertical"),e.removeState("horizontal"),e.addState(t)}}),e.prototype.activate=function(e){for(var t=0;t<this.tabs.length;t++)if(this.tabs[t]===e)this.set("activeIndex",t)},e.prototype.add=function(e){this.insert(e,this.tabs.length)},e.prototype.insert=function(e,t){t=Math.min(t,this.tabs.length),t=Math.max(t,0),this.tabs.splice(t,0,e);var i=n(this,e,!1,this.allowClose),r=this.helper.getPart("navigator"),o=s.getChildren(r);if(r.insertBefore(i,o[t]||null),1===this.tabs.length)this.activeIndex=0,a(this,0);else{if(t<=this.activeIndex)this.activeIndex++;if(e.panel){var l=s.g(e.panel);if(l)l.style.display="none"}}this.fire("add",{tab:e,index:t})},e.prototype.remove=function(e){for(var t=0;(t=o.indexOf(this.tabs,e,t))>=0;)this.removeAt(t)},e.prototype.removeAt=function(e){var t=this.tabs.splice(e,1)[0],i=this.helper.getPart("navigator");if(t){var n=s.getChildren(i),r=n[e];if(r.parentNode.removeChild(r),e<this.activeIndex)this.activeIndex--;else if(e===this.activeIndex)this.activeIndex=Math.min(this.activeIndex,this.tabs.length-1),a(this,this.activeIndex);if(t.panel){var o=s.g(t.panel);if(o)o.style.display="none"}this.fire("remove",{tab:t,index:e})}},e.prototype.getActiveTab=function(){return this.get("tabs")[this.get("activeIndex")]},s.inherits(e,l),require("./main").register(e),e}),define("esui/Sidebar",["require","./lib","./Control","./main","./Panel","./controlHelper","./Button"],function(require){function e(){x.apply(this,arguments)}function t(e){return b.g(k.getId(e,"mat"))}function i(e){return b.g(k.getId(e,"minibar"))}function n(e){var t=b.dom.first(e.main);if(t){b.addClasses(t,k.getPartClasses(e,"head")),e.headEl=t;var i=b.dom.next(t);if(i){e.bodyEl=i,b.addClasses(i,k.getPartClasses(e,"body"));var n=new C({main:i,renderOptions:e.renderOptions});e.addChild(n,"content"),n.render()}}}function r(e){var t=e,i=document.createElement("div"),n=k.getPartClasses(t,"mat");i.id=k.getId(t,"mat"),i.className=n.join(" "),document.body.appendChild(i)}function a(e){var t=e,i=document.createElement("div"),n=[],r=k.getPartClasses(t,"minibar-text");t.headEl&&n.push('<div class="'+r.join(" ")+'">'+t.headEl.innerHTML+"</div>");var a=k.getPartClasses(t,"minibar-arrow");n.push('<div class="'+a.join(" ")+'"></div>'),i.innerHTML=n.join(""),i.id=k.getId(t,"minibar"),i.className=k.getPartClasses(t,"minibar").join(" "),k.addDOMEvent(t,i,"mouseover",b.bind(d,null,t,i)),k.addDOMEvent(t,i,"mouseout",b.bind(h,null,t,i)),document.body.appendChild(i)}function o(e){var t=e,i=t.main;require("./Button");var n=w.create("Button",{id:k.getId(t,"autohide"),skin:"autohide"}),r=w.create("Button",{id:k.getId(t,"fixed"),skin:"fixed"});n.appendTo(i),r.appendTo(i),t.addChild(n,"btnAutoHide"),t.addChild(r,"btnFixed"),n.onclick=b.curry(m,t),r.onclick=b.curry(p,t)}function s(e){var n=e,r=b.page.getScrollTop(),a=n.marginTop||0,o=Math.max(n.top+a-r,a),s=n.main,l=t(n),u=i(n);s.style.top=o+"px",u.style.top=o+"px",l.style.top=o-a+"px"}function l(e){var t=e,n=t.main;n.style.cssText+=";left: "+(t.marginLeft?t.marginLeft+"px":0)+";bottom:"+(t.marginBottom?t.marginBottom+"px":0)+";";var r=t.bodyEl;r.style.top=t.headHeight?t.headHeight+"px":0;var a=i(t);a.style.bottom=t.marginBottom?t.marginBottom+"px":0,s(t)}function u(e){t(e).style.display="none"}function c(e){if(t(e).style.display="block",e.main.style.display="block",i(e).style.display="none",!e.isAutoHide())u(e)}function f(e){u(e),e.main.style.display="none",i(e).style.display="block"}function d(e,t){var i=e,n=k.getPartClasses(i,"minibar-hover");if(!b.hasClass(t,n[0]))b.addClasses(t,n),i.minibarDisplayTick=setTimeout(function(){c(i)},i.autoDelay)}function h(e,t){var i=e,n=k.getPartClasses(i,"minibar-hover");b.removeClasses(t,n),clearTimeout(i.minibarDisplayTick)}function p(e){e.setMode("fixed")}function m(e){e.setMode("autohide")}function g(e,t){var i=e;if(t=t.toLowerCase(),"fixed"===t)i.getChild("btnAutoHide").show(),i.getChild("btnFixed").hide();else i.getChild("btnAutoHide").hide(),i.getChild("btnFixed").show();i.mode=t}function v(e){clearTimeout(e.minibarDisplayTick)}function y(e,t){var i=e;if(e.isAutoHide()){t=t||window.event;var n=t.relatedTarget||t.toElement;if(!b.dom.contains(e.main,n))i.minibarDisplayTick=setTimeout(function(){f(i)},i.autoDelay)}}var b=require("./lib"),x=require("./Control"),w=require("./main"),C=require("./Panel"),k=require("./controlHelper");return e.prototype.type="Sidebar",e.prototype.createMain=function(e){if(!e.tagName)return x.prototype.createMain.call(this);else return document.createElement(e.tagName)},e.prototype.initOptions=function(e){var t={headHeight:37,marginTop:10,marginLeft:10,marginBottom:10,autoDelay:300,mode:"fixed"};b.extend(t,e);var i=this.main,n=i.parentNode,r=b.getOffset(n),a=b.getOffset(i);if(null==this.initialOffsetTop)this.initialOffsetTop=a.top-r.top,t.top=a.top,t.left=a.left;else t.top=r.top+this.initialOffsetTop;b.extend(this,t)},e.prototype.initStructure=function(){if(n(this),r(this),a(this),o(this),!b.ie||b.ie>=7)this.topReset=b.curry(s,this),b.on(window,"scroll",this.topReset);if(l(this),this.isAutoHide())f(this)},e.prototype.initEvents=function(){this.helper.addDOMEvent(this.main,"mouseover",b.bind(v,null,this)),this.helper.addDOMEvent(this.main,"mouseout",b.bind(y,null,this))},e.prototype.repaint=k.createRepaint(x.prototype.repaint,{name:"mode",paint:function(e,t){if(g(e,t),e.isAutoHide())f(e);else c(e);if(k.isInStage(e,"RENDERED"))e.fire("modechange",{mode:t})}}),e.prototype.setMode=function(e){this.setProperties({mode:e})},e.prototype.getMode=function(){return this.mode},e.prototype.getPanel=function(){return this.getChild("content")},e.prototype.setContent=function(e){var t=this.getPanel();if(t)t.setProperties({content:e})},e.prototype.isAutoHide=function(){return"autohide"===this.mode},e.prototype.dispose=function(){if(!k.isInStage(this,"DISPOSED")){if(k.beforeDispose(this),this.topReset)b.un(window,"scroll",this.topReset),
this.topReseter=null;var e=t(this),n=i(this);document.body.removeChild(n),document.body.removeChild(e),this.headEl=null,this.bodyEl=null,k.dispose(this),k.afterDispose(this)}},b.inherits(e,x),w.register(e),e}),define("esui/SearchBox",["require","./lib","esui","./Control","./TextBox","./Button","mini-event","./painters"],function(require){function e(e){a.apply(this,arguments)}function t(){this.removeState("clear"),this.addState("focus")}function i(){if(this.hasState("clear"))this.getChild("text").setValue(""),this.removeState("clear");this.fire("search")}var n=require("./lib"),r=require("esui"),a=require("./Control");require("./TextBox"),require("./Button"),e.prototype.type="SearchBox",e.prototype.initOptions=function(e){var t={};if(n.extend(t,e),"false"===t.disabled)t.disabled=!1;if(n.isInput(this.main)){if(!t.placeholder)t.placeholder=n.getAttribute(this.main,"placeholder");if(!t.text)t.text=this.main.value;if(!t.maxLength&&(n.hasAttribute(this.main,"maxlength")||this.main.maxLength>0))t.maxLength=this.main.maxLength}else if(!t.text)t.text=n.getText(this.main);if(!t.title)t.title=this.main.title;a.prototype.initOptions.call(this,t)},e.prototype.initStructure=function(){var e={mode:"text",childName:"text",height:this.height,viewContext:this.viewContext,placeholder:this.placeholder};if(n.isInput(this.main))this.helper.replaceMain();var t=r.create("TextBox",e);t.appendTo(this.main),this.addChild(t);var i={main:document.createElement("span"),childName:"button",content:"搜索",viewContext:this.viewContext},a=r.create("Button",i);a.appendTo(this.main),this.addChild(a)},e.prototype.initEvents=function(){var e=this.getChild("text"),r=require("mini-event").delegate;r(e,this,"input"),r(e,"enter",this,"search"),e.on("keypress",function(e){if(13===e.keyCode)e.preventDefault()}),e.on("focus",t,this),e.on("blur",n.bind(this.removeState,this,"focus"));var a=this.getChild("button");a.on("click",i,this)},e.prototype.getValue=function(){var e=this.getChild("text");return e.getValue()};var o=require("./painters");return e.prototype.repaint=o.createRepaint(a.prototype.repaint,o.attribute("title"),{name:["maxLength","placeholder","text","width","disabled","readOnly"],paint:function(e,t,i,n,r,a,o){var s={maxLength:t,placeholder:i,value:n,width:r,disabled:a,readOnly:o};e.getChild("text").setProperties(s)}},{name:"disabled",paint:function(e,t){if("false"===t)t=!1;var i=e.getChild("button");i.set("disabled",t)}},{name:"fitWidth",paint:function(e,t){var i=t?"addState":"removeState";e[i]("fit-width")}}),e.prototype.getTextProperty=function(){var e=this.getChild("text");return e?e.getValue():this.text},n.inherits(e,a),r.register(e),e}),define("esui/Schedule",["require","./lib","./InputControl","./controlHelper","./main"],function(require){function e(e){N.apply(this,arguments)}function t(){function e(e){for(var t=[],i=0;7>i&&i<e.length;i++){t[i]=[];for(var n=0;24>n;n++)t[i][n]=e[i]}return t}return[{text:"全周投放",tip:"周一到周日全天投放",getValue:function(){return e([1,1,1,1,1,1,1])}},{text:"周一到周五投放",tip:"周一到周五全天投放",getValue:function(){return e([1,1,1,1,1,0,0])}},{text:"周末投放",tip:"周六、周日全天投放",getValue:function(){return e([0,0,0,0,0,1,1])}}]}function i(){for(var e=[],t=0;7>t;t++){var i=[];e.push(i);for(var n=0;24>n;n++)i.push(0)}return e}function n(e,t){return R.getPartClasses(e,t).join(" ")}function r(e,t){return R.getId(e,t)}function a(e){var t=e,i=[],r='<span class="${clazz}" data-item="${index}" >${text}</span>',a=n(t,"shortcut-text-item");i.push('<span class="'+a+'">快速设定：</span>');for(var o=t.shortcut,s=n(t,"shortcut-item"),l=0,u=o.length;u>l;l++){var c=o[l];i.push(O.format(r,{clazz:s,text:c.text,index:l}))}return i.join("")}function o(e){O.g(r(e,"body")).innerHTML=""+s(e)+l(e)+u(e)}function s(e){var t=e,i=[],a=n(t,"time-line"),o=r("body-head");i.push('<div class="',a,'" id="',o+'">');for(var s=n(t,"time-head"),l=0;24>=l;l+=2)i.push('<div class="',s,'" data-time="',l,'" ','id="',r(t,"time-head"+l),'">',l,"</div>");return i.push("</div>"),i.join("")}function l(e){var t=e,i=[],a=n(t,"day-head"),o=r(t,"day-head");i.push('<div id="',o,'" class="',a,'">');for(var s=n(t,"day"),l='<div class="'+s+'"><input type="checkbox" id="${dayId}" value="${value}">&nbsp;<label for="${dayId}">${dayWord}</label></div>',u=t.dayTexts,c=0;7>c;c++)i.push(O.format(l,{dayWord:u[c],dayId:r(t,"line-state"+c),value:c}));return i.push("</div>"),i.join("")}function u(e){var t=e,i=[],a='<div class="${timeClass}" id="${itemId}" data-day="${dayIndex}" data-time-item="1" data-time="${timeIndex}"></div>',o=n(t,"time-body"),s=r(t,"time-body");i.push('<div id="',s,'" class="',o,'">');for(var l=n(t,"line"),u=0;7>u;u++){var c=r(t,"line"+u);i.push('<div class="',l,'" id="',c,'">');for(var f=0;24>f;f++){var d=r(t,"time_"+u+"_"+f);i.push(O.format(a,{itemId:d,timeClass:n(t,"time"),dayIndex:u,timeIndex:f}))}i.push("</div>")}return i.push("</div>"),i.join("")}function c(e,t){for(var i=e,n=R.getPartClasses(i,"time-selected"),a=R.getPartClasses(i,"time-hover"),o=0;7>o;o++){var s=[],l=O.g(r(i,"line"+o));h(e,l);for(var u=0;24>u;u++){var c=O.g(r(i,"time_"+o+"_"+u)),d=t[o][u];if(d)O.addClasses(c,n);else O.removeClasses(c,n);O.removeClasses(c,a),s.push(d)}f(i,s,l,o)}}function f(e,t,i,a){var o=e,s=a,l=O.g(r(o,"line-state"+s));l.checked=!1;for(var u,c=/1{3,}/g,f=t.join(""),h=n(o,"continue-covertimes"),p='<div class="${coverClass}"><strong>${text}</strong></div>';null!=(u=c.exec(f));){var m=u[0].length,g=u.index,v=g+m,y=document.createElement("aside"),b=";width:"+25*m+"px;top:0;left:"+25*g+"px;";l.checked=24===m?!0:!1,y.setAttribute("data-start-time",g),y.setAttribute("data-end-time",v),y.setAttribute("data-day",s),y.className=h,y.style.cssText+=b,y.innerHTML=O.format(p,{start:g,end:v,text:24===m?"全天投放":g+":00-"+v+":00",coverClass:n(o,"covertimes-tip")}),i.appendChild(y),R.addDOMEvent(o,y,"mouseover",O.curry(d,y))}}function d(e){e.style.display="none"}function h(e,t){for(var i=t.getElementsByTagName("aside"),n=i.length;n;){var r=i[0];if(null!=r.getAttribute("data-day"))R.clearDOMEvents(e,r),t.removeChild(r);n--}}function p(e,t,i,a){var o=e;t=t||r(o,"tip");var s=O.g(t);if(s)s.style.top=i.y+"px",s.style.left=i.x+"px",s.innerHTML=a;else{var l=";position:absolute;z-index:5000;background:#fff6bd;top:"+i.y+"px;left:"+i.x+"px;display:none;",u=n(o,"shortcut-item-tip");s=document.createElement("div"),s.style.cssText=l,s.id=t,s.className=u,s.innerHTML=a,document.body.appendChild(s),o.followTip[t]=s}return o.tipElementTime=setTimeout(function(){s.style.display="block"},100),s}function m(e,t){clearTimeout(e.tipElementTime);var i=O.g(t);i&&(i.style.display="none")}function g(e){var t=O.event.getTarget(e);if("input"===t.nodeName.toLowerCase()){for(var i=this,n=t,r=parseInt(n.value,10),a=n.checked,o=A(i.rawValue),s=o[r],l=0,u=s.length;u>l;l++)s[l]=a?1:0;i.setRawValue(o)}}function v(e){var t=O.event.getTarget(e);if(t&&O.hasAttribute(t,"data-item")){var i=t.getAttribute("data-item"),n=this.shortcut[i].getValue;"function"==typeof n&&n.call(this);var r;if("function"==typeof n)r=n.call(this);else r=n;this.setRawValue(r)}}function y(e){var t=O.event.getTarget(e);if(t&&t.getAttribute("data-item")){var i=t,n=this;O.event.getMousePosition(e);var a={};a.y=e.pageY+20,a.x=e.pageX+10;var o=i,s=o.getAttribute("data-item"),l=r(n,"shortcut-item")+s;setTimeout(function(){var e=O.g(l);if(e)e.style.top=a.y+"px",e.style.left=a.x+"px"},0)}}function b(e,t){var i=O.event.getTarget(t);if(i&&i.getAttribute("data-item")){var n=i;O.event.getMousePosition(t);var a={};a.y=t.pageY+20,a.x=t.pageX+10;var o=this,s=n,l=s.getAttribute("data-item"),u=r(o,"shortcut-item")+l,c=R.getPartClasses(o,"shortcut-item-hover");if(e){O.addClasses(s,c);var f=o.shortcut[l].tip;p(o,u,a,f)}else O.removeClasses(s,c),m(o,u)}}function x(e){var t=O.event.getTarget(e);if(t&&t.getAttribute("data-time-item")){var i=t;O.addClasses(i,R.getPartClasses(this,"time-hover")),O.event.getMousePosition(e);var a={};a.y=e.pageY+20,a.x=e.pageX+10;var o=this,s=parseInt(i.getAttribute("data-time"),10),l=parseInt(i.getAttribute("data-day"),10),u=O.format(j,{time:"<strong>"+s+":00</strong>&nbsp;—&nbsp;<strong>"+(s+1)+":00</strong>",text:"点击/拖动鼠标选择",timeId:r(o,"timeitem-tip-head"),textId:r(o,"timeitem-tip-body"),timeClass:n(o,"timeitem-tip-head"),textClass:n(o,"timeitem-tip-body")}),c=r(o,"timeitem-tip");p(o,c,a,u);for(var f=O.g(r(o,"time-body")),d=f.getElementsByTagName("aside"),h=0,m=d.length;m>h;h++){var g=d[h],v=parseInt(g.getAttribute("data-start-time"),10),y=parseInt(g.getAttribute("data-end-time"),10),b=parseInt(g.getAttribute("data-day"),10);if(s>=v&&y>s&&l===b)g.style.display="none";else g.style.display="block"}}}function w(e){var t=O.event.getTarget(e);if(t&&t.getAttribute("data-time-item"))O.removeClasses(t,R.getPartClasses(this,"time-hover")),m(this,r(this,"timeitem-tip"))}function C(e){var t=this,i=document;H=O.bind(k,t),Y=O.bind(_,t),O.on(i,"mousemove",H),O.on(i,"mouseup",Y),O.event.getMousePosition(e),this.dragStartPos={x:e.pageX,y:e.pageY};var n=O.g(r(t,"time-body"));t.dragRange=[];var a=O.getOffset(n).top,o=O.getOffset(n).left;t.dragRange.push(a),t.dragRange.push(o+n.offsetWidth),t.dragRange.push(a+n.offsetHeight),t.dragRange.push(o),L(n);var s=M(this,{x:e.pageX,y:e.pageY}),l=r(t,"timeitem-tip");O.g(l)&&(O.g(l).style.display="none"),S(this,s)}function k(e){O.event.getMousePosition(e);var t=M(this,{x:e.pageX,y:e.pageY});S(this,t)}function _(e){var t=this;D(O.g(r(t,"time-body")));var i=O.g(r(t,"follow-item"));i.style.display="none",O.event.getMousePosition(e);var n=M(t,{x:e.pageX,y:e.pageY});setTimeout(function(){T(t,n)},10);var a=document;O.un(a,"mousemove",H),O.un(a,"mouseup",Y)}function T(e,t){for(var i=e,n=t.startcell,r=t.endcell,a=Math.min(n.x,r.x),o=Math.min(n.y,r.y),s=Math.max(n.x,r.x),l=Math.max(n.y,r.y),u=A(i.rawValue),c=o;l>=c;c++)for(var f=a;s>=f;f++)if(u[c][f])u[c][f]=0;else u[c][f]=1;i.setRawValue(u)}function M(e,t){var i=e,n=i.dragRange,r=i.dragStartPos,a={};if(t.x<=n[1]&&t.x>=n[3])a.x=t.x;else a.x=t.x-r.x<0?n[3]:n[1];if(t.y<=n[2]&&t.y>=n[0])a.y=t.y;else a.y=t.y-r.y<0?n[0]:n[2];var o={startcell:{},endcell:{}};if(o.startcell.x=Math.floor((r.x-i.dragRange[3])/25),o.startcell.y=Math.floor((r.y-i.dragRange[0])/25),o.endcell.x=Math.floor((a.x-i.dragRange[3])/25),o.endcell.y=Math.floor((a.y-i.dragRange[0])/25),o.endcell.x>=23)o.endcell.x=23;if(o.endcell.y>=6)o.endcell.y=6;return o}function S(e,t){var i=e,a=r(e,"follow-item"),o=O.g(a);if(!o)o=document.createElement("div"),o.className=n(i,"follow-item"),o.id=a,O.g(r(i,"time-body")).appendChild(o);var s,l,u,c,f=t.startcell,d=t.endcell,h=f.x,p=f.y,m=d.x,g=d.y;if(g>=p)s=25*p,u=25*(g-p+1)-2;else s=25*g,u=25*(p-g+1)-2;if(m>=h)l=25*h,c=25*(m-h+1)-2;else l=25*m,c=25*(h-m+1)-2;var v=";display:block;;width:"+c+"px;height:"+u+"px;top:"+s+"px;left:"+l+"px;background:#faffbe";o.style.cssText+=v}function L(e){var t=document;if(O.on(t,"selectstart",P),e.setCapture)e.setCapture();else if(window.captureEvents)window.captureEvents(window.Event.MOUSEMOVE|window.Event.MOUSEUP);if(document.selection)document.selection.empty&&document.selection.empty();else if(window.getSelection)window.getSelection().removeAllRanges()}function D(e){var t=document;if(e.releaseCapture)e.releaseCapture();else if(window.releaseEvents)window.releaseEvents(window.Event.MOUSEMOVE|window.Event.MOUSEUP);O.un(t,"selectstart",P)}function P(e){O.event.preventDefault(e)}function A(e){for(var t=[],i=0,n=e.length;n>i;i++)t.push([].slice.call(e[i],0));return t}function E(e,t,i){for(var n=O.g(r(e,"day-head")),a=n.getElementsByTagName("input"),o=0,s=a.length;s>o;o++)a[o][t]=i}function I(e,t,i){for(var n=A(e.rawValue),r=0,a=i.length;a>r;r++){var o=i[r];if(null!=n[o[0]]&&null!=n[o[0]][o[1]])n[o[0]][o[1]]=t?1:0}e.setRawValue(n)}var O=require("./lib"),N=require("./InputControl"),R=require("./controlHelper");e.defaultProperties={helpSelectedText:"投放时间段",helpText:"暂停时间段",dayTexts:["星期一","星期二","星期三","星期四","星期五","星期六","星期日"],shortcut:t()};var H,Y,j='<div id="${timeId}" class="${timeClass}">${time}</div><div id="${textId}" class="${textClass}">${text}</div>';return e.prototype={constructor:e,type:"Schedule",createMain:function(e){if(!e.tagName)return N.prototype.createMain.call(this);else return document.createElement(e.tagName)},initOptions:function(t){var n={};if(O.extend(n,e.defaultProperties,t),this.setProperties(n),null==this.rawValue)this.setRawValue(i());this.followTip={}},initStructure:function(){var e=this;this.main.tabIndex=0;var t='<input type="hidden" name="${name}" id="${inputId}"/><div class="${bodyClass}" id="${bodyId}"></div><div class="${headClass}"><div class="${helpClass}"><div class="${helpSelectedClass}"></div><div class="${helpTextClass}">${helpSelected}</div><div class="${helpUnselectedClass}"></div><div class="${helpTextClass}">${help}</div></div><div class="${shortcutClass}" id="${shortcutId}">${shortcutHtml}</div></div>';this.main.innerHTML=O.format(t,{name:this.name,inputId:r(e,"value-input"),headClass:n(e,"head"),bodyClass:n(e,"body"),helpClass:n(e,"help"),helpSelectedClass:n(e,"help-selected"),helpUnselectedClass:n(e,"help-unselected"),helpTextClass:n(e,"help-text"),shortcutClass:n(e,"shortcut"),shortcutId:r(e,"shortcut"),bodyId:r(e,"body"),helpSelected:e.helpSelectedText,help:e.helpText,shortcutHtml:a(e)}),o(e)},initEvents:function(){var e=O.g(r(this,"time-body"));this.helper.addDOMEvent(e,"mousedown",C),this.helper.addDOMEvent(e,"mouseover",x),this.helper.addDOMEvent(e,"mouseout",w),this.helper.addDOMEvent(O.g(r(this,"day-head")),"click",g);var t=this.helper.getPart("shortcut");this.helper.addDOMEvent(t,"click",v),this.helper.addDOMEvent(t,"mouseover",O.curry(b,!0)),this.helper.addDOMEvent(t,"mouseout",O.curry(b,!1)),this.helper.addDOMEvent(t,"mousemove",y)},setProperties:function(e){var t=N.prototype.setProperties.call(this,e),i=t.rawValue;if(i&&this.stringifyValue(i.oldValue)!==this.stringifyValue(i.newValue))this.fire("change",{rawValue:this.rawValue})},repaint:R.createRepaint(N.prototype.repaint,{name:"rawValue",paint:function(e,t){var i=e.stringifyValue(t);O.g(r(e,"value-input")).value=null==i?"":i,c(e,t)}},{name:"disabled",paint:function(e,t){E(e,"disabled",t)}},{name:"readonly",paint:function(e,t){E(e,"readonly",t)}}),parseValue:function(e){for(var t=[],i=24,n=0,r=e.length;r>n;n+=i){for(var a=e.substring(n,n+i).split(""),o=[],s=0;s<a.length;s++)o.push(a[s]-0);t.push(o)}return t},stringifyValue:function(e){var t=[];if(!e)return null;for(var i=0,n=e.length;n>i;i++)t.push(e[i].join(""));return t.join("")},setRawValue:function(e){this.setProperties({rawValue:e})},getRawValue:function(){return this.rawValue},select:function(e){I(this,1,[].slice.call(arguments))},unselect:function(e){I(this,0,[].slice.call(arguments))},dispose:function(){R.beforeDispose(this);var e=this.followTip;for(var t in e)if(e[t])document.body.removeChild(e[t]);R.dispose(this),R.afterDispose(this)}},O.inherits(e,N),require("./main").register(e),e}),define("mini-event/Event",["require","./lib"],function(require){function e(){return!0}function t(){return!1}function i(e){return"[object Object]"===Object.prototype.toString.call(e)}function n(e,t){if("object"==typeof e)t=e,e=t.type;if(i(t))r.extend(this,t);else if(t)this.data=t;if(e)this.type=e}var r=require("./lib");n.prototype.isDefaultPrevented=t,n.prototype.preventDefault=function(){this.isDefaultPrevented=e},n.prototype.isPropagationStopped=t,n.prototype.stopPropagation=function(){this.isPropagationStopped=e},n.prototype.isImmediatePropagationStopped=t,n.prototype.stopImmediatePropagation=function(){this.isImmediatePropagationStopped=e,this.stopPropagation()};var a=function(){return this}();n.fromDOMEvent=function(e,t,i){e=e||a.event;var r=new n(t,i);return r.preventDefault=function(){if(e.preventDefault)e.preventDefault();else e.returnValue=!1;n.prototype.preventDefault.call(this)},r.stopPropagation=function(){if(e.stopPropagation)e.stopPropagation();else e.cancelBubble=!0;n.prototype.stopPropagation.call(this)},r.stopImmediatePropagation=function(){if(e.stopImmediatePropagation)e.stopImmediatePropagation();n.prototype.stopImmediatePropagation.call(this)},r};var o={type:!0,target:!0,preventDefault:!0,isDefaultPrevented:!0,stopPropagation:!0,isPropagationStopped:!0,stopImmediatePropagation:!0,isImmediatePropagationStopped:!0};return n.fromEvent=function(e,t){var i={type:e.type,preserveData:!1,syncState:!1};t=r.extend(i,t);var a=new n(t.type);if(t.preserveData)for(var s in e)if(e.hasOwnProperty(s)&&!o.hasOwnProperty(s))a[s]=e[s];if(t.extend)r.extend(a,t.extend);if(t.syncState)a.preventDefault=function(){e.preventDefault(),n.prototype.preventDefault.call(this)},a.stopPropagation=function(){e.stopPropagation(),n.prototype.stopPropagation.call(this)},a.stopImmediatePropagation=function(){e.stopImmediatePropagation(),n.prototype.stopImmediatePropagation.call(this)};return a},n.delegate=function(e,t,i,a,o){var s="string"==typeof t,l={object:e,type:s?t:i},u={object:s?i:t,type:s?a:i},c=s?o:a;if(c=r.extend({preserveData:!1},c),"function"==typeof l.object.on&&"function"==typeof u.object.on&&"function"==typeof u.object.fire){var f=function(e){var t=n.fromEvent(e,c);t.type=u.type,t.target=u.object,u.object.fire(u.type,t)};l.object.on(l.type,f)}},n}),define("mini-event/main",["require","./Event"],function(require){var e=require("./Event");return{version:"1.0.2",Event:e,fromDOMEvent:e.fromDOMEvent,fromEvent:e.fromEvent,delegate:e.delegate}}),define("mini-event",["mini-event/main"],function(e){return e}),define("esui/TextBox",["require","underscore","./lib","./main","./InputControl","mini-event","./painters"],function(require){function e(e){u.apply(this,arguments)}function t(e){var t=e.which||e.keyCode;if(13===t)this.fire("enter");var i={keyCode:t,key:String.fromCharCode(t),ctrlKey:e.ctrlKey,altKey:e.altKey},n=require("mini-event").fromDOMEvent(e,"keypress",i);this.fire("keypress",n)}function i(e,t){var i=s.g(e.inputId);if(!c){var n=e.helper.getPart("placeholder");if("boolean"!=typeof t)t=document.activeElement===i;if(!t&&!e.getRawValue())e.helper.removePartClasses("placeholder-hidden",n);else e.helper.addPartClasses("placeholder-hidden",n)}}function n(e){if(i(this,!0),this.autoSelect){var t=s.g(this.inputId);t.select()}this.fire("focus")}function r(e){i(this,!1),this.fire("blur")}function a(e){if("input"===e.type||"value"===e.propertyName)this.fire("input")}var o=require("underscore"),s=require("./lib"),l=require("./main"),u=require("./InputControl"),c="placeholder"in document.createElement("input");return e.defaultProperties={width:200},e.prototype.type="TextBox",e.prototype.initOptions=function(t){var i={mode:"text",placeholder:"",autoSelect:!1};if(o.extend(i,e.defaultProperties),!i.name)i.name=this.main.getAttribute("name");if(s.isInput(this.main)){var n=this.main.nodeName.toLowerCase();if("textarea"===n)i.mode="textarea";else{var r=this.main.type;i.mode="password"===r?"password":"text"}if(!i.placeholder)i.placeholder=this.main.getAttribute("placeholder");this.helper.extractOptionsFromInput(this.main,i)}if(o.extend(i,t),!i.hasOwnProperty("title")&&this.main.title)i.title=this.main.title;this.setProperties(i)},e.prototype.getFocusTarget=function(){return s.g(this.inputId)},e.prototype.initStructure=function(){if(s.isInput(this.main)){var e=this.helper.replaceMain();if(s.removeAttribute(this.main,"tabindex"),this.inputId=e.id||this.helper.getId("input"),this.main.id)this.main.id=this.helper.getId();var t=e.cloneNode(!1);s.removeAttribute(t,l.getConfig("instanceAttr")),t.id=this.inputId,this.main.appendChild(t)}else{this.inputId=this.helper.getId("input");var i="textarea"===this.mode?'<textarea id="'+this.inputId+'"':'<input type="'+this.mode+'" placeholder="'+this.placeholder+'" id="'+this.inputId+'"';if(this.name)i+=' name="'+o.escape(this.name)+'"';i+="textarea"===this.mode?"></textarea>":" />",this.main.innerHTML=i}if(!c){var t=s.g(this.inputId),n=document.createElement("label");n.id=this.helper.getId("placeholder"),s.setAttribute(n,"for",t.id),this.helper.addPartClasses("placeholder",n),s.insertAfter(n,t)}},e.prototype.initEvents=function(){var e=s.g(this.inputId);this.helper.addDOMEvent(e,"keypress",t),this.helper.addDOMEvent(e,"focus",n),this.helper.addDOMEvent(e,"blur",r);var i="oninput"in e?"input":"propertychange";this.helper.addDOMEvent(e,i,a),this.helper.delegateDOMEvent(e,"change")},e.prototype.repaint=require("./painters").createRepaint(u.prototype.repaint,{name:"rawValue",paint:function(e,t){var n=s.g(e.inputId),r="oninput"in n?"input":"propertychange";e.helper.removeDOMEvent(n,r),n.value=e.stringifyValue(t),e.helper.addDOMEvent(n,r,a),i(e)}},{name:"title",paint:function(e,t){var i=s.g(e.inputId),n=e.helper.getPart("placeholder");if(t){if(s.setAttribute(e.main,"title",t),s.setAttribute(i,"title",t),n)s.setAttribute(n,"title",t)}else if(s.removeAttribute(e.main,"title"),s.removeAttribute(i,"title"),n)s.removeAttribute(n,"title")}},{name:"maxLength",paint:function(e,t){var i=s.g(e.inputId);if(t=parseInt(t,10),!t||0>=t){try{i.maxLength=void 0,delete i.maxLength}catch(n){}s.removeAttribute(i,"maxlength"),s.removeAttribute(i,"maxLength")}else i.maxLength=t,s.setAttribute(i,"maxlength",t)}},{name:["disabled","readOnly"],paint:function(e,t,i){var n=s.g(e.inputId);n.disabled=t,n.readOnly=i}},{name:"placeholder",paint:function(e,t){var n=s.g(e.inputId);if(c)if(t)s.setAttribute(n,"placeholder",t);else s.removeAttribute(n,"placeholder");else{var r=e.helper.getPart("placeholder");r.innerHTML=o.escape(t||"")}i(e)}},{name:["hint","hintType"],paint:function(e,t,i){var n=e.helper.getPart("hint");if(e.removeState("hint-prefix"),e.removeState("hint-suffix"),!t&&n)s.removeNode(n);if(t){if(!n)n=document.createElement("label"),n.id=e.helper.getId("hint"),e.helper.addPartClasses("hint",n),s.setAttribute(n,"for",e.inputId);n.innerHTML=o.escape(t),i="prefix"===i?"prefix":"suffix";var r="prefix"===i?"insertBefore":"insertAfter",a=s.g(e.inputId);s[r](n,a),e.addState("hint-"+i)}}},{name:["width","hint","hidden"],paint:function(e,t,i,n){if(!n&&!isNaN(t)){if(i){var r=e.helper.getPart("hint");if(r)t-=r.offsetWidth}var a=s.g(e.inputId);a.style.width=t+"px";var o=e.helper.getPart("placeholder");if(o)o.style.maxWidth=t+"px"}}},{name:"height",paint:function(e,t){if(!isNaN(t)){var i=e.helper.getPart("hint"),n=t+"px";if(i)i.style.height=n,i.style.lineHeight=n;var r=s.g(e.inputId);r.style.height=n;var a=e.helper.getPart("placeholder");if(a)a.style.height=n,a.style.lineHeight=n}}}),e.prototype.getValidityLabel=function(){var e=u.prototype.getValidityLabel.apply(this,arguments);if(e)e.set("targetType","textarea"===this.mode?"TextArea":"TextBox");return e},e.prototype.getRawValue=function(){var e=s.g(this.inputId);return e?e.value:this.rawValue||this.value||""},e.prototype.getRawValueProperty=e.prototype.getRawValue,s.inherits(e,u),l.register(e),e}),define("esui/RichCalendar",["require","./Button","./MonthView","./TextBox","./lib","./controlHelper","./InputControl","./Layer","./main","moment","underscore"],function(require){function e(){b.apply(this,arguments)}function t(e){for(var t=e.displayNum,n='<div id="${id}" class="${className}">${monthView}</div>',r=[],a=0;t>a;a++)r.push(g.format(n,{id:e.helper.getId("month-"+a),className:e.helper.getPartClassName("month-container"),monthView:i(e,a)}));return g.format('<div id="${id}" class="${className}">${monthViews}</div>',{id:e.helper.getId("months"),className:e.helper.getPartClassName("months"),monthViews:r.join("")})}function i(e,t){var i='<div data-ui-type="MonthView" data-ui-child-name="${calName}" data-ui-mode="multi"></div>';return g.format(i,{calName:"monthView"+t})}function n(t){y.apply(this,arguments),this.layer=new e(this)}function r(e,t){for(var i=this.getRawValue(),n=e.displayNum,r=0;n>r;r++)if(r!==t){var a=e.getChild("monthView"+r);a.setRawValueWithoutFireChange(i)}e.rawValue=i,l(e,i)}function a(e,t){for(var i=e.displayNum,n=new Date(this.year,this.month,1),r=0;i>r;r++)if(r!==t){var o=e.getChild("monthView"+r);o.un("changemonth"),o.un("changeyear");var s,l=t-r;if(l>0)s=w(n).subtract("month",l);else s=w(n).add("month",-l);o.setProperties({month:s.month()+1,year:s.year()}),o.on("changeyear",g.curry(a,e,r)),o.on("changemonth",g.curry(a,e,r))}}function o(e,t){for(var i=e.displayNum,n=e.startMonth,r=e.startYear,a=0;i>a;a++){var o,l,u,c=e.range.begin,f=e.range.end,d=c.getFullYear(),h=c.getMonth(),p=f.getFullYear(),m=f.getMonth();if(0===a)l=new Date(p,m-i+2,0),o={begin:e.range.begin,end:l};else if(a===i-1)u=new Date(d,h+i-1,1),o={begin:u,end:e.range.end};else u=new Date(d,h+a,1),l=new Date(p,m-i-a+2,0),o={begin:u,end:l};var g={year:r,month:n+a,rawValue:e.rawValue,range:e.range,viewRange:o};s(e,g,a,t)}}function s(e,t,i,n){var o=e.getChild("monthView"+i);if(o.setProperties(t),n===!0)o.on("change",g.curry(r,e,i)),o.on("changeyear",g.curry(a,e,i)),o.on("changemonth",g.curry(a,e,i))}function l(e,t){var i=v.getId(e,"param-value");g.g(i).value=e.stringifyValue(t);var n=e.getChild("textInput"),r=h(e,t);n.setProperties({rawValue:r}),u(e,t),e.fire("change")}function u(e,t){var i=g.g(v.getId(e,"total-num"));i.innerHTML=t.length}function c(e){e.set("rawValue",[])}function f(e){var t=e.split(",");if(1===t.length)t.push("2046-11-04");else if(""===t[0])t[0]="1983-09-03";else if(""===t[1])t[1]="2046-11-04";return{begin:d(t[0]),end:d(t[1])}}function d(e){function t(e){var t=e.split("-");if(t)return new Date(parseInt(t[0],10),parseInt(t[1],10)-1,parseInt(t[2],10));else return null}if(!e)return null;e+="";var i=e.split(" "),n=t(i[0]);if(i[1]){var r=i[1].split(":");n.setHours(r[0]),n.setMinutes(r[1]),n.setSeconds(r[2])}return n}function h(e,t){for(var i=[],n=[],r=0,a=864e5,o=0;o<t.length;o++)if(0===o)i.push(g.date.format(t[o],e.paramFormat)),n.push(t[o]),r++;else if(t[o]-t[o-1]>a){if(t[o-1]-n[r-1]!==0)i.push("至"),i.push(g.date.format(t[o-1],e.paramFormat)),n.push(t[o-1]),r++;i.push("\n"),i.push(g.date.format(t[o],e.paramFormat)),n.push(t[o]),r++}else if(o===t.length-1)i.push("至"),i.push(g.date.format(t[o],e.paramFormat));else continue;return i.join("")}function p(e){for(var t=this.getValue(),i=t.replace(/\n{2,}/g,"\n").split("\n"),n=[],r={},a=!1,o=0,s=i.length;s>o;o++){var l=g.trim(i[o]);if(0!==l.length&&!r[l]){r[l]=1;var u=l.split("至"),c=u[0],f=c;if(u.length>1)f=u[1];if(m(c)&&m(f))n.push(c),n.push(f);else a=!0}else;}var d=n.join(",");e.rawValue=e.parseValue(d),this.setProperties({rawValue:h(e,e.rawValue)}),e.fire("change")}function m(e){var t=/^(\d{4})(-)(\d{2})\2(\d{2})$/,i=e.match(t);if(null==i)return!1;var n=new Date(i[1],i[3]-1,i[4]),r=""+n.getFullYear()+i[2]+(n.getMonth()+1)+i[2]+n.getDate();return e=i[1]+i[2]+(i[3]-1+1)+i[2]+(i[4]-1+1),r===e}require("./Button"),require("./MonthView"),require("./TextBox");var g=require("./lib"),v=require("./controlHelper"),y=require("./InputControl"),b=require("./Layer"),x=require("./main"),w=require("moment"),C=require("underscore");return g.inherits(e,b),e.prototype.render=function(e){document.body.appendChild(e);var i=this.control;e.innerHTML=t(i),i.helper.initChildren(e),o(i,!0)},e.prototype.toggle=function(){var e=this.getElement();if(!e||this.control.helper.isPart(e,"layer-hidden"))o(this.control,!0),this.show();else this.hide()},n.prototype={type:"RichCalendar",initOptions:function(e){var t=new Date,i={now:t,range:{begin:new Date(1983,8,3),end:new Date(2046,10,4)},paramFormat:"YYYY-MM-DD",rawValue:[],displayNum:2,startYear:t.getFullYear(),startMonth:t.getMonth()+1};if(v.extractValueFromInput(this,e),g.extend(i,e),e.range&&"string"==typeof e.range)i.range=f(i.range);this.setProperties(i)},setProperties:function(e){if(null==e.rawValue||0===e.rawValue.length)if(e.value)e.rawValue=this.parseValue(e.value);if(e.rawValue&&e.rawValue.length){var t=e.rawValue[0];e.startYear=t.getFullYear(),e.startMonth=t.getMonth()+1}var i=y.prototype.setProperties.apply(this,arguments);return i},initStructure:function(){if(g.isInput(this.main))v.replaceMain(this);var e=['<div class="${className}" id="${id}">','<textarea data-ui-type="TextBox"',' data-ui-mode="textarea"',' data-ui-width="${textBoxWidth}"',' data-ui-height="${textBoxHeight}"',' data-ui-child-name="textInput"></textarea>','<div data-ui-type="Panel" class="${generalPanelClass}"',' data-ui-child-name="generalPanel">','共<span id="${totalNumId}" ','class="${totalNumClass}"></span>天,','<span data-ui-type="Button" data-ui-skin="link"',' data-ui-child-name="deleteBtn">全部删除</span>',"</div>",'<div data-ui-type="Button" data-ui-skin="calendar"',' data-ui-child-name="modifyBtn">修改时间</div>',"</div>",'<input type="hidden" id="${inputId}" name="${name}"',' value="" />'],t=v.getPartClasses;this.main.innerHTML=g.format(e.join("\n"),{className:t(this,"text").join(" "),id:v.getId(this,"text"),textBoxWidth:this.textBoxWidth||200,textBoxHeight:this.textBoxHeight||100,name:this.name,inputId:v.getId(this,"param-value"),generalPanelClass:t(this,"general-info").join(" "),totalNumId:v.getId(this,"total-num"),totalNumClass:t(this,"total-num").join(" ")}),this.initChildren(this.main)},initEvents:function(){var e=this.getChild("modifyBtn");e.on("click",C.bind(this.layer.toggle,this.layer));var t=this.getChild("generalPanel").getChild("deleteBtn");t.on("click",g.curry(c,this));var i=this.getChild("textInput");i.on("blur",g.curry(p,this))},repaint:v.createRepaint(y.prototype.repaint,{name:["rawValue","range"],paint:function(e,t,i){if(i){if("string"==typeof i)i=f(i);if(!i.begin)i.begin=new Date(1983,8,3);else if(!i.end)i.end=new Date(2046,10,4);e.range=i}if(t)l(e,t);if(e.helper.getPart("months"))o(e)}},{name:["disabled","hidden","readOnly"],paint:function(e,t,i,n){if(t||i||n)e.layer.hide()}}),setRawValue:function(e){this.setProperties({rawValue:e})},getRawValue:function(){return this.rawValue},stringifyValue:function(e){for(var t=[],i=864e5,n=0;n<e.length;n++){if(0===n)t.push(g.date.format(e[n],this.paramFormat));else if(e[n]-e[n-1]>i)t.push(g.date.format(e[n-1],this.paramFormat)),t.push(g.date.format(e[n],this.paramFormat));if(n===e.length-1)t.push(g.date.format(e[n],this.paramFormat))}return t.join(",")},getRanges:function(){for(var e=this.rawValue,t=this.stringifyValue(e).split(","),i=[],n=0;n<t.length-1;n+=2){var r=d(t[n]),a=d(t[n+1]);i.push({begin:r,end:a})}return i},setRanges:function(e){for(var t={},i=0;i<e.length;i++){var n,r=e[i].begin,a=e[i].end;if(r&&a)if(r-a===0)t[r]=r;else for(n=r;a>=n;)t[n]=n,n=new Date(n.getFullYear(),n.getMonth(),n.getDate()+1);else;}var o=[];for(var s in t)o.push(t[s]);o.sort(function(e,t){return e-t}),this.set("rawValue",o)},parseValue:function(e){for(var t=e.split(","),i={},n=0;n<t.length-1;n+=2){var r,a=d(t[n]),o=d(t[n+1]);if(a&&o)if(a-o===0)i[a]=a;else for(r=a;o>=r;)i[r]=r,r=new Date(r.getFullYear(),r.getMonth(),r.getDate()+1);else;}var s=[];for(var l in i)s.push(i[l]);return s.sort(function(e,t){return e-t}),s},dispose:function(){if(!v.isInStage(this,"DISPOSED")){if(this.layer)this.layer.dispose(),this.layer=null;y.prototype.dispose.apply(this,arguments)}},toggleCanlendarLayer:function(){this.layer.toggle()}},g.inherits(n,y),x.register(n),n}),define("esui/Region",["require","./Select","./lib","./controlHelper","./InputControl","./main","underscore"],function(require){function e(e){_.apply(this,arguments)}function t(e){for(var t=e.regionData,i=t.length,n=[],r=0;i>r;r++)n.push(l(e,t[r],1));var a='<input type="hidden" id="${inputId}" name="${name}" />';n.push(C.format(a,{inputId:k.getId(e,"param-value"),name:e.name})),e.main.innerHTML=n.join("")}function i(e,t,n){t.call(n,e),M.each(e.children,function(e){i(e,t,n)})}function n(e,t){var n=e.regionDataIndex,o=[];M.each(t,function(e){var t=n[e];if(t)i(t,function(e){o.push(e.id)})});var s={};M.each(o,function(e){s[e]=1}),M.each(e.regionDataIndex,function(t,i){var n=s.hasOwnProperty(i),a=r(e,i);if(a)a.checked=n;else t.isSelected=n}),a(e),x(e)}function r(e,t){return C.g(k.getId(e,"item-"+t))}function a(e,t,i,n){var n=n||0;t=t||{children:e.regionData};var o=e.regionDataIndex[t.id];if(!i)e.rawValue=[];var l,u=0,c=t.id&&r(e,t.id),f=t.children,d=f instanceof Array&&f.length;if(d){for(var h=!0,p=0;d>p;p++){if(l=a(e,f[p],1,n+1))u++;h=h&&l}if(c)c.checked=h,h&&e.rawValue.push(t.id),
o.isSelected=h;if(3===n)if(!h)s(e,u,d,t.id);else s(e,1,1,t.id);return h}else{if(c){if(c.checked)e.rawValue.push(t.id);return c.checked}else if(o.isSelected)e.rawValue.push(t.id);return o.isSelected}}function o(){return T.getConfig("stateClassPrefix")+"-hidden"}function s(e,t,i,n){var r=C.g(k.getId(e,"info-"+n));if(0!==t&&t!==i)C.removeClass(r,o()),r.innerHTML=t+"/"+i;else C.addClass(r,o()),r.innerHTML=""}function l(e,t,i){t.level=i;var n=[],r=t.children;if(null!=r)if(t.isSelected=!1,3===t.level){if(t.children&&t.children.length>0)e.cityCache[t.id]=u(e,t)}else for(var a=r instanceof Array&&r.length,s=0;a>s;s++)n.push(l(e,t.children[s],i+1));switch(i){case 1:return C.format(L,{boxClass:k.getPartClasses(e,"country-box").join(" "),itemClasses:k.getPartClasses(e,"country-check").join(" "),itemWrapperId:"",itemValue:t.id,itemId:k.getId(e,"item-"+t.id),level:t.level,text:t.text,contentClass:"",content:n.join("")});case 2:return C.format(L,{boxClass:k.getPartClasses(e,"region-box"+A++%2).join(" "),itemClasses:k.getPartClasses(e,"region-check").join(" "),itemWrapperId:"",itemValue:t.id,itemId:k.getId(e,"item-"+t.id),level:t.level,text:t.text,contentClass:k.getPartClasses(e,"province-box").join(" "),content:n.join("")});case 3:var c=C.format(D,{popLayerClass:k.getPartClasses(e,"locator").join(" "),layerBoxClass:k.getPartClasses(e,"city-box").join(" "),hiddenClass:o(),id:k.getId(e,"sub-"+t.id),infoId:k.getId(e,"info-"+t.id),innerHTML:n.join("")}),f=C.format(S,{itemClasses:k.getPartClasses(e,"text").join(" "),itemWrapperId:k.getId(e,"wrapper-"+t.id),itemValue:t.id,itemId:k.getId(e,"item-"+t.id),level:t.level,text:t.text});return C.format(P,{classes:k.getPartClasses(e,"province-item").join(" "),content:c+f});case 4:return C.format(S,{itemClasses:k.getPartClasses(e,"city").join(" "),itemWrapperId:"",itemValue:t.id,itemId:k.getId(e,"item-"+t.id),level:t.level,text:t.text})}}function u(e,t){if(3===t.level&&null!=t.children){for(var i=[],n=0,r=0,a=0;a<t.children.length;a++){if(t.children[a].parent=t,t.children[a].level=t.level+1,i.push(l(e,t.children[a],t.level+1)),a%2===0&&t.children[a].text.length>n)n=t.children[a].text.length;if(a%2===1&&t.children[a].text.length>r)r=t.children[a].text.length}if(i.length%2===1)i.push("");for(var o=['<table border="0" cellspacing="0" cellpadding="0"',' width="',14*(n+r)+66,'">'].join(""),s=["<tr>",'<td width="',14*n+33,'">${firstItem}',"</td>",'<td width="',14*r+33,'">${secondItem}',"</td>","</tr>"].join(""),u=0;u<i.length;u+=2)o+=C.format(s,{firstItem:i[u],secondItem:i[u+1]});return o+"</table>"}return""}function c(e,t){function i(e,n){var r,a,o=e instanceof Array&&e.length;if(o)for(var r=0;o>r;r++){var a=C.clone(e[r]);a.parent=n,t.regionDataIndex[a.id]=a,i(a.children,a)}}var n=t.regionData;t.regionDataIndex={},i(n,{children:n})}function f(e){if(!this.disabled&&!this.readOnly)for(var t=e.target;t&&t!==document.body;){var i=!1;if("input"===t.nodeName.toLowerCase())i=!0;else if("label"===t.nodeName.toLowerCase()){var n=C.getAttribute(t,"for");t=C.g(n),i=!0}if(i)return d(this,t),void this.fire("change");t=t.parentNode}}function d(e,t,i){var n=C.getAttribute(t,"data-optionId"),o=t.checked,l=e.regionDataIndex[n];l.isSelected=o;var u=l.children,c=u instanceof Array&&u.length;if(c)M.each(u,function(t){var i=r(e,t.id);if(i)i.checked=o,d(e,i,1);else e.regionDataIndex[t.id].isSelected=o});else if(0===c)if(3===C.getAttribute(t,"level")){var f=0,h=e.regionDataIndex[n].parent.children;M.each(h,function(e){if(r(e.id).checked===!0)f++}),s(e,f,h.length,e.regionDataIndex[n].parent.id)}if(!i)a(e),x(e)}function h(e,t){if(!this.disabled&&!this.readOnly){var i=t.target,n=k.getPartClasses(this,"text"),r=k.getPartClasses(this,"city-box"),a=p;if("hide"===e)a=m;for(var o;i&&i!==document.body;){var s;if(C.hasClass(i,n[0]))o=C.getAttribute(i.firstChild,"value"),s=i.previousSibling.firstChild;else if(C.hasClass(i,r[0]))s=i;if(s)return void a(this,s,o);i=i.parentNode}}}function p(e,t,i){if(i){var r=e.cityCache[i];if(!r)return;t.innerHTML=r,n(e,e.rawValue)}C.removeClass(t,o());var a=t.parentNode.nextSibling;k.addPartClasses(e,"text-over",a)}function m(e,t,i){C.addClass(t,o());var n=t.parentNode.nextSibling;k.removePartClasses(e,"text-over",n)}function g(e,t){function i(e){var t=e.children,r=!!t;if(e.id)n.push({text:e.text,value:e.id,disabled:r});if(r)for(var a=t.length,o=0,a=t.length;a>o;o++)i(t[o])}var n=[];i({children:t.regionData}),t.singleRegionData=n}function v(e){var t='<div data-ui="type:Select;childName:regionSel;id:regionSel;width:100;"></div><input type="hidden" id="${inputId}" name="${name}" />';e.main.innerHTML=C.format(t,{inputId:k.getId(e,"param-value"),name:e.name}),e.initChildren(e.main);var i=e.getChild("regionSel");i.setProperties({datasource:e.singleRegionData}),i.on("change",C.bind(y,null,e,i))}function y(e,t){var i=parseInt(t.getValue(),10);e.rawValue=i,x(e)}function b(e,t){if("multi"===e.mode)for(var i=e.main.getElementsByTagName("input"),n=0,r=i.length;r>n;n++){var a=i[n];a.disabled=t}else{var o=e.getChild("regionSel");o.setProperties({disabled:t})}}function x(e){var t=C.g(k.getId(e,"param-value")),i=e.rawValue;if(C.isArray(i))t.value=i.join(",");else t.value=i}function w(e,t){var i=e.regionDataIndex,n=[];if(i[t.id]&&i[t.id].isSelected)n.push(t.id);else M.each(t.children,function(t){var r=i[t.id];n.push.apply(n,w(e,r))});return n}require("./Select");var C=require("./lib"),k=require("./controlHelper"),_=require("./InputControl"),T=require("./main"),M=require("underscore"),S=['<div class="${itemClasses}" id="${itemWrapperId}" >','<input type="checkbox" value="${itemValue}" id="${itemId}"',' data-optionId="${itemValue}" data-level="${level}">','<label for="${itemId}">${text}</label>',"</div>"].join(""),L=['<div class="${boxClass}">',S,'<div class="${contentClass}">${content}</div>',"</div>"].join(""),D=['<div class="${popLayerClass}">','<div class="${hiddenClass} ${layerBoxClass}" id="${id}">',"${innerHTML}</div>",'<b class="${hiddenClass}" id="${infoId}"></b>',"</div>"].join(""),P='<div class="${classes}">${content}</div>',A=0;return e.prototype={type:"Region",initOptions:function(t){var i={regionData:C.clone(e.REGION_LIST),mode:"multi",pureSelect:!1,rawValue:[]};if(k.extractValueFromInput(this,t),C.extend(i,t),t.value)i.rawValue=i.value.split(",");if("false"===t.pureSelect)i.pureSelect=!1;if("multi"===i.mode)c(this,i),this.cityCache={};else i.rawValue="",g(this,i);this.setProperties(i)},initStructure:function(){if(C.isInput(this.main))k.replaceMain(this);if("multi"===this.mode)t(this);else v(this),C.addClass(this.main,k.getPartClasses(this,"single").join(" "))},initEvents:function(){if("multi"===this.mode)this.helper.addDOMEvent(this.main,"click",f),this.helper.addDOMEvent(this.main,"mouseover",C.curry(h,"show")),this.helper.addDOMEvent(this.main,"mouseout",C.curry(h,"hide"));else{var e=this.getChild("regionSel");e.on("change",C.bind(y,null,this,e))}},repaint:k.createRepaint(_.prototype.repaint,{name:"rawValue",paint:function(e,t){if("multi"===e.mode)n(e,t);else{var i=e.getChild("regionSel");i.setProperties({value:t})}}},{name:["disabled","readOnly"],paint:function(e,t,i){var n=!0;if(t||i)n=!1;if(b(e,!n),!t&&i){var r=C.g(k.getId(e,"param-value"));r.disabled=!1}}}),setRawValue:function(e){this.setProperties({rawValue:e})},getRawValue:function(){if("single"===this.mode)return this.getChild("regionSel").getValue();if(this.pureSelect){var e={id:"-100",children:this.regionData},t=w(this,e);return t}return this.rawValue},stringifyValue:function(e){if("multi"===this.mode)return e.join(",");else return e},parseValue:function(e){return e.split(",")},checkRegion:function(e){var t=r(this,e);if(t)t.checked=!0,d(this,t);else{var i=this.regionDataIndex[e];if(i)i.isSelected=!0,a(this),x(this)}}},e.REGION_LIST=[{id:"90",text:"中国",children:[{id:"80",text:"华北地区",children:[{id:"1",text:"北京",children:[{id:"742",text:"昌平区"},{id:"743",text:"朝阳区"},{id:"744",text:"崇文区"},{id:"745",text:"大兴区"},{id:"746",text:"东城区"},{id:"747",text:"房山区"},{id:"748",text:"丰台区"},{id:"749",text:"海淀区"},{id:"750",text:"怀柔区"},{id:"751",text:"门头沟区"},{id:"752",text:"密云县"},{id:"753",text:"平谷区"},{id:"754",text:"石景山区"},{id:"755",text:"顺义区"},{id:"756",text:"通州区"},{id:"757",text:"西城区"},{id:"758",text:"宣武区"},{id:"759",text:"延庆县"}]},{id:"3",text:"天津",children:[{id:"760",text:"宝坻区"},{id:"761",text:"北辰区"},{id:"763",text:"东丽区"},{id:"765",text:"河北区"},{id:"766",text:"河东区"},{id:"767",text:"和平区"},{id:"768",text:"河西区"},{id:"769",text:"红桥区"},{id:"770",text:"蓟县"},{id:"771",text:"津南区"},{id:"772",text:"静海县"},{id:"773",text:"南开区"},{id:"774",text:"宁河县"},{id:"776",text:"武清区"},{id:"777",text:"西青区"},{id:"900",text:"滨海新区"}]},{id:"15",text:"河北",children:[{id:"226",text:"保定市"},{id:"228",text:"沧州市"},{id:"229",text:"承德市"},{id:"230",text:"邯郸市"},{id:"231",text:"衡水市"},{id:"234",text:"廊坊市"},{id:"236",text:"秦皇岛市"},{id:"239",text:"石家庄市"},{id:"240",text:"唐山市"},{id:"241",text:"邢台市"},{id:"242",text:"张家口市"}]},{id:"24",text:"内蒙古",children:[{id:"428",text:"阿拉善盟"},{id:"429",text:"巴彦淖尔市"},{id:"430",text:"包头市"},{id:"431",text:"赤峰市"},{id:"432",text:"鄂尔多斯市"},{id:"434",text:"呼和浩特市"},{id:"435",text:"呼伦贝尔市"},{id:"437",text:"通辽市"},{id:"438",text:"乌海市"},{id:"439",text:"乌兰察布市"},{id:"442",text:"锡林郭勒盟"},{id:"444",text:"兴安盟"}]},{id:"28",text:"山西",children:[{id:"486",text:"大同市"},{id:"491",text:"晋城市"},{id:"492",text:"晋中市"},{id:"493",text:"临汾市"},{id:"494",text:"吕梁市"},{id:"495",text:"朔州市"},{id:"496",text:"太原市"},{id:"497",text:"忻州市"},{id:"498",text:"阳泉市"},{id:"501",text:"运城市"},{id:"502",text:"长治市"}]}]},{id:"81",text:"东北地区",children:[{id:"17",text:"黑龙江",children:[{id:"272",text:"大庆市"},{id:"273",text:"大兴安岭地区"},{id:"276",text:"哈尔滨市"},{id:"278",text:"鹤岗市"},{id:"279",text:"黑河市"},{id:"282",text:"鸡西市"},{id:"284",text:"佳木斯市"},{id:"287",text:"牡丹江市"},{id:"289",text:"七台河市"},{id:"290",text:"齐齐哈尔市"},{id:"291",text:"双鸭山市"},{id:"293",text:"绥化市"},{id:"298",text:"伊春市"}]},{id:"20",text:"吉林",children:[{id:"345",text:"白城市"},{id:"346",text:"白山市"},{id:"351",text:"吉林市"},{id:"352",text:"辽源市"},{id:"355",text:"四平市"},{id:"356",text:"松原市"},{id:"358",text:"通化市"},{id:"359",text:"延边朝鲜族自治州"},{id:"361",text:"长春市"}]},{id:"23",text:"辽宁",children:[{id:"413",text:"鞍山市"},{id:"414",text:"本溪市"},{id:"415",text:"朝阳市"},{id:"416",text:"大连市"},{id:"417",text:"丹东市"},{id:"418",text:"抚顺市"},{id:"419",text:"阜新市"},{id:"421",text:"葫芦岛市"},{id:"422",text:"锦州市"},{id:"423",text:"辽阳市"},{id:"424",text:"盘锦市"},{id:"425",text:"沈阳市"},{id:"426",text:"铁岭市"},{id:"427",text:"营口市"}]}]},{id:"82",text:"华东地区",children:[{id:"2",text:"上海",children:[{id:"818",text:"宝山区"},{id:"819",text:"崇明县"},{id:"820",text:"奉贤区"},{id:"821",text:"虹口区"},{id:"822",text:"黄浦区"},{id:"823",text:"嘉定区"},{id:"824",text:"金山区"},{id:"825",text:"静安区"},{id:"826",text:"卢湾区"},{id:"827",text:"闵行区"},{id:"830",text:"浦东新区"},{id:"831",text:"普陀区"},{id:"832",text:"青浦区"},{id:"833",text:"松江区"},{id:"834",text:"徐汇区"},{id:"835",text:"杨浦区"},{id:"836",text:"闸北区"},{id:"837",text:"长宁区"}]},{id:"8",text:"安徽",children:[{id:"101",text:"安庆市"},{id:"102",text:"蚌埠市"},{id:"103",text:"亳州市"},{id:"104",text:"巢湖市"},{id:"105",text:"池州市"},{id:"106",text:"滁州市"},{id:"107",text:"阜阳市"},{id:"110",text:"合肥市"},{id:"111",text:"淮北市"},{id:"112",text:"淮南市"},{id:"113",text:"黄山市"},{id:"115",text:"六安市"},{id:"116",text:"马鞍山市"},{id:"118",text:"铜陵市"},{id:"119",text:"芜湖市"},{id:"120",text:"宿州市"},{id:"121",text:"宣城市"}]},{id:"9",text:"福建",children:[{id:"124",text:"福州市"},{id:"126",text:"龙岩市"},{id:"127",text:"南平市"},{id:"128",text:"宁德市"},{id:"129",text:"莆田市"},{id:"130",text:"泉州市"},{id:"131",text:"三明市"},{id:"132",text:"厦门市"},{id:"138",text:"漳州市"}]},{id:"21",text:"江苏",children:[{id:"363",text:"常州市"},{id:"367",text:"淮安市"},{id:"375",text:"连云港市"},{id:"376",text:"南京市"},{id:"377",text:"南通市"},{id:"381",text:"苏州市"},{id:"383",text:"泰州市"},{id:"386",text:"无锡市"},{id:"391",text:"宿迁市"},{id:"392",text:"徐州市"},{id:"393",text:"盐城市"},{id:"395",text:"扬州市"},{id:"399",text:"镇江市"}]},{id:"22",text:"江西",children:[{id:"401",text:"抚州市"},{id:"402",text:"赣州市"},{id:"403",text:"吉安市"},{id:"404",text:"景德镇市"},{id:"406",text:"九江市"},{id:"407",text:"南昌市"},{id:"408",text:"萍乡市"},{id:"409",text:"上饶市"},{id:"410",text:"新余市"},{id:"411",text:"宜春市"},{id:"412",text:"鹰潭市"}]},{id:"27",text:"山东",children:[{id:"461",text:"滨州市"},{id:"462",text:"德州市"},{id:"463",text:"东营市"},{id:"466",text:"菏泽市"},{id:"467",text:"济南市"},{id:"468",text:"济宁市"},{id:"470",text:"莱芜市"},{id:"472",text:"聊城市"},{id:"473",text:"临沂市"},{id:"474",text:"青岛市"},{id:"476",text:"日照市"},{id:"477",text:"泰安市"},{id:"479",text:"威海市"},{id:"480",text:"潍坊市"},{id:"481",text:"烟台市"},{id:"482",text:"枣庄市"},{id:"485",text:"淄博市"}]},{id:"34",text:"浙江",children:[{id:"604",text:"杭州市"},{id:"605",text:"湖州市"},{id:"606",text:"嘉兴市"},{id:"608",text:"金华市"},{id:"611",text:"丽水市"},{id:"615",text:"宁波市"},{id:"617",text:"衢州市"},{id:"619",text:"绍兴市"},{id:"621",text:"台州市"},{id:"624",text:"温州市"},{id:"630",text:"舟山市"}]}]},{id:"83",text:"华中地区",children:[{id:"16",text:"河南",children:[{id:"243",text:"安阳市"},{id:"246",text:"鹤壁市"},{id:"249",text:"焦作市"},{id:"250",text:"开封市"},{id:"252",text:"漯河市"},{id:"253",text:"洛阳市"},{id:"254",text:"南阳市"},{id:"255",text:"平顶山市"},{id:"256",text:"濮阳市"},{id:"257",text:"三门峡市"},{id:"258",text:"商丘市"},{id:"261",text:"新乡市"},{id:"262",text:"信阳市"},{id:"263",text:"许昌市"},{id:"266",text:"郑州市"},{id:"267",text:"周口市"},{id:"268",text:"驻马店市"},{id:"901",text:"济源市"}]},{id:"18",text:"湖北",children:[{id:"304",text:"鄂州市"},{id:"305",text:"恩施市"},{id:"307",text:"黄冈市"},{id:"308",text:"黄石市"},{id:"309",text:"荆门市"},{id:"310",text:"荆州市"},{id:"311",text:"潜江市"},{id:"312",text:"神农架林区"},{id:"313",text:"十堰市"},{id:"314",text:"随州市"},{id:"315",text:"天门市"},{id:"317",text:"武汉"},{id:"319",text:"仙桃市"},{id:"320",text:"咸宁市"},{id:"321",text:"襄樊市"},{id:"323",text:"孝感市"},{id:"324",text:"宜昌市"}]},{id:"19",text:"湖南",children:[{id:"328",text:"常德市"},{id:"329",text:"郴州市"},{id:"330",text:"衡阳市"},{id:"331",text:"怀化市"},{id:"334",text:"娄底市"},{id:"335",text:"邵阳市"},{id:"337",text:"湘潭市"},{id:"338",text:"湘西土家族苗族自治州"},{id:"339",text:"益阳市"},{id:"340",text:"永州市"},{id:"341",text:"岳阳市"},{id:"342",text:"张家界市"},{id:"343",text:"长沙市"},{id:"344",text:"株洲市"}]}]},{id:"84",text:"华南地区",children:[{id:"11",text:"广东",children:[{id:"157",text:"潮州市"},{id:"158",text:"东莞市"},{id:"160",text:"佛山市"},{id:"162",text:"广州市"},{id:"163",text:"河源市"},{id:"164",text:"惠州市"},{id:"166",text:"江门市"},{id:"167",text:"揭阳市"},{id:"169",text:"茂名市"},{id:"170",text:"梅州市"},{id:"172",text:"清远市"},{id:"173",text:"汕头市"},{id:"174",text:"汕尾市"},{id:"175",text:"韶关市"},{id:"176",text:"深圳市"},{id:"180",text:"阳江市"},{id:"182",text:"云浮市"},{id:"184",text:"湛江市"},{id:"185",text:"肇庆市"},{id:"186",text:"中山市"},{id:"187",text:"珠海市"}]},{id:"12",text:"广西",children:[{id:"188",text:"百色市"},{id:"189",text:"北海市"},{id:"191",text:"防城港市"},{id:"193",text:"贵港市"},{id:"194",text:"桂林市"},{id:"195",text:"河池市"},{id:"196",text:"贺州市"},{id:"197",text:"来宾市"},{id:"198",text:"柳州市"},{id:"199",text:"南宁市"},{id:"200",text:"钦州市"},{id:"201",text:"梧州市"},{id:"203",text:"玉林市"}]},{id:"14",text:"海南",children:[{id:"218",text:"儋州市"},{id:"219",text:"东方市"},{id:"220",text:"海口市"},{id:"221",text:"琼海市"},{id:"223",text:"三亚市"},{id:"225",text:"文昌市"},{id:"867",text:"五指山"},{id:"868",text:"万宁"}]}]},{id:"85",text:"西南地区",children:[{id:"4",text:"重庆",children:[{id:"778",text:"巴南区"},{id:"779",text:"北碚区"},{id:"780",text:"璧山县"},{id:"781",text:"城口县"},{id:"782",text:"大渡口区"},{id:"783",text:"大足县"},{id:"784",text:"垫江县"},{id:"785",text:"丰都县"},{id:"786",text:"奉节县"},{id:"787",text:"涪陵区"},{id:"788",text:"合川区"},{id:"789",text:"江北区"},{id:"790",text:"江津区"},{id:"791",text:"九龙坡区"},{id:"792",text:"开县"},{id:"793",text:"梁平县"},{id:"794",text:"南岸区"},{id:"795",text:"南川区"},{id:"796",text:"彭水县"},{id:"797",text:"綦江县"},{id:"798",text:"黔江区"},{id:"799",text:"荣昌县"},{id:"800",text:"沙坪坝区"},{id:"801",text:"石柱县"},{id:"802",text:"双桥区"},{id:"803",text:"铜梁县"},{id:"804",text:"潼南县"},{id:"805",text:"万盛区"},{id:"806",text:"万州区"},{id:"807",text:"巫山县"},{id:"808",text:"巫溪县"},{id:"809",text:"武隆县"},{id:"810",text:"秀山县"},{id:"811",text:"永川区"},{id:"812",text:"酉阳县"},{id:"813",text:"渝北区"},{id:"814",text:"渝中区"},{id:"815",text:"云阳县"},{id:"816",text:"长寿区"},{id:"817",text:"忠县"}]},{id:"13",text:"贵州",children:[{id:"204",text:"安顺市"},{id:"205",text:"毕节市"},{id:"208",text:"贵阳市"},{id:"210",text:"六盘水市"},{id:"211",text:"黔东南苗族侗族自治州"},{id:"212",text:"黔南布依族苗族自治州"},{id:"213",text:"黔西南布依族苗族自治州"},{id:"215",text:"铜仁市"},{id:"217",text:"遵义市"}]},{id:"30",text:"四川",children:[{id:"516",text:"阿坝藏族羌族自治州"},{id:"517",text:"巴中市"},{id:"518",text:"成都市"},{id:"519",text:"达州市"},{id:"520",text:"德阳市"},{id:"523",text:"甘孜藏族自治州"},{id:"524",text:"广安市"},{id:"526",text:"广元市"},{id:"528",text:"乐山市"},{id:"529",text:"凉山彝族自治州"},{id:"530",text:"泸州市"},{id:"531",text:"眉山市"},{id:"532",text:"绵阳市"},{id:"534",text:"南充市"},{id:"535",text:"内江市"},{id:"536",text:"攀枝花市"},{id:"538",text:"遂宁市"},{id:"540",text:"雅安市"},{id:"541",text:"宜宾市"},{id:"542",text:"资阳市"},{id:"543",text:"自贡市"}]},{id:"31",text:"西藏",children:[{id:"546",text:"拉萨市"},{id:"547",text:"林芝地区"},{id:"548",text:"那曲地区"},{id:"549",text:"日喀则地区"}]},{id:"33",text:"云南",children:[{id:"578",text:"保山市"},{id:"579",text:"楚雄市"},{id:"580",text:"大理市"},{id:"581",text:"德宏傣族景颇族自治州"},{id:"585",text:"红河哈尼族彝族自治州"},{id:"587",text:"昆明市"},{id:"589",text:"丽江市"},{id:"590",text:"临沧市"},{id:"593",text:"普洱市"},{id:"594",text:"曲靖市"},{id:"595",text:"文山市"},{id:"597",text:"玉溪市"},{id:"598",text:"昭通市"}]}]},{id:"86",text:"西北地区",children:[{id:"10",text:"甘肃",children:[{id:"139",text:"白银市"},{id:"140",text:"定西市"},{id:"144",text:"嘉峪关市"},{id:"145",text:"金昌市"},{id:"146",text:"酒泉市"},{id:"147",text:"兰州市"},{id:"148",text:"临夏回族自治州"},{id:"150",text:"陇南市"},{id:"151",text:"平凉市"},{id:"152",text:"庆阳市"},{id:"153",text:"天水市"},{id:"154",text:"武威市"},{id:"156",text:"张掖市"}]},{id:"25",text:"宁夏",children:[{id:"446",text:"固原市"},{id:"447",text:"石嘴山市"},{id:"448",text:"吴忠市"},{id:"449",text:"银川市"},{id:"450",text:"中卫市"}]},{id:"26",text:"青海",children:[{id:"454",text:"海东地区"},{id:"456",text:"海西蒙古族藏族自治州"},{id:"458",text:"西宁市"},{id:"459",text:"玉树藏族自治州"}]},{id:"29",text:"陕西",children:[{id:"503",text:"安康市"},{id:"504",text:"宝鸡市"},{id:"506",text:"汉中市"},{id:"508",text:"商洛市"},{id:"509",text:"铜川市"},{id:"510",text:"渭南市"},{id:"511",text:"西安市"},{id:"512",text:"咸阳市"},{id:"513",text:"延安市"},{id:"515",text:"榆林市"}]},{id:"32",text:"新疆",children:[{id:"551",text:"阿克苏地区"},{id:"554",text:"阿勒泰市"},{id:"556",text:"巴音郭楞蒙古自治州"},{id:"557",text:"博尔塔拉蒙古自治州"},{id:"560",text:"昌吉回族自治州"},{id:"563",text:"哈密市"},{id:"564",text:"和田市"},{id:"565",text:"喀什市"},{id:"566",text:"克拉玛依市"},{id:"570",text:"石河子市"},{id:"571",text:"塔城市"},{id:"572",text:"吐鲁番市"},{id:"573",text:"乌鲁木齐市"},{id:"576",text:"伊犁市"},{id:"869",text:"克孜勒苏柯尔克孜"},{id:"870",text:"五家渠"}]}]},{id:"87",text:"港澳台",children:[{id:"5",text:"澳门"},{id:"6",text:"香港"},{id:"7",text:"台湾"}]}]},{id:"999",text:"国外"},{id:"0",text:"其他"}],C.inherits(e,_),T.register(e),e}),function(e){function t(e,t,i){switch(arguments.length){case 2:return null!=e?e:t;case 3:return null!=e?e:null!=t?t:i;default:throw new Error("Implement me")}}function i(e,t){return Se.call(e,t)}function n(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function r(e){if(we.suppressDeprecationWarnings===!1&&"undefined"!=typeof console&&console.warn)console.warn("Deprecation warning: "+e)}function a(e,t){var i=!0;return p(function(){if(i)r(e),i=!1;return t.apply(this,arguments)},t)}function o(e,t){if(!yt[e])r(t),yt[e]=!0}function s(e,t){return function(i){return v(e.call(this,i),t)}}function l(e,t){return function(i){return this.localeData().ordinal(e.call(this,i),t)}}function u(e,t){var i,n,r=12*(t.year()-e.year())+(t.month()-e.month()),a=e.clone().add(r,"months");if(0>t-a)i=e.clone().add(r-1,"months"),n=(t-a)/(a-i);else i=e.clone().add(r+1,"months"),n=(t-a)/(i-a);return-(r+n)}function c(e,t,i){var n;if(null==i)return t;if(null!=e.meridiemHour)return e.meridiemHour(t,i);else if(null!=e.isPM){if(n=e.isPM(i),n&&12>t)t+=12;if(!n&&12===t)t=0;return t}else return t}function f(){}function d(e,t){if(t!==!1)I(e);if(m(this,e),this._d=new Date(+e._d),xt===!1)xt=!0,we.updateOffset(this),xt=!1}function h(e){var t=M(e),i=t.year||0,n=t.quarter||0,r=t.month||0,a=t.week||0,o=t.day||0,s=t.hour||0,l=t.minute||0,u=t.second||0,c=t.millisecond||0;this._milliseconds=+c+1e3*u+6e4*l+36e5*s,this._days=+o+7*a,this._months=+r+3*n+12*i,this._data={},this._locale=we.localeData(),this._bubble()}function p(e,t){for(var n in t)if(i(t,n))e[n]=t[n];if(i(t,"toString"))e.toString=t.toString;if(i(t,"valueOf"))e.valueOf=t.valueOf;return e}function m(e,t){var i,n,r;if("undefined"!=typeof t._isAMomentObject)e._isAMomentObject=t._isAMomentObject;if("undefined"!=typeof t._i)e._i=t._i;if("undefined"!=typeof t._f)e._f=t._f;if("undefined"!=typeof t._l)e._l=t._l;if("undefined"!=typeof t._strict)e._strict=t._strict;if("undefined"!=typeof t._tzm)e._tzm=t._tzm;if("undefined"!=typeof t._isUTC)e._isUTC=t._isUTC;if("undefined"!=typeof t._offset)e._offset=t._offset;if("undefined"!=typeof t._pf)e._pf=t._pf;if("undefined"!=typeof t._locale)e._locale=t._locale;if(Re.length>0)for(i in Re)if(n=Re[i],r=t[n],"undefined"!=typeof r)e[n]=r;return e}function g(e){if(0>e)return Math.ceil(e);else return Math.floor(e)}function v(e,t,i){for(var n=""+Math.abs(e),r=e>=0;n.length<t;)n="0"+n;return(r?i?"+":"":"-")+n}function y(e,t){var i={milliseconds:0,months:0};if(i.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(i.months,"M").isAfter(t))--i.months;return i.milliseconds=+t-+e.clone().add(i.months,"M"),i}function b(e,t){var i;if(t=Y(t,e),e.isBefore(t))i=y(e,t);else i=y(t,e),i.milliseconds=-i.milliseconds,i.months=-i.months;return i}function x(e,t){return function(i,n){var r,a;if(null!==n&&!isNaN(+n))o(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period)."),a=i,i=n,n=a;return i="string"==typeof i?+i:i,r=we.duration(i,n),w(this,r,e),this}}function w(e,t,i,n){var r=t._milliseconds,a=t._days,o=t._months;if(n=null==n?!0:n,r)e._d.setTime(+e._d+r*i);if(a)me(e,"Date",pe(e,"Date")+a*i);if(o)he(e,pe(e,"Month")+o*i);if(n)we.updateOffset(e,a||o)}function C(e){return"[object Array]"===Object.prototype.toString.call(e)}function k(e){return"[object Date]"===Object.prototype.toString.call(e)||e instanceof Date}function _(e,t,i){var n,r=Math.min(e.length,t.length),a=Math.abs(e.length-t.length),o=0;for(n=0;r>n;n++)if(i&&e[n]!==t[n]||!i&&L(e[n])!==L(t[n]))o++;return o+a}function T(e){if(e){var t=e.toLowerCase().replace(/(.)s$/,"$1");e=ft[e]||dt[t]||t}return e}function M(e){var t,n,r={};for(n in e)if(i(e,n))if(t=T(n))r[t]=e[n];return r}function S(t){var i,n;if(0===t.indexOf("week"))i=7,n="day";else if(0===t.indexOf("month"))i=12,n="month";else return;we[t]=function(r,a){var o,s,l=we._locale[t],u=[];if("number"==typeof r)a=r,r=e;if(s=function(e){var t=we().utc().set(n,e);return l.call(we._locale,t,r||"")},null!=a)return s(a);else{for(o=0;i>o;o++)u.push(s(o));return u}}}function L(e){var t=+e,i=0;if(0!==t&&isFinite(t))if(t>=0)i=Math.floor(t);else i=Math.ceil(t);return i}function D(e,t){return new Date(Date.UTC(e,t+1,0)).getUTCDate()}function P(e,t,i){return ue(we([e,11,31+t-i]),t,i).week}function A(e){return E(e)?366:365}function E(e){return e%4===0&&e%100!==0||e%400===0}function I(e){var t;if(e._a&&-2===e._pf.overflow){if(t=e._a[De]<0||e._a[De]>11?De:e._a[Pe]<1||e._a[Pe]>D(e._a[Le],e._a[De])?Pe:e._a[Ae]<0||e._a[Ae]>24||24===e._a[Ae]&&(0!==e._a[Ee]||0!==e._a[Ie]||0!==e._a[Oe])?Ae:e._a[Ee]<0||e._a[Ee]>59?Ee:e._a[Ie]<0||e._a[Ie]>59?Ie:e._a[Oe]<0||e._a[Oe]>999?Oe:-1,e._pf._overflowDayOfYear&&(Le>t||t>Pe))t=Pe;e._pf.overflow=t}}function O(t){if(null==t._isValid)if(t._isValid=!isNaN(t._d.getTime())&&t._pf.overflow<0&&!t._pf.empty&&!t._pf.invalidMonth&&!t._pf.nullInput&&!t._pf.invalidFormat&&!t._pf.userInvalidated,t._strict)t._isValid=t._isValid&&0===t._pf.charsLeftOver&&0===t._pf.unusedTokens.length&&t._pf.bigHour===e;return t._isValid}function N(e){return e?e.toLowerCase().replace("_","-"):e}function R(e){for(var t,i,n,r,a=0;a<e.length;){for(r=N(e[a]).split("-"),t=r.length,i=N(e[a+1]),i=i?i.split("-"):null;t>0;){if(n=H(r.slice(0,t).join("-")))return n;if(i&&i.length>=t&&_(r,i,!0)>=t-1)break;t--}a++}return null}function H(e){var t=null;if(!Ne[e]&&He)try{t=we.locale(),require("./locale/"+e),we.locale(t)}catch(i){}return Ne[e]}function Y(e,t){var i,n;if(t._isUTC)return i=t.clone(),n=(we.isMoment(e)||k(e)?+e:+we(e))-+i,i._d.setTime(+i._d+n),we.updateOffset(i,!1),i;else return we(e).local()}function j(e){if(e.match(/\[[\s\S]/))return e.replace(/^\[|\]$/g,"");else return e.replace(/\\/g,"")}function z(e){var t,i,n=e.match(Be);for(t=0,i=n.length;i>t;t++)if(vt[n[t]])n[t]=vt[n[t]];else n[t]=j(n[t]);return function(r){var a="";for(t=0;i>t;t++)a+=n[t]instanceof Function?n[t].call(r,e):n[t];return a}}function B(e,t){if(!e.isValid())return e.localeData().invalidDate();if(t=F(t,e.localeData()),!ht[t])ht[t]=z(t);return ht[t](e)}function F(e,t){function i(e){return t.longDateFormat(e)||e}var n=5;for(Fe.lastIndex=0;n>=0&&Fe.test(e);)e=e.replace(Fe,i),Fe.lastIndex=0,n-=1;return e}function V(e,t){var i,n=t._strict;switch(e){case"Q":return Je;case"DDDD":return tt;case"YYYY":case"GGGG":case"gggg":return n?it:$e;case"Y":case"G":case"g":return rt;case"YYYYYY":case"YYYYY":case"GGGGG":case"ggggg":return n?nt:qe;case"S":if(n)return Je;case"SS":if(n)return et;case"SSS":if(n)return tt;case"DDD":return We;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return Xe;case"a":case"A":return t._locale._meridiemParse;case"x":return Ze;case"X":return Ke;case"Z":case"ZZ":return Ge;case"T":return Qe;case"SSSS":return Ue;case"MM":case"DD":case"YY":case"GG":case"gg":case"HH":case"hh":case"mm":case"ss":case"ww":case"WW":return n?et:Ve;case"M":case"D":case"d":case"H":case"h":case"m":case"s":case"w":case"W":case"e":case"E":return Ve;case"Do":return n?t._locale._ordinalParse:t._locale._ordinalParseLenient;default:return i=new RegExp(K(Z(e.replace("\\","")),"i"))}}function W(e){e=e||"";var t=e.match(Ge)||[],i=t[t.length-1]||[],n=(i+"").match(ut)||["-",0,0],r=+(60*n[1])+L(n[2]);return"+"===n[0]?r:-r}function $(e,t,i){var n,r=i._a;switch(e){case"Q":if(null!=t)r[De]=3*(L(t)-1);break;case"M":case"MM":if(null!=t)r[De]=L(t)-1;break;case"MMM":case"MMMM":if(n=i._locale.monthsParse(t,e,i._strict),null!=n)r[De]=n;else i._pf.invalidMonth=t;break;case"D":case"DD":if(null!=t)r[Pe]=L(t);break;case"Do":if(null!=t)r[Pe]=L(parseInt(t.match(/\d{1,2}/)[0],10));break;case"DDD":case"DDDD":if(null!=t)i._dayOfYear=L(t);break;case"YY":r[Le]=we.parseTwoDigitYear(t);break;case"YYYY":case"YYYYY":case"YYYYYY":r[Le]=L(t);break;case"a":case"A":i._meridiem=t;break;case"h":case"hh":i._pf.bigHour=!0;case"H":case"HH":r[Ae]=L(t);break;case"m":case"mm":r[Ee]=L(t);break;case"s":case"ss":r[Ie]=L(t);break;case"S":case"SS":case"SSS":case"SSSS":r[Oe]=L(1e3*("0."+t));break;case"x":i._d=new Date(L(t));break;case"X":i._d=new Date(1e3*parseFloat(t));break;case"Z":case"ZZ":i._useUTC=!0,i._tzm=W(t);break;case"dd":case"ddd":case"dddd":if(n=i._locale.weekdaysParse(t),null!=n)i._w=i._w||{},i._w.d=n;else i._pf.invalidWeekday=t;break;case"w":case"ww":case"W":case"WW":case"d":case"e":case"E":e=e.substr(0,1);case"gggg":case"GGGG":case"GGGGG":if(e=e.substr(0,2),t)i._w=i._w||{},i._w[e]=L(t);break;case"gg":case"GG":i._w=i._w||{},i._w[e]=we.parseTwoDigitYear(t)}}function q(e){var i,n,r,a,o,s,l;if(i=e._w,null!=i.GG||null!=i.W||null!=i.E)o=1,s=4,n=t(i.GG,e._a[Le],ue(we(),1,4).year),r=t(i.W,1),a=t(i.E,1);else if(o=e._locale._week.dow,s=e._locale._week.doy,n=t(i.gg,e._a[Le],ue(we(),o,s).year),r=t(i.w,1),null!=i.d){if(a=i.d,o>a)++r}else if(null!=i.e)a=i.e+o;else a=o;l=ce(n,r,a,s,o),e._a[Le]=l.year,e._dayOfYear=l.dayOfYear}function U(e){var i,n,r,a,o=[];if(!e._d){if(r=G(e),e._w&&null==e._a[Pe]&&null==e._a[De])q(e);if(e._dayOfYear){if(a=t(e._a[Le],r[Le]),e._dayOfYear>A(a))e._pf._overflowDayOfYear=!0;n=ae(a,0,e._dayOfYear),e._a[De]=n.getUTCMonth(),e._a[Pe]=n.getUTCDate()}for(i=0;3>i&&null==e._a[i];++i)e._a[i]=o[i]=r[i];for(;7>i;i++)e._a[i]=o[i]=null==e._a[i]?2===i?1:0:e._a[i];if(24===e._a[Ae]&&0===e._a[Ee]&&0===e._a[Ie]&&0===e._a[Oe])e._nextDay=!0,e._a[Ae]=0;if(e._d=(e._useUTC?ae:re).apply(null,o),null!=e._tzm)e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm);if(e._nextDay)e._a[Ae]=24}}function X(e){var t;if(!e._d)t=M(e._i),e._a=[t.year,t.month,t.day||t.date,t.hour,t.minute,t.second,t.millisecond],U(e)}function G(e){var t=new Date;if(e._useUTC)return[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()];else return[t.getFullYear(),t.getMonth(),t.getDate()]}function Q(t){if(t._f===we.ISO_8601)return void ee(t);t._a=[],t._pf.empty=!0;var i,n,r,a,o,s=""+t._i,l=s.length,u=0;for(r=F(t._f,t._locale).match(Be)||[],i=0;i<r.length;i++){if(a=r[i],n=(s.match(V(a,t))||[])[0]){if(o=s.substr(0,s.indexOf(n)),o.length>0)t._pf.unusedInput.push(o);s=s.slice(s.indexOf(n)+n.length),u+=n.length}if(vt[a]){if(n)t._pf.empty=!1;else t._pf.unusedTokens.push(a);$(a,n,t)}else if(t._strict&&!n)t._pf.unusedTokens.push(a)}if(t._pf.charsLeftOver=l-u,s.length>0)t._pf.unusedInput.push(s);if(t._pf.bigHour===!0&&t._a[Ae]<=12)t._pf.bigHour=e;t._a[Ae]=c(t._locale,t._a[Ae],t._meridiem),U(t),I(t)}function Z(e){return e.replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,i,n,r){return t||i||n||r})}function K(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function J(e){var t,i,r,a,o;if(0===e._f.length)return e._pf.invalidFormat=!0,void(e._d=new Date(NaN));for(a=0;a<e._f.length;a++){if(o=0,t=m({},e),null!=e._useUTC)t._useUTC=e._useUTC;if(t._pf=n(),t._f=e._f[a],Q(t),O(t)){if(o+=t._pf.charsLeftOver,o+=10*t._pf.unusedTokens.length,t._pf.score=o,null==r||r>o)r=o,i=t}else;}p(e,i||t)}function ee(e){var t,i,n=e._i,r=at.exec(n);if(r){for(e._pf.iso=!0,t=0,i=st.length;i>t;t++)if(st[t][1].exec(n)){e._f=st[t][0]+(r[6]||" ");break}for(t=0,i=lt.length;i>t;t++)if(lt[t][1].exec(n)){e._f+=lt[t][0];break}if(n.match(Ge))e._f+="Z";Q(e)}else e._isValid=!1}function te(e){if(ee(e),e._isValid===!1)delete e._isValid,we.createFromInputFallback(e)}function ie(e,t){var i,n=[];for(i=0;i<e.length;++i)n.push(t(e[i],i));return n}function ne(t){var i,n=t._i;if(n===e)t._d=new Date;else if(k(n))t._d=new Date(+n);else if(null!==(i=Ye.exec(n)))t._d=new Date(+i[1]);else if("string"==typeof n)te(t);else if(C(n))t._a=ie(n.slice(0),function(e){return parseInt(e,10)}),U(t);else if("object"==typeof n)X(t);else if("number"==typeof n)t._d=new Date(n);else we.createFromInputFallback(t)}function re(e,t,i,n,r,a,o){var s=new Date(e,t,i,n,r,a,o);if(1970>e)s.setFullYear(e);return s}function ae(e){var t=new Date(Date.UTC.apply(null,arguments));if(1970>e)t.setUTCFullYear(e);return t}function oe(e,t){if("string"==typeof e)if(!isNaN(e))e=parseInt(e,10);else if(e=t.weekdaysParse(e),"number"!=typeof e)return null;return e}function se(e,t,i,n,r){return r.relativeTime(t||1,!!i,e,n)}function le(e,t,i){var n=we.duration(e).abs(),r=Me(n.as("s")),a=Me(n.as("m")),o=Me(n.as("h")),s=Me(n.as("d")),l=Me(n.as("M")),u=Me(n.as("y")),c=r<pt.s&&["s",r]||1===a&&["m"]||a<pt.m&&["mm",a]||1===o&&["h"]||o<pt.h&&["hh",o]||1===s&&["d"]||s<pt.d&&["dd",s]||1===l&&["M"]||l<pt.M&&["MM",l]||1===u&&["y"]||["yy",u];return c[2]=t,c[3]=+e>0,c[4]=i,se.apply({},c)}function ue(e,t,i){var n,r=i-t,a=i-e.day();if(a>r)a-=7;if(r-7>a)a+=7;return n=we(e).add(a,"d"),{week:Math.ceil(n.dayOfYear()/7),year:n.year()}}function ce(e,t,i,n,r){var a,o,s=ae(e,0,1).getUTCDay();return s=0===s?7:s,i=null!=i?i:r,a=r-s+(s>n?7:0)-(r>s?7:0),o=7*(t-1)+(i-r)+a+1,{year:o>0?e:e-1,dayOfYear:o>0?o:A(e-1)+o}}function fe(t){var i,n=t._i,r=t._f;if(t._locale=t._locale||we.localeData(t._l),null===n||r===e&&""===n)return we.invalid({nullInput:!0});if("string"==typeof n)t._i=n=t._locale.preparse(n);if(we.isMoment(n))return new d(n,!0);else if(r)if(C(r))J(t);else Q(t);else ne(t);if(i=new d(t),i._nextDay)i.add(1,"d"),i._nextDay=e;return i}function de(e,t){var i,n;if(1===t.length&&C(t[0]))t=t[0];if(!t.length)return we();for(i=t[0],n=1;n<t.length;++n)if(t[n][e](i))i=t[n];return i}function he(e,t){var i;if("string"==typeof t)if(t=e.localeData().monthsParse(t),"number"!=typeof t)return e;return i=Math.min(e.date(),D(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,i),e}function pe(e,t){return e._d["get"+(e._isUTC?"UTC":"")+t]();
}function me(e,t,i){if("Month"===t)return he(e,i);else return e._d["set"+(e._isUTC?"UTC":"")+t](i)}function ge(e,t){return function(i){if(null!=i)return me(this,e,i),we.updateOffset(this,t),this;else return pe(this,e)}}function ve(e){return 400*e/146097}function ye(e){return 146097*e/400}function be(e){we.duration.fn[e]=function(){return this._data[e]}}function xe(e){if("undefined"==typeof ender)if(Ce=Te.moment,e)Te.moment=a("Accessing Moment through the global scope is deprecated, and will be removed in an upcoming release.",we);else Te.moment=we}for(var we,Ce,ke,_e="2.9.0",Te="undefined"!=typeof global&&("undefined"==typeof window||window===global.window)?global:this,Me=Math.round,Se=Object.prototype.hasOwnProperty,Le=0,De=1,Pe=2,Ae=3,Ee=4,Ie=5,Oe=6,Ne={},Re=[],He="undefined"!=typeof module&&module&&module.exports,Ye=/^\/?Date\((\-?\d+)/i,je=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,ze=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/,Be=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Q|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|x|X|zz?|ZZ?|.)/g,Fe=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Ve=/\d\d?/,We=/\d{1,3}/,$e=/\d{1,4}/,qe=/[+\-]?\d{1,6}/,Ue=/\d+/,Xe=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,Ge=/Z|[\+\-]\d\d:?\d\d/gi,Qe=/T/i,Ze=/[\+\-]?\d+/,Ke=/[\+\-]?\d+(\.\d{1,3})?/,Je=/\d/,et=/\d\d/,tt=/\d{3}/,it=/\d{4}/,nt=/[+-]?\d{6}/,rt=/[+-]?\d+/,at=/^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,ot="YYYY-MM-DDTHH:mm:ssZ",st=[["YYYYYY-MM-DD",/[+-]\d{6}-\d{2}-\d{2}/],["YYYY-MM-DD",/\d{4}-\d{2}-\d{2}/],["GGGG-[W]WW-E",/\d{4}-W\d{2}-\d/],["GGGG-[W]WW",/\d{4}-W\d{2}/],["YYYY-DDD",/\d{4}-\d{3}/]],lt=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],ut=/([\+\-]|\d\d)/gi,ct=("Date|Hours|Minutes|Seconds|Milliseconds".split("|"),{Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6}),ft={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",D:"date",w:"week",W:"isoWeek",M:"month",Q:"quarter",y:"year",DDD:"dayOfYear",e:"weekday",E:"isoWeekday",gg:"weekYear",GG:"isoWeekYear"},dt={dayofyear:"dayOfYear",isoweekday:"isoWeekday",isoweek:"isoWeek",weekyear:"weekYear",isoweekyear:"isoWeekYear"},ht={},pt={s:45,m:45,h:22,d:26,M:11},mt="DDD w W M D d".split(" "),gt="M D H h m s w W".split(" "),vt={M:function(){return this.month()+1},MMM:function(e){return this.localeData().monthsShort(this,e)},MMMM:function(e){return this.localeData().months(this,e)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(e){return this.localeData().weekdaysMin(this,e)},ddd:function(e){return this.localeData().weekdaysShort(this,e)},dddd:function(e){return this.localeData().weekdays(this,e)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return v(this.year()%100,2)},YYYY:function(){return v(this.year(),4)},YYYYY:function(){return v(this.year(),5)},YYYYYY:function(){var e=this.year(),t=e>=0?"+":"-";return t+v(Math.abs(e),6)},gg:function(){return v(this.weekYear()%100,2)},gggg:function(){return v(this.weekYear(),4)},ggggg:function(){return v(this.weekYear(),5)},GG:function(){return v(this.isoWeekYear()%100,2)},GGGG:function(){return v(this.isoWeekYear(),4)},GGGGG:function(){return v(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.localeData().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.localeData().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return L(this.milliseconds()/100)},SS:function(){return v(L(this.milliseconds()/10),2)},SSS:function(){return v(this.milliseconds(),3)},SSSS:function(){return v(this.milliseconds(),3)},Z:function(){var e=this.utcOffset(),t="+";if(0>e)e=-e,t="-";return t+v(L(e/60),2)+":"+v(L(e)%60,2)},ZZ:function(){var e=this.utcOffset(),t="+";if(0>e)e=-e,t="-";return t+v(L(e/60),2)+v(L(e)%60,2)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},x:function(){return this.valueOf()},X:function(){return this.unix()},Q:function(){return this.quarter()}},yt={},bt=["months","monthsShort","weekdays","weekdaysShort","weekdaysMin"],xt=!1;mt.length;)ke=mt.pop(),vt[ke+"o"]=l(vt[ke],ke);for(;gt.length;)ke=gt.pop(),vt[ke+ke]=s(vt[ke],2);vt.DDDD=s(vt.DDD,3),p(f.prototype,{set:function(e){var t,i;for(i in e)if(t=e[i],"function"==typeof t)this[i]=t;else this["_"+i]=t;this._ordinalParseLenient=new RegExp(this._ordinalParse.source+"|"+/\d{1,2}/.source)},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(e){return this._months[e.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(e){return this._monthsShort[e.month()]},monthsParse:function(e,t,i){var n,r,a;if(!this._monthsParse)this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[];for(n=0;12>n;n++){if(r=we.utc([2e3,n]),i&&!this._longMonthsParse[n])this._longMonthsParse[n]=new RegExp("^"+this.months(r,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(r,"").replace(".","")+"$","i");if(!i&&!this._monthsParse[n])a="^"+this.months(r,"")+"|^"+this.monthsShort(r,""),this._monthsParse[n]=new RegExp(a.replace(".",""),"i");if(i&&"MMMM"===t&&this._longMonthsParse[n].test(e))return n;else if(i&&"MMM"===t&&this._shortMonthsParse[n].test(e))return n;else if(!i&&this._monthsParse[n].test(e))return n}},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(e){return this._weekdays[e.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(e){return this._weekdaysShort[e.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(e){return this._weekdaysMin[e.day()]},weekdaysParse:function(e){var t,i,n;if(!this._weekdaysParse)this._weekdaysParse=[];for(t=0;7>t;t++){if(!this._weekdaysParse[t])i=we([2e3,1]).day(t),n="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[t]=new RegExp(n.replace(".",""),"i");if(this._weekdaysParse[t].test(e))return t}},_longDateFormat:{LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY LT",LLLL:"dddd, MMMM D, YYYY LT"},longDateFormat:function(e){var t=this._longDateFormat[e];if(!t&&this._longDateFormat[e.toUpperCase()])t=this._longDateFormat[e.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e]=t;return t},isPM:function(e){return"p"===(e+"").toLowerCase().charAt(0)},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(e,t,i){if(e>11)return i?"pm":"PM";else return i?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(e,t,i){var n=this._calendar[e];return"function"==typeof n?n.apply(t,[i]):n},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(e,t,i,n){var r=this._relativeTime[i];return"function"==typeof r?r(e,t,i,n):r.replace(/%d/i,e)},pastFuture:function(e,t){var i=this._relativeTime[e>0?"future":"past"];return"function"==typeof i?i(t):i.replace(/%s/i,t)},ordinal:function(e){return this._ordinal.replace("%d",e)},_ordinal:"%d",_ordinalParse:/\d{1,2}/,preparse:function(e){return e},postformat:function(e){return e},week:function(e){return ue(e,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6},firstDayOfWeek:function(){return this._week.dow},firstDayOfYear:function(){return this._week.doy},_invalidDate:"Invalid date",invalidDate:function(){return this._invalidDate}}),we=function(t,i,r,a){var o;if("boolean"==typeof r)a=r,r=e;return o={},o._isAMomentObject=!0,o._i=t,o._f=i,o._l=r,o._strict=a,o._isUTC=!1,o._pf=n(),fe(o)},we.suppressDeprecationWarnings=!1,we.createFromInputFallback=a("moment construction falls back to js Date. This is discouraged and will be removed in upcoming major release. Please refer to https://github.com/moment/moment/issues/1407 for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))}),we.min=function(){var e=[].slice.call(arguments,0);return de("isBefore",e)},we.max=function(){var e=[].slice.call(arguments,0);return de("isAfter",e)},we.utc=function(t,i,r,a){var o;if("boolean"==typeof r)a=r,r=e;return o={},o._isAMomentObject=!0,o._useUTC=!0,o._isUTC=!0,o._l=r,o._i=t,o._f=i,o._strict=a,o._pf=n(),fe(o).utc()},we.unix=function(e){return we(1e3*e)},we.duration=function(e,t){var n,r,a,o,s=e,l=null;if(we.isDuration(e))s={ms:e._milliseconds,d:e._days,M:e._months};else if("number"==typeof e)if(s={},t)s[t]=e;else s.milliseconds=e;else if(l=je.exec(e))n="-"===l[1]?-1:1,s={y:0,d:L(l[Pe])*n,h:L(l[Ae])*n,m:L(l[Ee])*n,s:L(l[Ie])*n,ms:L(l[Oe])*n};else if(l=ze.exec(e))n="-"===l[1]?-1:1,a=function(e){var t=e&&parseFloat(e.replace(",","."));return(isNaN(t)?0:t)*n},s={y:a(l[2]),M:a(l[3]),d:a(l[4]),h:a(l[5]),m:a(l[6]),s:a(l[7]),w:a(l[8])};else if(null==s)s={};else if("object"==typeof s&&("from"in s||"to"in s))o=b(we(s.from),we(s.to)),s={},s.ms=o.milliseconds,s.M=o.months;if(r=new h(s),we.isDuration(e)&&i(e,"_locale"))r._locale=e._locale;return r},we.version=_e,we.defaultFormat=ot,we.ISO_8601=function(){},we.momentProperties=Re,we.updateOffset=function(){},we.relativeTimeThreshold=function(t,i){if(pt[t]===e)return!1;if(i===e)return pt[t];else return pt[t]=i,!0},we.lang=a("moment.lang is deprecated. Use moment.locale instead.",function(e,t){return we.locale(e,t)}),we.locale=function(e,t){var i;if(e){if("undefined"!=typeof t)i=we.defineLocale(e,t);else i=we.localeData(e);if(i)we.duration._locale=we._locale=i}return we._locale._abbr},we.defineLocale=function(e,t){if(null!==t){if(t.abbr=e,!Ne[e])Ne[e]=new f;return Ne[e].set(t),we.locale(e),Ne[e]}else return delete Ne[e],null},we.langData=a("moment.langData is deprecated. Use moment.localeData instead.",function(e){return we.localeData(e)}),we.localeData=function(e){var t;if(e&&e._locale&&e._locale._abbr)e=e._locale._abbr;if(!e)return we._locale;if(!C(e)){if(t=H(e))return t;e=[e]}return R(e)},we.isMoment=function(e){return e instanceof d||null!=e&&i(e,"_isAMomentObject")},we.isDuration=function(e){return e instanceof h};for(ke=bt.length-1;ke>=0;--ke)S(bt[ke]);we.normalizeUnits=function(e){return T(e)},we.invalid=function(e){var t=we.utc(NaN);if(null!=e)p(t._pf,e);else t._pf.userInvalidated=!0;return t},we.parseZone=function(){return we.apply(null,arguments).parseZone()},we.parseTwoDigitYear=function(e){return L(e)+(L(e)>68?1900:2e3)},we.isDate=k,p(we.fn=d.prototype,{clone:function(){return we(this)},valueOf:function(){return+this._d-6e4*(this._offset||0)},unix:function(){return Math.floor(+this/1e3)},toString:function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){var e=we(this).utc();if(0<e.year()&&e.year()<=9999)if("function"==typeof Date.prototype.toISOString)return this.toDate().toISOString();else return B(e,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]");else return B(e,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var e=this;return[e.year(),e.month(),e.date(),e.hours(),e.minutes(),e.seconds(),e.milliseconds()]},isValid:function(){return O(this)},isDSTShifted:function(){if(this._a)return this.isValid()&&_(this._a,(this._isUTC?we.utc(this._a):we(this._a)).toArray())>0;else return!1},parsingFlags:function(){return p({},this._pf)},invalidAt:function(){return this._pf.overflow},utc:function(e){return this.utcOffset(0,e)},local:function(e){if(this._isUTC)if(this.utcOffset(0,e),this._isUTC=!1,e)this.subtract(this._dateUtcOffset(),"m");return this},format:function(e){var t=B(this,e||we.defaultFormat);return this.localeData().postformat(t)},add:x(1,"add"),subtract:x(-1,"subtract"),diff:function(e,t,i){var n,r,a=Y(e,this),o=6e4*(a.utcOffset()-this.utcOffset());if(t=T(t),"year"===t||"month"===t||"quarter"===t){if(r=u(this,a),"quarter"===t)r/=3;else if("year"===t)r/=12}else n=this-a,r="second"===t?n/1e3:"minute"===t?n/6e4:"hour"===t?n/36e5:"day"===t?(n-o)/864e5:"week"===t?(n-o)/6048e5:n;return i?r:g(r)},from:function(e,t){return we.duration({to:this,from:e}).locale(this.locale()).humanize(!t)},fromNow:function(e){return this.from(we(),e)},calendar:function(e){var t=e||we(),i=Y(t,this).startOf("day"),n=this.diff(i,"days",!0),r=-6>n?"sameElse":-1>n?"lastWeek":0>n?"lastDay":1>n?"sameDay":2>n?"nextDay":7>n?"nextWeek":"sameElse";return this.format(this.localeData().calendar(r,this,we(t)))},isLeapYear:function(){return E(this.year())},isDST:function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()},day:function(e){var t=this._isUTC?this._d.getUTCDay():this._d.getDay();if(null!=e)return e=oe(e,this.localeData()),this.add(e-t,"d");else return t},month:ge("Month",!0),startOf:function(e){switch(e=T(e)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}if("week"===e)this.weekday(0);else if("isoWeek"===e)this.isoWeekday(1);if("quarter"===e)this.month(3*Math.floor(this.month()/3));return this},endOf:function(t){if(t=T(t),t===e||"millisecond"===t)return this;else return this.startOf(t).add(1,"isoWeek"===t?"week":t).subtract(1,"ms")},isAfter:function(e,t){var i;if(t=T("undefined"!=typeof t?t:"millisecond"),"millisecond"===t)return e=we.isMoment(e)?e:we(e),+this>+e;else return i=we.isMoment(e)?+e:+we(e),i<+this.clone().startOf(t)},isBefore:function(e,t){var i;if(t=T("undefined"!=typeof t?t:"millisecond"),"millisecond"===t)return e=we.isMoment(e)?e:we(e),+e>+this;else return i=we.isMoment(e)?+e:+we(e),+this.clone().endOf(t)<i},isBetween:function(e,t,i){return this.isAfter(e,i)&&this.isBefore(t,i)},isSame:function(e,t){var i;if(t=T(t||"millisecond"),"millisecond"===t)return e=we.isMoment(e)?e:we(e),+this===+e;else return i=+we(e),+this.clone().startOf(t)<=i&&i<=+this.clone().endOf(t)},min:a("moment().min is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548",function(e){return e=we.apply(null,arguments),this>e?this:e}),max:a("moment().max is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548",function(e){return e=we.apply(null,arguments),e>this?this:e}),zone:a("moment().zone is deprecated, use moment().utcOffset instead. https://github.com/moment/moment/issues/1779",function(e,t){if(null!=e){if("string"!=typeof e)e=-e;return this.utcOffset(e,t),this}else return-this.utcOffset()}),utcOffset:function(e,t){var i,n=this._offset||0;if(null!=e){if("string"==typeof e)e=W(e);if(Math.abs(e)<16)e=60*e;if(!this._isUTC&&t)i=this._dateUtcOffset();if(this._offset=e,this._isUTC=!0,null!=i)this.add(i,"m");if(n!==e)if(!t||this._changeInProgress)w(this,we.duration(e-n,"m"),1,!1);else if(!this._changeInProgress)this._changeInProgress=!0,we.updateOffset(this,!0),this._changeInProgress=null;return this}else return this._isUTC?n:this._dateUtcOffset()},isLocal:function(){return!this._isUTC},isUtcOffset:function(){return this._isUTC},isUtc:function(){return this._isUTC&&0===this._offset},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},parseZone:function(){if(this._tzm)this.utcOffset(this._tzm);else if("string"==typeof this._i)this.utcOffset(W(this._i));return this},hasAlignedHourOffset:function(e){if(!e)e=0;else e=we(e).utcOffset();return(this.utcOffset()-e)%60===0},daysInMonth:function(){return D(this.year(),this.month())},dayOfYear:function(e){var t=Me((we(this).startOf("day")-we(this).startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"d")},quarter:function(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)},weekYear:function(e){var t=ue(this,this.localeData()._week.dow,this.localeData()._week.doy).year;return null==e?t:this.add(e-t,"y")},isoWeekYear:function(e){var t=ue(this,1,4).year;return null==e?t:this.add(e-t,"y")},week:function(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),"d")},isoWeek:function(e){var t=ue(this,1,4).week;return null==e?t:this.add(7*(e-t),"d")},weekday:function(e){var t=(this.day()+7-this.localeData()._week.dow)%7;return null==e?t:this.add(e-t,"d")},isoWeekday:function(e){return null==e?this.day()||7:this.day(this.day()%7?e:e-7)},isoWeeksInYear:function(){return P(this.year(),1,4)},weeksInYear:function(){var e=this.localeData()._week;return P(this.year(),e.dow,e.doy)},get:function(e){return e=T(e),this[e]()},set:function(e,t){var i;if("object"==typeof e)for(i in e)this.set(i,e[i]);else if(e=T(e),"function"==typeof this[e])this[e](t);return this},locale:function(t){var i;if(t===e)return this._locale._abbr;else{if(i=we.localeData(t),null!=i)this._locale=i;return this}},lang:a("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){if(t===e)return this.localeData();else return this.locale(t)}),localeData:function(){return this._locale},_dateUtcOffset:function(){return 15*-Math.round(this._d.getTimezoneOffset()/15)}}),we.fn.millisecond=we.fn.milliseconds=ge("Milliseconds",!1),we.fn.second=we.fn.seconds=ge("Seconds",!1),we.fn.minute=we.fn.minutes=ge("Minutes",!1),we.fn.hour=we.fn.hours=ge("Hours",!0),we.fn.date=ge("Date",!0),we.fn.dates=a("dates accessor is deprecated. Use date instead.",ge("Date",!0)),we.fn.year=ge("FullYear",!0),we.fn.years=a("years accessor is deprecated. Use year instead.",ge("FullYear",!0)),we.fn.days=we.fn.day,we.fn.months=we.fn.month,we.fn.weeks=we.fn.week,we.fn.isoWeeks=we.fn.isoWeek,we.fn.quarters=we.fn.quarter,we.fn.toJSON=we.fn.toISOString,we.fn.isUTC=we.fn.isUtc,p(we.duration.fn=h.prototype,{_bubble:function(){var e,t,i,n=this._milliseconds,r=this._days,a=this._months,o=this._data,s=0;o.milliseconds=n%1e3,e=g(n/1e3),o.seconds=e%60,t=g(e/60),o.minutes=t%60,i=g(t/60),o.hours=i%24,r+=g(i/24),s=g(ve(r)),r-=g(ye(s)),a+=g(r/30),r%=30,s+=g(a/12),a%=12,o.days=r,o.months=a,o.years=s},abs:function(){return this._milliseconds=Math.abs(this._milliseconds),this._days=Math.abs(this._days),this._months=Math.abs(this._months),this._data.milliseconds=Math.abs(this._data.milliseconds),this._data.seconds=Math.abs(this._data.seconds),this._data.minutes=Math.abs(this._data.minutes),this._data.hours=Math.abs(this._data.hours),this._data.months=Math.abs(this._data.months),this._data.years=Math.abs(this._data.years),this},weeks:function(){return g(this.days()/7)},valueOf:function(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*L(this._months/12)},humanize:function(e){var t=le(this,!e,this.localeData());if(e)t=this.localeData().pastFuture(+this,t);return this.localeData().postformat(t)},add:function(e,t){var i=we.duration(e,t);return this._milliseconds+=i._milliseconds,this._days+=i._days,this._months+=i._months,this._bubble(),this},subtract:function(e,t){var i=we.duration(e,t);return this._milliseconds-=i._milliseconds,this._days-=i._days,this._months-=i._months,this._bubble(),this},get:function(e){return e=T(e),this[e.toLowerCase()+"s"]()},as:function(e){var t,i;if(e=T(e),"month"===e||"year"===e)return t=this._days+this._milliseconds/864e5,i=this._months+12*ve(t),"month"===e?i:i/12;else switch(t=this._days+Math.round(ye(this._months/12)),e){case"week":return t/7+this._milliseconds/6048e5;case"day":return t+this._milliseconds/864e5;case"hour":return 24*t+this._milliseconds/36e5;case"minute":return 24*t*60+this._milliseconds/6e4;case"second":return 24*t*60*60+this._milliseconds/1e3;case"millisecond":return Math.floor(24*t*60*60*1e3)+this._milliseconds;default:throw new Error("Unknown unit "+e)}},lang:we.fn.lang,locale:we.fn.locale,toIsoString:a("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",function(){return this.toISOString()}),toISOString:function(){var e=Math.abs(this.years()),t=Math.abs(this.months()),i=Math.abs(this.days()),n=Math.abs(this.hours()),r=Math.abs(this.minutes()),a=Math.abs(this.seconds()+this.milliseconds()/1e3);if(!this.asSeconds())return"P0D";else return(this.asSeconds()<0?"-":"")+"P"+(e?e+"Y":"")+(t?t+"M":"")+(i?i+"D":"")+(n||r||a?"T":"")+(n?n+"H":"")+(r?r+"M":"")+(a?a+"S":"")},localeData:function(){return this._locale},toJSON:function(){return this.toISOString()}}),we.duration.fn.toString=we.duration.fn.toISOString;for(ke in ct)if(i(ct,ke))be(ke.toLowerCase());if(we.duration.fn.asMilliseconds=function(){return this.as("ms")},we.duration.fn.asSeconds=function(){return this.as("s")},we.duration.fn.asMinutes=function(){return this.as("m")},we.duration.fn.asHours=function(){return this.as("h")},we.duration.fn.asDays=function(){return this.as("d")},we.duration.fn.asWeeks=function(){return this.as("weeks")},we.duration.fn.asMonths=function(){return this.as("M")},we.duration.fn.asYears=function(){return this.as("y")},we.locale("en",{ordinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10,i=1===L(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th";return e+i}}),He)module.exports=we;else if("function"==typeof define&&define.amd)define("moment/moment",["require","exports","module"],function(require,exports,module){if(module.config&&module.config()&&module.config().noGlobal===!0)Te.moment=Ce;return we}),xe(!0);else xe()}.call(this),define("moment",["moment/moment"],function(e){return e}),define("esui/RangeCalendar",["require","./Button","./MonthView","./CheckBox","./Label","./lib","./InputControl","./controlHelper","./Layer","./main","moment","underscore"],function(require){function e(){T.apply(this,arguments)}function t(e,t,i){if("render"===i){var n=e.helper.getPart("shortcut");_.addDOMEvent(e,n,"click",m);var r=e.getChild("endlessCheck");if(r)if(r.on("change",C.curry(u,e)),e.isEndless)r.setChecked(!0),e.helper.addPartClasses("shortcut-disabled",e.helper.getPart(e));var a=e.getChild("okBtn");a.on("click",C.curry(v,e));var o=e.getChild("cancelBtn");o.on("click",L.bind(e.layer.hide,e.layer));var s=e.getChild("closeBtn");s.on("click",L.bind(e.layer.hide,e.layer))}else{e.view.begin=t.begin,e.view.end=t.end,e.value=e.convertToParam(t);var l;if(!t.end)l=!0;else l=!1;e.setProperties({isEndless:l})}p(e,"begin",e.view.begin,"render"===i),p(e,"end",e.view.end,"render"===i);var c=f(e,e.view);h(e,c)}function i(t){this.now=new Date,k.apply(this,arguments),this.layer=new e(this)}function n(e){var t='<div class="${shortCutClass}" id="${shortcutId}">${shortCut}</div><div class="${bodyClass}">${beginCalendar}${endCalendar}</div><div class="${footClass}"><div class="${okBtnClass}" data-ui="type:Button;childName:okBtn;">确定</div><div class="${cancelBtnClass}" data-ui="type:Button;childName:cancelBtn;">取消</div></div><div data-ui="type:Button;childName:closeBtn;skin:layerClose;height:12;"></div>';return C.format(t,{bodyClass:e.helper.getPartClassName("body"),shortcutId:e.helper.getId("shortcut"),shortCutClass:e.helper.getPartClassName("shortcut"),shortCut:s(e),beginCalendar:l(e,"begin"),endCalendar:l(e,"end"),footClass:e.helper.getPartClassName("foot"),okBtnClass:e.helper.getPartClassName("okBtn"),cancelBtnClass:e.helper.getPartClassName("cancelBtn")})}function r(e){return S(e).startOf("day").toDate()}function a(e){return S(e).endOf("day").toDate()}function o(e,t){var i=e.range,n=t.getValue.call(e,e.now);if(r(i.begin)>r(i.begin)||a(n.end)<a(n.end))return!0;else return!1}function s(e){for(var t=e.shownShortCut.split(","),i={},n=0;n<t.length;n++)i[t[n]]=!0;for(var r='<span data-index="${shortIndex}" class="'+e.helper.getPartClassName("shortcut-item")+' ${shortClass}" id="${shortId}">${shortName}</span>',a=e.shortCutItems,s=a.length,l=[],u=0;s>u;u++){var c=a[u];if(i[c.name]){var f=c.name,d=[];if(0===u)d=d.concat(e.helper.getPartClasses("shortcut-item-first"));var h=o(e,c);if(h)d=d.concat(e.helper.getPartClasses("shortcut-item-disabled"));var p=e.helper.getId("shortcut-item"+u);l.push(C.format(r,{shortIndex:u,shortClass:d.join(" "),shortId:p,shortName:f}))}}return l.join("")}function l(e,t){var i="";if(e.endlessCheck&&"end"===t)i='<input type="checkbox" title="不限结束" data-ui-type="CheckBox" data-ui-child-name="endlessCheck" />';var n='<div class="${frameClass}"><div class="${labelClass}"><h3>${labelTitle}</h3>'+i+'</div><div class="${calClass}"><div data-ui="type:MonthView;childName:${calName}"></div></div></div>';return C.format(n,{frameClass:e.helper.getPartClassName(t),labelClass:e.helper.getPartClassName("label"),labelTitle:"begin"===t?"开始日期":"结束日期",titleId:e.helper.getId(t+"Label"),calClass:e.helper.getPartClassName(t+"-cal"),calName:t+"Cal"})}function u(e){var t,i=e.getChild("endCal"),n=e.helper.getPart("shortcut");if(this.isChecked())e.isEndless=!0,i.disable(),t=-1,e.view.end=null,e.helper.addPartClasses("shortcut-disabled",n);else e.isEndless=!1,i.enable(),g.apply(e,[i,"end"]),e.helper.removePartClasses("shortcut-disabled",n)}function c(e,t){if(!e&&t||e&&!t)return!1;else if(!e&&!t)return!0;return S(e).isSame(t,"day")}function f(e,t){for(var i=e.shortCutItems,n=i.length,r=0;n>r;r++){var a=i[r],o=a.getValue.call(e,e.now);if(c(t.begin,o.begin)&&c(t.end,o.end))return r}return-1}function d(e,t){var i=e,n=e.shortCutItems;if(!(0>t||t>=n.length)){var r=n[t].getValue.call(i,i.now),a=r.begin,o=r.end;e.view={begin:a,end:o},p(e,"begin",a),p(e,"end",o),h(i,t)}}function h(e,t){var i=e.shortCutItems,n=e.miniMode;if(null!==n&&n!==t)e.helper.removePartClasses("shortcut-item-selected",e.helper.getPart("shortcut-item"+n));if(e.miniMode=t,t>=0)e.helper.addPartClasses("shortcut-item-selected",e.helper.getPart("shortcut-item"+t)),e.curMiniName=i[t].name;else e.curMiniName=null}function p(e,t,i,n){var r=e.getChild(t+"Cal");if(r){if(n===!0)r.on("change",L.bind(g,e,r,t)),r.on("changemonth",L.bind(w,null,e));r.setProperties({rawValue:i,range:e.range})}}function m(e){if(!this.isEndless)for(var t=e.target||e.srcElement,i=this.helper.getPartClasses("shortcut-item"),n=this.helper.getPartClasses("shortcut-item-disabled");t&&t!==document.body;){if(C.hasClass(t,i[0])&&!C.hasClass(t,n[0])){var r=t.getAttribute("data-index");return void d(this,r)}t=t.parentNode}}function g(e,t){var i=e.getRawValue();if(i){this.view[t]=i;var n=f(this,this.view);h(this,n),w(this)}}function v(e){var t=e,i=e.view,n=i.begin,r=i.end;if(e.isEndless)r=null;var a=r-n;if(!r)a=n;var o;if(a>0)o={begin:n,end:r};else if(null!==r)o={begin:r,end:n};var s=t.fire("beforechange",{value:o});if(s.isDefaultPrevented())return!1;else return t.rawValue=o,t.value=t.convertToParam(o),y(t,o),t.layer.hide(),void t.fire("change",o)}function y(e,t){var i=e.helper.getPart("text");i.innerHTML=b(e,t)}function b(e,t){var i=x(e,t);if(e.isEndless&&i)return i;var n="";if(!e.curMiniName&&null!==e.miniMode&&e.miniMode>=0&&e.miniMode<e.shortCutItems.length)e.curMiniName=e.shortCutItems[e.miniMode].name;if(e.curMiniName)n=e.curMiniName+"&nbsp;&nbsp;";if(i)return n+i;else return""}function x(e,t){t=t||e.getRawValue();var i=t.begin,n=t.end,r=e.dateFormat;if(i&&n)return S(i).format(r)+" 至 "+S(n).format(r);else if(!n)return S(i).format(r)+" 起 ";return""}function w(e){function t(e,t){var n=new Date(e.year,e.month,1);n=S(n);for(var r=n.clone().endOf("month"),s=n;r>=s;){var l=!0;if("begin"===t&&(s<=S(a)||s>S(o)))l=!1;else if("end"===t&&(s<S(a)||s>=S(o)))l=!1;i(e,s.toDate(),l),s.add("day",1)}}function i(e,t,i){var n=e.getDateItemHTML(t);if(i)e.helper.addPartClasses("month-item-highlight",n);else e.helper.removePartClasses("month-item-highlight",n)}var n=e.getChild("beginCal"),r=e.getChild("endCal"),a=e.view.begin,o=e.view.end;t(n,"begin"),t(r,"end")}require("./Button"),require("./MonthView"),require("./CheckBox"),require("./Label");var C=require("./lib"),k=require("./InputControl"),_=require("./controlHelper"),T=require("./Layer"),M=require("./main"),S=require("moment"),L=require("underscore");return C.inherits(e,T),e.prototype.render=function(e){var i=this.control;document.body.appendChild(e),e.innerHTML=n(i),i.helper.initChildren(e),t(i,i.view,"render")},e.prototype.toggle=function(){var e=this.getElement();if(!e||this.control.helper.isPart(e,"layer-hidden")){var i=this.control;t(i,i.rawValue,"repaint"),this.show()}else this.hide()},i.prototype.convertToParam=function(e){var t=e.begin,i=e.end,n=" 00:00:00",r=" 23:59:59",a=[];if(a.push(S(t).format("YYYY-MM-DD")+n),i)a.push(S(i).format("YYYY-MM-DD")+r);return a.join(",")},i.prototype.convertToRaw=function(e){var t=e.split(",");if(1===t.length)t.push("2046-11-04");else if(""===t[0])t[0]="1983-09-03";else if(""===t[1])t[1]="2046-11-04";return{begin:S(t[0],"YYYY-MM-DD").toDate(),end:S(t[1],"YYYY-MM-DD").toDate()}},i.defaultProperties={dateFormat:"YYYY-MM-DD",endlessCheck:!1,shortCutItems:[{name:"昨天",value:0,getValue:function(){var e=new Date(this.now.getTime());return e.setDate(e.getDate()-1),{begin:e,end:e}}},{name:"最近7天",value:1,getValue:function(){var e=S(this.now);return{begin:e.clone().subtract("day",7).toDate(),end:e.clone().subtract("day",1).toDate()}}},{name:"上周",value:2,getValue:function(){var e=this.now,t=new Date(e.getTime()),i=new Date(e.getTime()),n=1;if(t.getDay()<n%7)t.setDate(t.getDate()-14+n-t.getDay());else t.setDate(t.getDate()-7-t.getDay()+n%7);return t.setHours(0,0,0,0),i.setFullYear(t.getFullYear(),t.getMonth(),t.getDate()+6),i.setHours(0,0,0,0),{begin:t,end:i}}},{name:"本月",value:3,getValue:function(){return{begin:S(this.now).startOf("month").toDate(),end:S(this.now).toDate()}}},{name:"上个月",value:4,getValue:function(){var e=S(this.now).subtract("month",1).startOf("month").toDate(),t=S(this.now).startOf("month").subtract("day",1).toDate();return{begin:e,end:t}}},{name:"上个季度",value:5,getValue:function(){var e=this.now,t=S(e).subtract("month",e.getMonth()%3+3).startOf("month").toDate(),i=S(e).subtract("month",e.getMonth()%3).startOf("month").subtract("day",1).toDate();return{begin:t,end:i}}}]},i.prototype.type="RangeCalendar",i.prototype.initOptions=function(e){var t=this.now,n={begin:t,end:t},r={range:{begin:new Date(1983,8,3),end:new Date(2046,10,4)},rawValue:n,view:L.clone(n),value:this.convertToParam(n),shownShortCut:"昨天,最近7天,上周,本月,上个月,上个季度"};if(C.extend(r,i.defaultProperties,e),_.extractValueFromInput(this,e),e.value)r.rawValue=this.convertToRaw(r.value),r.view={begin:r.rawValue.begin,end:r.rawValue.end},r.miniMode=null;else if(e.rawValue)r.miniMode=null;else if(!e.rawValue&&null!=e.miniMode){var a=r.shortCutItems[r.miniMode];if(a)r.rawValue=a.getValue.call(this,this.now),r.miniMode=parseInt(r.miniMode,10);else r.miniMode=null}if(e.range&&"string"==typeof e.range)r.range=this.convertToRaw(r.range);if("false"===e.endlessCheck)r.endlessCheck=!1;if(r.endlessCheck){if("false"===r.isEndless)r.isEndless=!1}else if(!r.rawValue.end)r.endlessCheck=!0,r.isEndless=!0;if(r.isEndless)r.endlessCheck=!0,r.rawValue.end=null,r.view.end=null,r.view.value=this.convertToParam({begin:t,end:null});this.setProperties(r)},i.prototype.initStructure=function(){if(C.isInput(this.main))_.replaceMain(this);var e=['<div class="${className}" id="${id}"></div>','<div class="${arrow}"></div>'];this.main.innerHTML=C.format(e.join("\n"),{className:this.helper.getPartClassName("text"),id:_.getId(this,"text"),arrow:this.helper.getPartClassName("arrow")})},i.prototype.initEvents=function(){this.helper.addDOMEvent(this.main,"mousedown",L.bind(this.layer.toggle,this.layer));
},i.prototype.repaint=_.createRepaint(k.prototype.repaint,{name:["rawValue","range"],paint:function(e,i,n){if(n){if("string"==typeof n)n=e.convertToRaw(n);if(!n.begin)n.begin=new Date(1983,8,3);else if(!n.end)n.end=new Date(2046,10,4);e.range=n}if(i)y(e,i);if(e.layer)t(e,i)}},{name:["disabled","hidden","readOnly"],paint:function(e,t,i,n){if(t||i||n)e.layer.hide()}},{name:"isEndless",paint:function(e,t){if(!e.endlessCheck)e.isEndless=!1;else{var i=e.getChild("endlessCheck");if(i)i.setChecked(t)}}}),i.prototype.setRawValue=function(e){this.setProperties({rawValue:e})},i.prototype.getRawValue=function(){return this.rawValue},i.prototype.stringifyValue=function(e){return this.convertToParam(e)||""},i.prototype.parseValue=function(e){return this.convertToRaw(e)},i.prototype.dispose=function(){if(!_.isInStage(this,"DISPOSED")){if(this.layer)this.layer.dispose(),this.layer=null;k.prototype.dispose.apply(this,arguments)}},C.inherits(i,k),M.register(i),i}),define("esui/Pager",["require","underscore","./lib","./main","./Control","./Select","./painters"],function(require){function e(e){var t=['<div id="${pagerWrapperId}" class="${pagerWrapperClass}">','<div id="${selectWrapperId}" ','class="${selectWrapperClass}">','<span id="${labelId}" class="${labelClass}">',"${labelText}</span>",'<div data-ui="type:Select;childName:select;','id:${selectId};width:25;"></div>',"</div>",'<ul id="${mainId}" class="${mainClass}"></ul>',"</div>"];return f.format(t.join(""),{pagerWrapperId:e.helper.getId("pager-wrapper"),pagerWrapperClass:e.helper.getPartClasses(e.layout)[0],selectWrapperId:e.helper.getId("select-wrapper"),selectWrapperClass:e.helper.getPartClassName("select-wrapper"),labelId:e.helper.getId("label"),labelClass:e.helper.getPartClassName("label"),labelText:"每页显示",selectId:e.helper.getId("select"),mainId:e.helper.getId("main"),mainClass:e.helper.getPartClassName("main")})}function t(e){function t(t){return f.format(e.urlTemplate,{page:t,pageSize:e.pageSize})}function i(i,n,r,a){var o={className:e.helper.getPartClassName(i)};if(arguments.length>1)o.link=t(n),o.id=e.helper.getId(r),o.page=n,o.text=a;return o}function n(t,i){if(!i){var n={anchor:o,plain:a};i=n[e.pageType]||n.anchor}return f.format(i,t)}function r(e,t){if("number"==typeof e)e=i("item",e,"page-"+e,e);var r=n(e,t);h.push(r)}var a='<li class="${className}" id="${id}" data-page="${page}">${text}</li>',o='<li class="${className}" id="${id}"><a href="${link}">${text}</a></li>',s='<li class="${className}">…</li>',l=e.page,u=e.backCount,c=e.forwardCount,d=Math.ceil(e.count/e.pageSize),h=[];if(l>1){var p=i("item-extend",l-1,"page-back",e.backText);r(p)}if(l>u+1)if(r(1),l>u+2){var p=i("item-omit");r(p,s)}for(var m=l>u?u:l-1,g=l-m;l>g;g++)r(g);var p=i("item-current",l,"page-"+l,l);r(p,a);for(var m=d-l>c?c:d-l,g=l+1;l+m+1>g;g++)r(g);if(d-c>l){if(d-c-1>l){var p=i("item-omit");r(p,s)}r(d)}if(d>l){var p=i("item-extend",l+1,"page-forward",e.forwardText);r(p)}return h.push(" 共"+e.count+"条记录"),h.join("")}function i(e){var i=e.pageSize;i=i>0?i:1,e.pageSize=i,e.getChild("select").set("value",i+"");var n=Math.ceil(e.count/i),r=e.page;r=r>n?n:r,r=r>0?r:1,e.page=r;var a=e.helper.getPart("main");a.innerHTML=t(e)}function n(e,t){function i(){for(var t=[],i=0,n=arguments.length;n>i;i++)t.push(e.helper.getPartClasses(arguments[i])[0]);return t}var n=e.helper.getPart("pager-wrapper");f.removeClasses(n,i("alignLeft","alignLeftReversed","alignRight","alignRightReversed","distributed","distributedReversed")),f.addClass(n,e.helper.getPartClasses(t)[0])}function r(e){var t=e.target,i=this.helper.getId("page-back"),n=this.helper.getId("page-forward"),r=this.page;if(this.helper.isPart(t,"item")||this.helper.isPart(t,"item-extend")){if(t.id===i)r--;else if(t.id===n)r++;else r=+f.getAttribute(t,"data-page");this.set("page",r)}}function a(e){var t=c.map(e,function(e){return{text:e+"",value:e+""}});return t}function o(e){var t=parseInt(this.getChild("select").getValue(),10);this.pageSize=t,i(this),this.fire("changepagesize"),this.fire("pagesizechange")}function s(e){var t=e.helper.getPart("select-wrapper");e.helper.removePartClasses("select-hidden",t)}function l(e){var t=e.helper.getPart("select-wrapper");e.helper.addPartClasses("select-hidden",t)}function u(e){h.apply(this,arguments)}var c=require("underscore"),f=require("./lib"),d=require("./main"),h=require("./Control");return require("./Select"),u.defaultProperties={},u.prototype={type:"Pager",defaultProperties:{pageSizes:[15,30,50,100],pageSize:15},initOptions:function(e){var t={pageType:"anchor",count:0,page:1,backCount:3,forwardCount:3,backText:"上一页",forwardText:"下一页",urlTemplate:"",layout:"alignLeft"};c.extend(t,this.defaultProperties,u.defaultProperties,e),this.setProperties(t)},initStructure:function(){this.main.innerHTML=e(this),this.helper.initChildren();var t=this.getChild("select");if(!this.pageSizes||!this.pageSizes.length)l(this);else{var i={datasource:a(this.pageSizes),value:this.pageSize+""};t.setProperties(i)}o.call(this)},initEvents:function(){var e=this.getChild("select");e.on("change",o,this),this.helper.addDOMEvent("main","click",r)},setProperties:function(e){if(e=c.clone(e),e.hasOwnProperty("pageIndex")&&!e.hasOwnProperty("page"))e.page=+e.pageIndex+1;var t=["count","page","backCount","forwardCount","pageSize"];c.each(t,function(t){var i=e[t];if(c.isString(i))e[t]=+i});var i=h.prototype.setProperties.apply(this,arguments);if(i.hasOwnProperty("page"))this.fire("changepage"),this.fire("pagechange")},repaint:require("./painters").createRepaint(h.prototype.repaint,{name:"pageSizes",paint:function(e,t){var i=e.getChild("select");if(!t||!t.length)l(e);else{var n={datasource:a(t),value:e.pageSize+""};i.setProperties(n),s(e)}}},{name:"layout",paint:n},{name:["pageType","count","pageSize","page","backCount","forwardCount","backText","forwardText","urlTemplate"],paint:i}),getPageIndex:function(){return this.get("page")-1}},f.inherits(u,h),d.register(u),u}),define("esui/Overlay",["require","./lib","./main","./Panel","underscore","./painters"],function(require){function e(e){g.apply(this,arguments)}function t(e){var t=e.target,i=this.main;if(i){var n=p.dom.contains(i,t);if(!n)this.hide()}}function i(){var e=this.attachedTarget,t=this.attachedLayout;if(null!=e){if(v.isString(t))t=t.split(",");this.attachLayout(e,t)}else{var i=v.pick(this,"left","right","top","bottom","width","height");this.selfLayout(i)}}function n(e,t){if(e)return p.g(e);else if(t){if(v.isString(t))t=this.viewContext.get(t)||{};return t.main}return null}function r(e){var t=this.main,i=p.clone(e||{});if(v.isArray(i.align))p.addClass(t,this.helper.getPartClasses(i.align.join("-")));i=v.omit(i,"align"),t.style.top="",t.style.bottom="",t.style.left="",t.style.right="",v.each(i,function(e,i){if(!a(e))t.style[i]=e+"px"})}function a(e,t){if(t){if(!e.hasOwnProperty(t))return!0;e=e[t]}return null==e||0!==e&&""===p.trim(e)}function o(e,t){var i=p.getStyle(e,t);return parseInt(i,10)||0}function s(e,t){var i=e.page.width-e.target.viewRight,n=e.target.viewLeft,r=e.target.viewBottom,a=e.page.height-e.target.viewTop,o={};if(i>=e.layer.width)o.right=!0;if(n>=e.layer.width)o.left=!0;if(r>=e.layer.height)o.bottom=!0;if(a>=e.layer.height)o.top=!0;var s={right:e.target.layoutRight,left:e.target.layoutLeft-e.layer.width,bottom:e.target.layoutBottom-e.layer.height,top:e.target.layoutTop,center:e.target.layoutTop-1*(e.layer.height-e.target.height)/2},l={align:[]};if(o[t[0]]===!0)l.left=s[t[0]],l.align.push(t[0]);else l.left=s.right,l.align.push("right");if("center"===t[1])l.top=s.center,l.align.push("center");else if(o[t[1]]===!0)l.top=s[t[1]],l.align.push(t[1]);else l.top=s.top,l.align.push("top");return l}function l(e,t){var i=e.target.viewRight,n=e.page.width-e.target.viewLeft,r=e.target.viewTop,a=e.page.height-e.target.viewBottom,o={};if(i>=e.layer.width)o.right=!0;if(n>=e.layer.width)o.left=!0;if(a>=e.layer.height)o.bottom=!0;if(r>=e.layer.height)o.top=!0;var s={right:e.target.layoutRight-e.layer.width,left:e.target.layoutLeft,center:e.target.layoutLeft-1*(e.layer.width-e.target.width)/2,bottom:e.target.layoutBottom,top:e.target.layoutTop-e.layer.height},l={align:[]};if(o[t[0]]===!0)l.top=s[t[0]],l.align.push(t[0]);else l.top=s.bottom,l.align.push("bottom");if("center"===t[1])l.left=s.center,l.align.push("center");else if(o[t[1]]===!0)l.left=s[t[1]],l.align.push(t[1]);else l.left=s.left,l.align.push("left");return l}function u(){if(!this.isHidden())i.apply(this)}function c(e){var t=document.createElement("div");t.id=e,document.body.appendChild(t)}function f(){var e="ctrl-mask-"+this.helper.getId(),t=p.g(e);if(!t)c(e);return p.g(e)}function d(){var e=f.call(this),t=this.helper.getPartClassName("mask");e.className=t,e.style.display="block"}function h(){var e=f.call(this);if("undefined"!=typeof e)p.removeNode(e)}var p=require("./lib"),m=require("./main"),g=require("./Panel"),v=require("underscore");return p.inherits(e,g),e.prototype.type="Overlay",e.prototype.parseMain=function(e){var t=e.main;if(t){for(var i,n=p.getChildren(t),r=n.length,a={};r--;)if(i=n[r].getAttribute("data-role"))a[i]=n[r];e.roles=a}},e.prototype.initOptions=function(e){var t={fixed:!1,autoClose:!0,hasMask:!1},i=["fixed","autoClose","hasMask"];v.each(i,function(t){if("false"===e[t])e[t]=!1}),v.extend(t,e),g.prototype.initOptions.call(this,t)},e.prototype.initStructure=function(){var e=this.main;if(e.parentNode&&"body"!==e.parentNode.nodeName.toLowerCase())document.body.appendChild(e);this.addState("hidden"),g.prototype.initStructure.apply(this,arguments)},e.prototype.repaint=require("./painters").createRepaint(g.prototype.repaint,{name:["height","width"],paint:function(e,t,n){if(!a(t))if("auto"===t)e.main.style.width="auto";else e.main.style.width=t+"px";if(!a(n))if("auto"===n)e.main.style.height="auto";else e.main.style.height=n+"px";if(!e.isHidden())i.apply(e)}},{name:["attachedDOM","attachedControl"],paint:function(e,t,i){var r=n.call(e,t,i);e.attachedTarget=r}}),e.prototype.show=function(){if(this.helper.isInStage("INITED"))this.render();else if(this.helper.isInStage("DISPOSED"))return;if(this.autoClose)this.helper.addDOMEvent(document,"mousedown",t);if(this.fixed)this.helper.addDOMEvent(window,"resize",u),this.helper.addDOMEvent(window,"scroll",u);if(this.removeState("hidden"),this.hasMask)d.call(this);this.moveToTop(),i.apply(this),this.fire("show")},e.prototype.hide=function(){if(!this.isHidden()){if(this.autoClose)this.helper.removeDOMEvent(document,"mousedown",t);if(this.helper.removeDOMEvent(window,"resize",u),this.helper.removeDOMEvent(window,"scroll",u),this.addState("hidden"),this.hasMask)h.call(this)}this.fire("hide")},e.prototype.moveToTop=function(){var e=this.getZIndex();this.main.style.zIndex=e;var t=f.call(this);if(t)t.style.zIndex=e-1},e.prototype.getZIndex=function(){for(var e=this.helper.getPrimaryClassName(),t=this.helper.getPrimaryClassName("hidden"),i=1203,n=p.getChildren(document.body),r=0,a=n.length;a>r;r++)if(p.hasClass(n[r],e)&&!p.hasClass(n[r],t))i=Math.max(i,n[r].style.zIndex)+10;return i},e.prototype.selfLayout=function(e){var t=p.page,i=this.main,n=p.clone(e||{}),s=p.getOffset(i);if(a(n,"left")&&a(n,"right"))n.left=(t.getViewWidth()-s.width)/2;else if(!a(n,"left")&&!a(n,"right")){if(a(n,"width"))n.width=t.getViewWidth()-n.right-n.left-o(this.main,"padding-left")-o(this.main,"padding-right")-o(this.main,"border-left-width")-o(this.main,"border-right-width");n=v.omit(n,"right")}if(n.left=Math.max(n.left,0),n.left=t.getScrollLeft()+n.left,a(n,"top")&&a(n,"bottom"))n.top=(t.getViewHeight()-s.height)/2;else if(!a(n,"top")&&!a(n,"bottom")){if(a(n,"height"))n.height=t.getViewHeight()-n.top-n.bottom-o(this.main,"padding-top")-o(this.main,"padding-bottom")-o(this.main,"border-top-width")-o(this.main,"border-bottom-width");n=v.omit(n,"bottom")}n.top=Math.max(n.top,0),n.top=t.getScrollTop()+n.top,r.call(this,n)},e.prototype.attachLayout=function(e,t){var i=this.main;t=t||["bottom","left"];var n={width:p.page.getViewWidth(),height:p.page.getViewHeight(),scrollTop:p.page.getScrollTop(),scrollLeft:p.page.getScrollLeft()},a=e.getBoundingClientRect(),o=p.getOffset(e),u={layoutLeft:o.left,viewLeft:a.left,layoutTop:o.top,viewTop:a.top,layoutRight:o.right,viewRight:a.right,layoutBottom:o.bottom,viewBottom:a.bottom,width:o.width,height:o.height};if(this.strictWidth)i.style.minWidth=o.width+"px";var c=i.style.display;i.style.display="block",i.style.top="-5000px",i.style.left="-5000px";var f=p.getOffset(i);i.style.top="",i.style.left="",i.style.display=c;var d,h={target:u,layer:f,page:n};if("right"===t[0]||"left"===t[0])d=s(h,t);else d=l(h,t);r.call(this,d)},e.prototype.moveTo=function(e,t){this.selfLayout({top:e,left:t})},e.prototype.resize=function(){i.apply(this)},e.prototype.dispose=function(){if(!this.helper.isInStage("DISPOSED"))p.removeNode("ctrl-mask-"+this.helper.getId()),p.removeNode(this.main),g.prototype.dispose.apply(this,arguments)},m.register(e),e}),define("esui/Link",["require","underscore","./lib","./Control","./painters","./main"],function(require){function e(){n.apply(this,arguments)}var t=require("underscore"),i=require("./lib"),n=require("./Control"),r=require("./painters");return e.prototype={constructor:e,type:"Link",getCategory:function(){return"container"},createMain:function(){return document.createElement("a")},initOptions:function(e){var i={};if(t.extend(i,e),null==i.href)i.href=this.main.href;if(null==i.target)i.target=this.main.target;if(null==i.content)i.content=this.main.innerHTML;t.extend(this,i)},initEvents:function(){this.helper.delegateDOMEvent(this.main,"click")},render:function(){if(this.main&&"a"===this.main.nodeName.toLowerCase())n.prototype.render.apply(this,arguments)},repaint:r.createRepaint(n.prototype.repaint,r.attribute("href"),r.attribute("target"),{name:"content",paint:function(e,t){e.helper.disposeChildren(),e.main.innerHTML=t,e.helper.initChildren()}})},i.inherits(e,n),require("./main").register(e),e}),define("mini-event/lib",["require"],function(require){var e={};return e.extend=function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];if(i){for(var n in i)if(i.hasOwnProperty(n))e[n]=i[n]}else;}return e},e}),define("mini-event/EventTarget",["require","./lib","./Event","./EventQueue"],function(require){function e(){}var t=require("./lib"),i=require("./Event"),n=require("./EventQueue");return e.prototype.on=function(e,i,r,a){if(!this.miniEventPool)this.miniEventPool={};if(!this.miniEventPool.hasOwnProperty(e))this.miniEventPool[e]=new n;var o=this.miniEventPool[e];if(a=t.extend({},a),r)a.thisObject=r;o.add(i,a)},e.prototype.once=function(e,i,n,r){r=t.extend({},r),r.once=!0,this.on(e,i,n,r)},e.prototype.un=function(e,t,i){if(this.miniEventPool&&this.miniEventPool.hasOwnProperty(e)){var n=this.miniEventPool[e];n.remove(t,i)}},e.prototype.fire=function(e,t){if(1===arguments.length&&"object"==typeof e)t=e,e=t.type;if(!e)throw new Error("No event type specified");if("*"===e)throw new Error("Cannot fire global event");var n=t instanceof i?t:new i(e,t);n.target=this;var r=this["on"+e];if("function"==typeof r)r.call(this,n);if(this.miniEventPool&&this.miniEventPool.hasOwnProperty(e)){var a=this.miniEventPool[e];a.execute(n,this)}if(this.miniEventPool&&this.miniEventPool.hasOwnProperty("*")){var o=this.miniEventPool["*"];o.execute(n,this)}return n},e.prototype.destroyEvents=function(){if(this.miniEventPool){for(var e in this.miniEventPool)if(this.miniEventPool.hasOwnProperty(e))this.miniEventPool[e].dispose();this.miniEventPool=null}},e.enable=function(i){i.miniEventPool={},t.extend(i,e.prototype)},e}),define("esui/Layer",["require","underscore","./lib","./main","mini-event/EventTarget"],function(require){function e(e){this.control=e}function t(e){var t=e.target,i=this.getElement(this),n=this.control.main;if(i){for(;t&&t!==i&&t!==n;)t=t.parentNode;if(t!==i&&t!==n)this.hide()}}function i(e){var t=e.control.helper.getPartClasses("layer-hidden");return t.unshift(o.getConfig("uiClassPrefix")+"-layer-hidden"),t}function n(e,t){var i=a.clone(t||{});if(i.hasOwnProperty("top")&&i.hasOwnProperty("bottom"))i.height=i.bottom-i.top,delete i.bottom;if(i.hasOwnProperty("left")&&i.hasOwnProperty("right"))i.width=i.right-i.left,delete i.right;if(i.hasOwnProperty("top")||i.hasOwnProperty("bottom"))e.style.top="",e.style.bottom="";if(i.hasOwnProperty("left")||i.hasOwnProperty("right"))e.style.left="",e.style.right="";for(var n in i)if(i.hasOwnProperty(n))e.style[n]=i[n]+"px"}var r=require("underscore"),a=require("./lib"),o=require("./main");e.prototype.nodeName="div",e.prototype.autoHide=!0,e.prototype.enableAutoHide=function(e){var t="onwheel"in document.body?"wheel":"mousewheel";this.control.helper.addDOMEvent(document.documentElement,t,r.bind(this.hide,this)),this.control.helper.addDOMEvent(e,t,function(e){e.stopPropagation()})},e.prototype.create=function(){var e=this.control.helper.createPart("layer",this.nodeName);if(a.addClass(e,o.getConfig("uiClassPrefix")+"-layer"),this.autoHide)this.enableAutoHide(e);return e},e.prototype.addCustomClasses=function(e){var t=this.getElement();a.addClasses(t,e)},e.prototype.render=function(e){},e.prototype.syncState=function(e){},e.prototype.repaint=function(){var e=this.getElement(!1);if(e)this.render(e)},e.prototype.initBehavior=function(e){},e.prototype.getElement=function(e){var n=this.control.helper.getPart("layer");if(!n&&e!==!1){if(n=this.create(),this.render(n),a.addClasses(n,i(this)),this.initBehavior(n),this.control.helper.addDOMEvent(document,"mousedown",r.bind(t,this)),this.control.helper.addDOMEvent(n,"mousedown",function(e){e.stopPropagation()}),this.syncState(n),!n.parentElement)document.body.appendChild(n);this.fire("rendered")}return n},e.prototype.hide=function(){var e=i(this),t=this.getElement();a.addClasses(t,e),this.control.removeState("active"),this.fire("hide")},e.prototype.show=function(){var e=this.getElement();e.style.zIndex=this.getZIndex(),this.position();var t=i(this);a.removeClasses(e,t),this.control.addState("active"),this.fire("show")},e.prototype.toggle=function(){var e=this.getElement();if(!e||this.control.helper.isPart(e,"layer-hidden"))this.show();else this.hide()},e.prototype.position=function(){var t=this.getElement();e.attachTo(t,this.control.main,this.dock)},e.prototype.getZIndex=function(){return e.getZIndex(this.control.main)},e.prototype.dispose=function(){var e=this.getElement(!1);if(e)e.innerHTML="",a.removeNode(e);this.control=null};var s=1e3;e.create=function(e){var t=document.createElement(e||"div");return t.style.position="absolute",t},e.getZIndex=function(e){for(var t=0;!t&&e&&e!==document;)t=parseInt(a.getComputedStyle(e,"zIndex"),10),e=e.parentNode;return t=t||0,t+1},e.moveToTop=function(e){e.style.zIndex=++s},e.moveTo=function(e,t,i){n(e,{top:t,left:i})},e.resize=function(e,t,i){n(e,{width:t,height:i})},e.attachTo=function(e,t,i){i=i||{strictWidth:!1};var r=a.page.getViewWidth(),o=a.page.getViewHeight(),s=a.page.getScrollTop(),l=a.page.getScrollLeft(),u=a.getOffset(t),c=e.style.display;if(e.style.display="block",e.style.top="-5000px",e.style.left="-5000px",i.strictWidth)e.style.minWidth=u.width+"px";var f=a.getOffset(e);e.style.top="",e.style.left="",e.style.display=c;var d={},h=o-(u.bottom-s),p=u.top-s;if(h<=f.height&&p>f.height)d.top=u.top-f.height;else d.top=u.bottom;var m=r-(u.left-l),g=u.right-l;if(m<=f.width&&g>f.width)d.left=u.right-f.width;else d.left=u.left;n(e,d)},e.centerToView=function(e,t){var i=t?a.clone(t):{};if("number"!=typeof i.width)i.width=this.width;if("number"!=typeof i.height)i.height=this.height;i.left=(a.page.getViewWidth()-i.width)/2;var n=a.page.getViewHeight();if(i.height>=n&&t.hasOwnProperty("minTop"))i.top=t.minTop;else i.top=Math.floor((n-i.height)/2);var r=a.page.getViewWidth();if(i.height>=r&&t.hasOwnProperty("minLeft"))i.left=t.minLeft;else i.left=Math.floor((r-i.width)/2);i.top+=a.page.getScrollTop(),this.setProperties(i)};var l=require("mini-event/EventTarget");return a.inherits(e,l),e}),define("esui/Label",["require","underscore","./lib","./Control","./painters","./main"],function(require){function e(e){n.apply(this,arguments)}var t=require("underscore"),i=require("./lib"),n=require("./Control");e.prototype.type="Label",e.prototype.createMain=function(e){if(!e.tagName)return n.prototype.createMain.call(this);else return document.createElement(e.tagName)},e.prototype.initOptions=function(e){var n={title:""};if(t.extend(n,e),n.tagName=this.main.nodeName.toLowerCase(),null==n.text)n.text=i.trim(i.getText(this.main));t.extend(this,n)},e.prototype.initEvents=function(){this.helper.delegateDOMEvent(this.main,"click")};var r=require("./painters");return e.prototype.repaint=r.createRepaint(n.prototype.repaint,r.attribute("title"),r.text("text"),{name:"forTarget",paint:function(e,t){if("label"===e.main.nodeName.toLowerCase())e.helper.addDOMEvent(e.main,"mousedown",function n(){var e=this.viewContext.get(t),r=e&&"function"==typeof e.getFocusTarget&&e.getFocusTarget();if(r&&r.id)i.setAttribute(this.main,"for",r.id);this.helper.removeDOMEvent(this.main,"mousedown",n)})}}),e.prototype.setText=function(e){this.setProperties({text:e})},e.prototype.getText=function(){return this.text},e.prototype.setTitle=function(e){this.setProperties({title:e})},e.prototype.getTitle=function(){return this.title},i.inherits(e,n),require("./main").register(e),e}),define("esui/main",["require","./lib","./ViewContext","./ControlCollection"],function(require){function e(e,t){if("function"==typeof e){var i=e.prototype.type;if(i in t)throw new Error(i+" is exists!");t[i]=e}}function t(e,t,i){var n=i[e];if(n)return delete t.type,new n(t);else return null}var i=require("./lib"),n={};n.version="3.1.0";var r=require("./ViewContext"),a=new r("default");n.getViewContext=function(){return a};var o={uiPrefix:"data-ui",extensionPrefix:"data-ui-extension",customElementPrefix:"esui",instanceAttr:"data-ctrl-id",viewContextAttr:"data-ctrl-view-context",uiClassPrefix:"ui",skinClassPrefix:"skin",stateClassPrefix:"state"};n.config=function(e){i.extend(o,e)},n.getConfig=function(e){return o[e]},n.parseAttribute=function(e,t){if(!e)return{};for(var n={},r=0,a=0;a<e.length;){for(;a<e.length&&":"!==e.charAt(a);)a++;if(a>=e.length)break;var o=i.trim(e.slice(r,a));for(a++,r=a;a<e.length&&";"!==e.charAt(a);)a++;for(var s=a+1;s<e.length;){var l=e.charAt(s);if(";"===l)a=s;if(":"===l)break;s++}var u=i.trim(e.slice(r,a));n[o]=t?t(u):u,a++,r=a}return n},n.getControlByDOM=function(e){if(!e)return null;var t,i=n.getConfig,a=e.getAttribute(i("instanceAttr")),o=e.getAttribute(i("viewContextAttr"));if(a&&o&&(t=r.get(o)))return t.get(a);else return null};var s={};n.register=function(t){e(t,s)},n.create=function(e,i){return t(e,i,s)},n.get=function(e){return a.get(e)},n.getSafely=function(e){return a.getSafely(e)};var l=require("./ControlCollection");n.wrap=function(){for(var e=new l,t=0;t<arguments.length;t++)e.add(arguments[t]);return e},n.init=function(e,t){function i(e){function t(e){return e.toUpperCase()}for(var i=1,n=e.length;n>i;i++)e[i]=e[i].replace(/^[a-z]/,t);return e.join("")}function r(e,t){for(var i in t)if(!(i in e))e[i]=t[i]}function a(e,t,a){if(0===t.length)r(e,n.parseAttribute(a,s));else e[i(t)]=s(a)}e=e||document.body,t=t||{};for(var s=t.valueReplacer||function(e){return e},l=e.getElementsByTagName("*"),u=[],c=0,f=l.length;f>c;c++)if(1===l[c].nodeType)u.push(l[c]);for(var d=n.getConfig("uiPrefix"),h=n.getConfig("extensionPrefix"),p=n.getConfig("customElementPrefix"),m=d.length,g=h.length,v=t.properties||{},y=[],c=0,f=u.length;f>c;c++){var b=u[c];if(!b.getAttribute(o.instanceAttr)){for(var x=b.attributes,w={},C={},k=0,_=x.length;_>k;k++){var T=x[k],M=T.name,S=T.value;if(0===M.indexOf(h)){var L=M.slice(g+1).split("-"),D=L[0];L.shift();var P=C[D];if(!P)P=C[D]={};a(P,L,S)}else if(0===M.indexOf(d)){var L=M.length===m?[]:M.slice(m+1).split("-");a(w,L,S)}}var A=w.type;if(!A){var E=b.nodeName.toLowerCase(),I=E.indexOf(p);if(0===I){var O;O=E.replace(/-(\S)/g,function(e,t){return t.toUpperCase()}),O=O.slice(p.length),w.type=O,A=O}}if(A){var N=w.id,R=N?v[N]:{};for(var H in R)w[H]=s(R[H]);var Y=w.extensions||[];w.extensions=Y;for(var H in C){var P=C[H],j=n.createExtension(P.type,P);j&&Y.push(j)}w.viewContext=t.viewContext,w.renderOptions=t,w.main=b;var z=n.create(A,w);if(z){if(y.push(z),t.parent)t.parent.addChild(z);try{z.render()}catch(B){var F=new Error('Render control "'+(z.id||"anonymous")+'" of type '+z.type+" failed because: "+B.message);throw F.actualError=B,F}}}}else;}return y};var u={};n.registerExtension=function(t){e(t,u)},n.createExtension=function(e,i){return t(e,i,u)};var c={};n.attachExtension=function(e,t){c[e]=t},n.createGlobalExtensions=function(){var e=[];for(var t in c)if(c.hasOwnProperty(t)){var i=n.createExtension(t,c[t]);i&&e.push(i)}return e};var f=[];return n.registerRule=function(e,t){f.push({type:e,priority:t}),f.sort(function(e,t){return e.priority-t.priority})},n.createRulesByControl=function(e){for(var t=[],i=0;i<f.length;i++){var n=f[i].type;if(null!=e.get(n.prototype.type))t.push(new n)}return t},n}),define("esui",["esui/main"],function(e){return e}),define("esui/Frame",["require","esui/lib","esui/Control","esui/painters","esui"],function(require){function e(e){i.apply(this,arguments)}var t=require("esui/lib"),i=require("esui/Control");e.prototype.type="Frame",e.prototype.createMain=function(){return document.createElement("iframe")},e.prototype.initOptions=function(e){var i={};if(t.extend(i,e),!i.src)i.src=this.main.src;this.setProperties(i)},e.prototype.initStructure=function(){this.main.frameborder="no",this.main.marginHeight="0",this.main.marginWeight="0"},e.prototype.initEvents=function(){this.helper.delegateDOMEvent(this.main,"load"),this.helper.addDOMEvent(this.main,"message",function(e){var t={origin:e.origin,data:e.data};this.fire("message",t)})};var n=require("esui/painters");return e.prototype.repaint=n.createRepaint(i.prototype.repaint,{name:"src",paint:function(e,t){if(e.main.src!==t)e.main.src=t}},n.style("height"),n.style("width")),e.prototype.callContentMethod=function(e){var t=[].slice.call(arguments,1),i=this.main.contentWindow;if(!i)throw new Error("No content window on this iframe");if("function"!=typeof i[e])throw new Error('No "'+e+'" method on window');return i[e].apply(i,t)},e.prototype.postMessage=function(e,t){var i=this.main.contentWindow;if(!i)throw new Error("No content window on this iframe");if("function"!=typeof i.postMessage)throw new Error("Current browser does not support postMessage");i.postMessage(e,t)},t.inherits(e,i),require("esui").register(e),e}),define("esui/Form",["require","underscore","./lib","./main","./Panel"],function(require){function e(e){this.length=e.length;for(var t=0;t<e.length;t++)this[t]=e[t]}function t(e,t){for(var i={},n=0;n<e.length;n++){var r=e[n];if("check"!==r.getCategory()||r.isChecked())if(!r.isDisabled()){var a=r.get("name"),o=t(r);if(i.hasOwnProperty(a))i[a]=[].concat(i[a],o);else i[a]=o}else;else;}return i}function i(e){s.apply(this,arguments)}function n(e){var t=e.getCategory();return"input"===t||"check"===t}var r=require("underscore"),a=require("./lib"),o=require("./main"),s=require("./Panel");return e.prototype.splice=Array.prototype.splice,e.prototype.getData=function(){return t(this,function(e){return e.getRawValue()})},e.prototype.getDataAsString=function(){var e=t(this,function(e){var t=e.getValue();return encodeURIComponent(t)}),i="";return r.each(e,function(e,t){i+=encodeURIComponent(t)+"="+e}),i},e.prototype.getValueAsString=function(e){var t=this.getData(),i=t[e],n=i?"string"==typeof i?i:i.join(","):"";return n},e.prototype.checkAll=function(){for(var e=0;e<this.length;e++){var t=this[e];if("check"===t.getCategory())t.setChecked(!0)}},e.prototype.uncheckAll=function(){for(var e=0;e<this.length;e++){var t=this[e];if("check"===t.getCategory())t.setChecked(!1)}},e.prototype.checkInverse=function(){for(var e=0;e<this.length;e++){var t=this[e];if("check"===t.getCategory())t.setChecked(!t.isChecked())}},e.prototype.checkByValue=function(e){for(var t=a.toDictionary(e),i=0;i<this.length;i++){var n=this[i];if("check"===n.getCategory()){var r=t.hasOwnProperty(n.getValue());n.setChecked(r)}}},i.defaultProperties={autoValidate:!1},i.prototype.type="Form",i.prototype.validateAndSubmit=function(){var e=this.fire("beforevalidate");if(!e.isDefaultPrevented())try{var t=this.get("autoValidate")?this.validate():!0,i=this.fire("aftervalidate",{isValid:t});if(i.isDefaultPrevented())return;var n={triggerSource:this};if(t)this.fire("submit",n);else this.fire("invalid",n)}catch(r){this.fire("submitfail",{error:r})}},i.prototype.initEvents=function(){if("form"===this.main.nodeName.toLowerCase())this.helper.addDOMEvent(this.main,"submit",function(e){return this.validateAndSubmit(),e.preventDefault(),!1})},i.prototype.createMain=function(e){var t=document.createElement("form");return t.method="POST",t.action=e.action||"",t},i.prototype.initOptions=function(e){var t=r.extend({},i.defaultProperties,e);if("form"===this.main.nodeName.toLowerCase())t.action=this.main.getAttribute("action"),t.method=this.main.getAttribute("method");else t.method=this.method||"POST";if("false"===e.autoValidate)t.autoValidate=!1;else t.autoValidate=!!t.autoValidate;s.prototype.initOptions.call(this,t)},i.prototype.getInputControls=function(t,i){function r(e,s){for(var l=s.children,u=l.length,c=0;u>c;c++){var f=l[c];if(1===f.nodeType){var d=o.getControlByDOM(f);if(d&&n(d)&&d.viewContext===e.viewContext&&d.get("name")&&(!t||d.get("name")===t)&&(!i||d.get("type")===i))a.push(d);else r(e,f)}else;}}var a=[];return r(this,this.main),new e(a)},i.prototype.getData=function(){var e=this.getInputControls();return e.getData()},i.prototype.getDataAsString=function(){var e=this.getInputControls();return e.getDataAsString()},i.prototype.validate=function(){for(var e=this.getInputControls(),t=!0,i=0;i<e.length;i++){var n=e[i];if(!n.isDisabled())t&=n.validate();else;}return!!t},i.prototype.repaint=function(e,t){s.prototype.repaint.apply(this,arguments);var i=!1;if(!t&&this.submitButton)i=!0;if(t&&t.hasOwnProperty("submitButton")){var n=t.submitButton;if(n.oldValue){for(var r=0;r<n.oldValue.length;r++){var a=this.viewContext.get(n.oldValue[r]);if(a)a.un("click",this.validateAndSubmit,this),a.un("click",!1)}i=!!this.submitButton}}if(i)for(var o=0;o<this.submitButton.length;o++){var l=this.viewContext.get(this.submitButton[o]);if(l)l.on("click",this.validateAndSubmit,this),l.on("click",!1)}},i.prototype.setProperties=function(e){if(e=r.clone(e),e.hasOwnProperty("submitButton"))e.submitButton=a.splitTokenList(e.submitButton);s.prototype.setProperties.call(this,e)},a.inherits(i,s),o.register(i),i}),define("esui/Extension",["require","./lib"],function(require){function e(e){t.extend(this,e)}var t=require("./lib");return e.prototype.target=null,e.prototype.active=!1,e.prototype.isActive=function(){return this.active},e.prototype.activate=function(){this.active=!0},e.prototype.inactivate=function(){this.active=!1},e.prototype.attachTo=function(e){if(this.target&&this.target!==e)if(this.active)this.inactivate();if(this.target=e,!this.active)this.activate()},e.prototype.dispose=function(){if(this.active)this.inactivate();this.target=null},e}),define("esui/Panel",["require","underscore","./lib","./Control","./painters","./main"],function(require){function e(){a.apply(this,arguments)}function t(e,t){var i=this.main,r=document.createElement("div");r.innerHTML=e;for(var a=n.extend({},this.renderOptions,{viewContext:this.viewContext,parent:this}),o=r.childNodes,s=[],l=0;l<o.length;l++)s.push(o[l]);var u=require("./main");n.each(s,function(e){if(t)i.insertBefore(e,i.firstChild);else i.appendChild(e);u.init(i,a)})}function i(e){if(e.indexOf("-")>=0)e=e.replace(/-\w/g,function(e){return e.charAt(1).toUpperCase()});return e}var n=require("underscore"),r=require("./lib"),a=require("./Control");return e.prototype.type="Panel",e.prototype.getCategory=function(){return"container"},e.prototype.createMain=function(e){if(!e.tagName)return a.prototype.createMain.call(this);else return document.createElement(e.tagName);
},e.prototype.initOptions=function(e){var t={};n.extend(t,e),t.tagName=this.main.nodeName.toLowerCase(),this.setProperties(t)},e.prototype.repaint=require("./painters").createRepaint(a.prototype.repaint,{name:"content",paint:function(e,t){if(null!=t)e.helper.disposeChildren(),e.main.innerHTML=t;e.helper.initChildren()}}),e.prototype.setContent=function(e){this.setProperties({content:e})},e.prototype.prependContent=function(e){t.call(this,e,!0)},e.prototype.appendContent=function(e){t.call(this,e,!1)},e.prototype.getStyle=function(e){return e=i(e),this.main?this.main.style[e]:""},e.prototype.setStyle=function(e,t){if(e=i(e),this.main)this.main.style[e]=t||""},r.inherits(e,a),require("./main").register(e),e}),define("esui/Dialog",["require","./Button","./Panel","./lib","./controlHelper","./Control","./main"],function(require){function e(e){v.apply(this,arguments)}function t(e){var t=e.main;if(t){for(var i,n=m.getChildren(t),r=n.length,a={};r--;)if(i=n[r].getAttribute("data-role"))a[i]=n[r];e.roles=a}}function i(e,t){var i="title",n="close-icon",r='<div class="${clsClass}" id="${clsId}">&nbsp;</div>',a="";if(e.closeButton)a=m.format(r,{clsId:g.getId(e,n),clsClass:g.getPartClasses(e,n).join(" ")});var o='<div id="${titleId}" class="${titleClass}"></div>${closeIcon}',s=[].concat(g.getPartClasses(e,"head")),l={titleId:g.getId(e,i),titleClass:g.getPartClasses(e,i).join(" "),closeIcon:a},u=m.format(o,l);if(t)e.title=t.innerHTML;else if(t=document.createElement("div"),e.main.firstChild)m.insertBefore(t,e.main.firstChild);else e.main.appendChild(t);t.innerHTML=u,m.addClasses(t,s);var c={main:t,renderOptions:e.renderOptions},f=y.create("Panel",c);return f.render(),e.addChild(f,"head"),f}function n(){var e=this.fire("beforeclose");if(e.isDefaultPrevented())return!1;if(this.hide(),this.fire("close"),this.closeOnHide)this.dispose()}function r(){var e=m.page,t=this.main,i=this.left,n=this.top,r=this.right,a=this.bottom;if(void 0===i||null===i)i=(e.getViewWidth()-t.offsetWidth)/2;if(0>i)i=0;if(void 0===n||null===n)n=(e.getViewHeight()-t.offsetHeight)/2;if(n=Math.max(n,0),t.style.left=i+"px",t.style.top=e.getScrollTop()+n+"px",void 0!==r&&null!==r)t.style.right=r+"px";if(void 0!==a&&null!==a)t.style.bottom=a+"px";if("auto"===this.height){var o=e.getViewHeight()-n;t.style.height=o+"px";var s=this.getBody().main,l=this.getHead().main,u=parseInt(m.getStyle(l,"height"),10);s.style.height=o-u+"px"}}function a(e,t){var i=e,n=e.getChild("head").main;if(t===!0)g.removeDOMEvent(i,n,"mousedown",s);else g.addDOMEvent(i,n,"mousedown",s)}function o(e,t,i){if(i)g.addDOMEvent(e,t,"selectstart",function(e){e.preventDefault()});else g.removeDOMEvent(e,t,"selectstart")}function s(e){var t=e.button,i=!1;if(!e.which&&1===t||1===e.which)i=!0;if(i){var n=document;this.addState("dragging"),o(this,this.main,!0),g.addDOMEvent(this,n,"mousemove",l),g.addDOMEvent(this,n,"mouseup",u),m.event.getMousePosition(e),this.dragStartPos={x:e.pageX,y:e.pageY}}}function l(e){var t=this;m.event.getMousePosition(e);var i={x:e.pageX-t.dragStartPos.x,y:e.pageY-t.dragStartPos.y};t.dragStartPos={x:e.pageX,y:e.pageY};var n=t.main,r=m.getOffset(n),a=r.left+i.x,o=r.top+i.y,s=m.page.getWidth(),l=m.page.getHeight(),u=m.getOffset(n);if(0>o)o=0;else if(o>l-u.height)o=l-u.height;if(0>a)a=0;else if(a>s-u.width)a=s-u.width;n.style.left=a+"px",n.style.top=o+"px"}function u(e){g.removeDOMEvent(this,document,"mousemove",l),g.removeDOMEvent(this,document,"mouseup",u),this.removeState("dragging"),o(this,this.main,!1)}function c(e,t){var i=h(e),n=[],r=g.getPartClasses(e,"mask").join(" ");n.push(r),i.className=n.join(" "),i.style.display="block",i.style.zIndex=t}function f(e){var t=h(e);if("undefined"!=typeof t)m.removeNode(t)}function d(e){var t=document.createElement("div");t.id=e,document.body.appendChild(t)}function h(e){var t=g.getId(e),i=b+"-"+t,n=m.g(i);if(!n)d(i);return m.g(i)}require("./Button"),require("./Panel");var p,m=require("./lib"),g=require("./controlHelper"),v=require("./Control"),y=require("./main"),b="ctrl-mask";return e.OK_TEXT="确定",e.CANCEL_TEXT="取消",e.prototype={type:"Dialog",initOptions:function(e){t(e);var i={closeButton:!0,closeOnHide:!0,draggable:!1,mask:!0,title:"我是标题",content:"<p>我是内容</p>",defaultFoot:'<div class="'+this.helper.getPartClassName("ok-btn")+'" data-ui="type:Button;id:btnFootOk;childName:btnOk;skin:spring;">确定</div><div class="'+this.helper.getPartClassName("cancel-btn")+'" data-ui="type:Button;id:btnFootCancel;childName:btnCancel;">取消</div>',needFoot:!0,roles:{}};if(m.extend(i,e),"false"===e.closeOnHide)i.closeOnHide=!1;if("false"===e.closeButton)i.closeButton=!1;if("false"===e.mask)i.mask=!1;if("false"===e.needFoot)i.needFoot=!1;if(i.needFoot)if(!i.foot)i.foot=i.defaultFoot;this.setProperties(i)},initStructure:function(){var e=this.main;if(e.parentNode&&"body"!==e.parentNode.nodeName.toLowerCase())document.body.appendChild(e);if(this.addState("hidden"),i(this,this.roles.title),this.createBF("body",this.roles.content),this.needFoot)this.createBF("foot",this.roles.foot)},initEvents:function(){if(this.closeButton){var e=m.g(g.getId(this,"close-icon"));if(e)g.addDOMEvent(this,e,"click",m.curry(n,this))}},createBF:function(e,t){if(t)this.content=t.innerHTML;else if(t=document.createElement("div"),"body"===e){var i=this.getChild("head");if(i)m.insertAfter(t,i.main);else if(this.main.firstChild)m.insertBefore(t,i,this.main.firstChild);else this.main.appendChild(t)}else this.main.appendChild(t);m.addClasses(t,g.getPartClasses(this,e+"-panel"));var n={main:t,renderOptions:this.renderOptions},r=y.create("Panel",n);return r.render(),this.addChild(r,e),r},repaint:g.createRepaint(v.prototype.repaint,{name:"height",paint:function(e,t){if("auto"===t)e.main.style.height="auto";else if(t)e.main.style.height=t+"px";if(e.isShow)r.apply(e)}},{name:"width",paint:function(e,t){if("auto"===t)e.main.style.width="auto";else if(t)e.main.style.width=t+"px";if(e.isShow)r.apply(e)}},{name:"title",paint:function(e,t){var i=g.getId(e,"title");m.g(i).innerHTML=t}},{name:"content",paint:function(e,t){if(t){var i='<div class="${class}" id="${id}">${content}</div>',n=e.getBody(),r=g.getId(e,"body"),a=g.getPartClasses(e,"body"),o={"class":a.join(" "),id:r,content:t};n.setContent(m.format(i,o))}}},{name:"foot",paint:function(e,t){var i='<div class="${class}" id="${id}">${content}</div>',n=g.getId(e,"foot"),r=g.getPartClasses(e,"foot"),a=e.getFoot();if(null==t){if(e.needFoot=!1,a)e.removeChild(a)}else{e.needFoot=!0;var o={"class":r.join(" "),id:n,content:t};if(!a)a=e.createBF("foot");a.setContent(m.format(i,o))}}},{name:"draggable",paint:function(e,t){var i=!1;if(t)e.addState("draggable");else e.removeState("draggable"),i=!0;a(e,i)}}),getBody:function(){return this.getChild("body")},getHead:function(){return this.getChild("head")},getFoot:function(){return this.getChild("foot")},show:function(){var e=this.mask;if(g.isInStage(this,"INITED"))this.render();else if(g.isInStage(this,"DISPOSED"))return;p=m.curry(r,this),g.addDOMEvent(this,window,"resize",r),this.setWidth(this.width),this.removeState("hidden"),r.apply(this);for(var t=1203,i=document.body.children,n=0,a=0,o=i.length;o>a;a++)if(1===i[a].nodeType)if(m.hasClass(i[a],this.helper.getPrimaryClassName())&&!m.hasClass(i[a],this.helper.getPrimaryClassName("hidden")))n++;if(t+=10*n,this.main.style.zIndex=t,e)c(this,t-1);if(!this.isShow)this.isShow=!0,this.fire("show")},hide:function(){if(this.isShow){if(this.isShow=!1,g.removeDOMEvent(this,window,"resize",r),this.addState("hidden"),this.mask)f(this);this.fire("hide")}},setTitle:function(e){this.setProperties({title:e})},setContent:function(e){this.setProperties({content:e})},setFoot:function(e){this.setProperties({foot:e})},setHeight:function(e){this.setProperties({height:e})},setWidth:function(e){this.setProperties({width:e})},resize:function(){r.apply(this)},dispose:function(){if(!this.helper.isInStage("DISPOSED")){this.hide();var e=this.main.id;m.removeNode(e),v.prototype.dispose.apply(this,arguments)}}},e.confirm=function(t){function i(e,t){e.fire(t),e.dispose()}var n="dialog-confirm",r=m.encodeHTML(t.title)||"",a=m.encodeHTML(t.content)||"",o=m.encodeHTML(t.okText)||e.OK_TEXT,s=m.encodeHTML(t.cancelText)||e.CANCEL_TEXT,l={type:"confirm",skin:"confirm",title:""};m.extend(l,t);var u=['<div class="${prefix}-icon ${prefix}-icon-${type}"></div>','<div class="${prefix}-text">${content}</div>'].join("");l.id=g.getGUID(n),l.closeButton=!1,l.mask=!0,l.alwaysTop=!0;var c=l.type;l.type=null;var f=y.create("Dialog",l);f.appendTo(document.body),f.show();var d=f.getFoot().getChild("btnOk"),h=f.getFoot().getChild("btnCancel");if(d.setContent(o),h.setContent(s),f.setTitle(r),f.setContent(m.format(u,{type:c,content:a,prefix:f.helper.getPrimaryClassName()})),l.btnHeight)d.set("height",l.btnHeight),h.set("height",l.btnHeight);if(l.btnWidth)d.set("width",l.btnWidth),h.set("width",l.btnWidth);return d.on("click",m.curry(i,f,"ok")),h.on("click",m.curry(i,f,"cancel")),f},e.alert=function(t){function i(e,t){e.fire("ok"),t.dispose(),e.dispose()}var n="dialog-alert",r="dialog-alert-ok",a=m.encodeHTML(t.title)||"",o=m.encodeHTML(t.content)||"",s=m.encodeHTML(t.okText)||e.OK_TEXT,l={type:"warning",skin:"alert",title:""};m.extend(l,t);var u=['<div class="${prefix}-icon ${prefix}-icon-${type}"></div>','<div class="${prefix}-text">${content}</div>'].join(""),c=g.getGUID(n);l.id=c,l.closeButton=!1,l.mask=!0,l.alwaysTop=!0;var f=l.type;l.type=null;var d=y.create("Dialog",l);d.appendTo(document.body),d.setTitle(a),d.setContent(m.format(u,{type:f,content:o,prefix:d.helper.getPrimaryClassName()})),d.setFoot('<div class="'+d.helper.getPartClassName("ok-btn")+'" data-ui="type:Button;childName:okBtn;id:'+c+"-"+r+'; skin:spring;width:50;">'+s+"</div>"),d.show();var h=d.getFoot().getChild("okBtn");if(h.on("click",m.curry(i,d,h)),l.btnHeight)h.set("height",l.btnHeight);if(l.btnwidth)h.set("width",l.btnwidth);return d},m.inherits(e,v),y.register(e),e}),define("esui/Crumb",["require","underscore","./lib","./Control","./painters","./main"],function(require){function e(){a.apply(this,arguments)}function t(e){for(var t=e.target,n=r.getChildren(this.main);t!==this.main;){if(this.helper.isPart(t,"node")){var a=r.hasAttribute(t,"data-index")?t.getAttribute("data-index"):i(n,t),o=this.fire("click",{item:this.path[a]});return o.isDefaultPrevented()&&e.preventDefault(),void(o.isPropagationStopped()&&e.stopPropagation())}t=t.parentNode}}function i(e,t){for(var i=e.length-1;i>-1;i-=2)if(e[i]===t)return i/2}var n=require("underscore"),r=require("./lib"),a=require("./Control");e.defaultProperties={separator:">"},e.prototype.type="Crumb",e.prototype.initOptions=function(t){var i={path:[]};n.extend(i,e.defaultProperties,t);var a=r.getChildren(this.main);if(!t.path&&a.length)i.path=n.map(a,function(e){var t={text:r.getText(e)};if("a"===e.nodeName.toLowerCase())t.href=r.getAttribute(e,"href");return t});this.setProperties(i)},e.prototype.initEvents=function(){this.helper.addDOMEvent(this.main,"click",t)},e.prototype.textNodeTemplate='<span class="${classes}" data-index="${index}">${text}</span>',e.prototype.linkNodeTemplate='<a class="${classes}" href="${href}" data-index="${index}">${text}</a>',e.prototype.separatorTemplate='<span class="${classes}">${text}</span>',e.prototype.getNodeHTML=function(e,t){var i=this.helper.getPartClasses("node");if(0===t)i.push.apply(i,this.helper.getPartClasses("node-first"));if(t===this.path.length-1)i.push.apply(i,this.helper.getPartClasses("node-last"));var a=e.href?this.linkNodeTemplate:this.textNodeTemplate,o={href:n.escape(e.href),text:n.escape(e.text),index:t,classes:i.join(" ")};return r.format(a,o)},e.prototype.getSeparatorHTML=function(){return r.format(this.separatorTemplate,{classes:this.helper.getPartClassName("separator"),text:n.escape(this.separator)})};var o=require("./painters");return e.prototype.repaint=o.createRepaint(a.prototype.repaint,{name:["path","separator"],paint:function(e,t){var i=n.map(t,e.getNodeHTML,e),r=e.getSeparatorHTML();e.main.innerHTML=i.join(r)}}),require("./main").register(e),r.inherits(e,a),e}),define("esui/SafeWrapper",["require","underscore"],function(require){function e(){}var t=require("underscore");return t.each(["enable","disable","setDisabled","show","hide","toggle","setValue","setRawValue","addChild","removeChild","set","addState","removeState","toggleState","on","off","fire","dispose","destroy","initOptions","createMain","initStructure","setViewContext","render","repaint","appendTo","insertBefore","initChildren","disposeChildren"],function(t){e.prototype[t]=function(){}}),t.each(["isDisabled","isHidden","hasState","isPropertyChanged"],function(t){e.prototype[t]=function(){return!1}}),t.each(["getRawValue","getChild","get"],function(t){e.prototype[t]=function(){return null}}),t.each(["getValue"],function(t){e.prototype[t]=function(){return""}}),t.each(["setProperties"],function(t){e.prototype[t]=function(){return{}}}),e.prototype.getCategory=function(){return"control"},e.prototype.getChildSafely=function(t){var i=new e;if(i.childName=t,i.parent=this,this.viewContext)i.viewContext=this.viewContext;return i},e}),define("esui/Control",["require","./lib","underscore","./main","./Helper","./SafeWrapper","mini-event/EventTarget"],function(require){function e(e){if(e=e||{},this.helper=new r(this),this.helper.changeStage("NEW"),this.children=[],this.childrenIndex={},this.currentStates={},this.domEvents={},this.main=e.main?e.main:this.createMain(e),!this.id&&!e.id)this.id=t.getGUID();this.initOptions(e),this.helper.initViewContext(),this.helper.initExtensions(),this.helper.changeStage("INITED"),this.fire("init",{options:e})}var t=require("./lib"),i=require("underscore"),n=require("./main"),r=require("./Helper");e.prototype={constructor:e,ignoreStates:["disabled"],getCategory:function(){return"control"},initOptions:function(e){e=e||{},this.setProperties(e)},createMain:function(){if(!this.type)return document.createElement("div");var e=this.type.replace(/([A-Z])/g,function(e,t){return"-"+t.toLowerCase()});return document.createElement(n.getConfig("customElementPrefix")+"-"+e.slice(1))},initStructure:function(){},initEvents:function(){},render:function(){if(this.helper.isInStage("INITED")){if(this.fire("beforerender"),this.domIDPrefix=this.viewContext.id,this.initStructure(),this.initEvents(),!this.main.id)this.main.id=this.helper.getId();if(this.main.setAttribute(n.getConfig("instanceAttr"),this.id),this.main.setAttribute(n.getConfig("viewContextAttr"),this.viewContext.id),this.helper.addPartClasses(),this.states)this.states="string"==typeof this.states?this.states.split(" "):this.states,i.each(this.states,this.addState,this)}if(this.repaint(),this.helper.isInStage("INITED"))this.helper.changeStage("RENDERED"),this.fire("afterrender")},repaint:function(e,t){if(!t||t.hasOwnProperty("disabled")){var i=this.disabled?"addState":"removeState";this[i]("disabled")}if(!t||t.hasOwnProperty("hidden")){var i=this.hidden?"addState":"removeState";this[i]("hidden")}},appendTo:function(t){if(t instanceof e)t=t.main;if(t.appendChild(this.main),this.helper.isInStage("NEW")||this.helper.isInStage("INITED"))this.render()},insertBefore:function(t){if(t instanceof e)t=t.main;if(t.parentNode.insertBefore(this.main,t),this.helper.isInStage("NEW")||this.helper.isInStage("INITED"))this.render()},dispose:function(){if(!this.helper.isInStage("DISPOSED"))this.helper.beforeDispose(),this.helper.dispose(),this.helper.afterDispose()},destroy:function(){var e=this.main;this.dispose(),t.removeNode(e)},get:function(e){var i=this["get"+t.pascalize(e)];if("function"==typeof i)return i.call(this);else return this[e]},set:function(e,i){var n=this["set"+t.pascalize(e)];if("function"==typeof n)return n.call(this,i);var r={};r[e]=i,this.setProperties(r)},isPropertyChanged:function(e,t,i){return i!==t},setProperties:function(e){if(!this.stage){if(e.hasOwnProperty("id"))this.id=e.id;if(e.hasOwnProperty("group"))this.group=e.group;if(e.hasOwnProperty("skin"))this.skin=e.skin}if(delete e.id,delete e.group,delete e.skin,e.hasOwnProperty("viewContext"))this.setViewContext(e.viewContext),delete e.viewContext;if(this.hasOwnProperty("disabled"))this.disabled=!!this.disabled;if(this.hasOwnProperty("hidden"))this.hidden=!!this.hidden;var i=[],n={};for(var r in e)if(e.hasOwnProperty(r)){var a=e[r],o="get"+t.pascalize(r)+"Property",s=this[o]?this[o]():this[r],l=this.isPropertyChanged(r,a,s);if(l){this[r]=a;var u={name:r,oldValue:s,newValue:a};i.push(u),n[r]=u}}if(i.length&&this.helper.isInStage("RENDERED"))this.repaint(i,n);return n},setViewContext:function(e){var t=this.viewContext;if(t!==e){if(t)this.viewContext=null,t.remove(this);this.viewContext=e,e&&e.add(this);var i=this.children;if(i)for(var r=0,a=i.length;a>r;r++)i[r].setViewContext(e);if(this.viewContext&&this.helper.isInStage("RENDERED"))this.main.setAttribute(n.getConfig("viewContextAttr"),this.viewContext.id)}},setDisabled:function(e){this[e?"disable":"enable"]()},disable:function(){this.addState("disabled")},enable:function(){this.removeState("disabled")},isDisabled:function(){return this.hasState("disabled")},show:function(){this.removeState("hidden")},hide:function(){this.addState("hidden")},toggle:function(){this[this.isHidden()?"show":"hide"]()},isHidden:function(){return this.hasState("hidden")},addState:function(e){if(!this.hasState(e)){this.currentStates[e]=!0,this.helper.addStateClasses(e);var t={},i=e.replace(/-(\w)/,function(e,t){return t.toUpperCase()});t[i]=!0,this.setProperties(t)}},removeState:function(e){if(this.hasState(e)){this.currentStates[e]=!1,this.helper.removeStateClasses(e);var t={},i=e.replace(/-(\w)/,function(e,t){return t.toUpperCase()});t[i]=!1,this.setProperties(t)}},toggleState:function(e){var t=this.hasState(e)?"removeState":"addState";this[t](e)},hasState:function(e){return!!this.currentStates[e]},addChild:function(e,t){if(t=t||e.childName,e.parent)e.parent.removeChild(e);if(this.children.push(e),e.parent=this,t)e.childName=t,this.childrenIndex[t]=e;if(this.viewContext!==e.viewContext)e.setViewContext(this.viewContext)},removeChild:function(e){for(var t=this.children,i=t.length;i--;)if(t[i]===e)t.splice(i,1);var n=e.childName;if(n)this.childrenIndex[n]=null;e.parent=null},disposeChildren:function(){for(var e=this.children.slice(),t=0;t<e.length;t++)e[t].dispose();this.children=[],this.childrenIndex={}},getChild:function(e){return this.childrenIndex[e]||null},getChildSafely:function(e){var t=this.getChild(e);if(!t){var i=require("./SafeWrapper");if(t=new i,t.childName=e,t.parent=this,this.viewContext)t.viewContext=this.viewContext}return t},initChildren:function(e,t){this.helper.initChildren(e,t)}};var a=require("mini-event/EventTarget");return t.inherits(e,a),e}),define("esui/CommandMenu",["require","underscore","./lib","./Control","./Layer","./painters","./main"],function(require){function e(e){for(var t=e.target;t!==e.currentTarget&&!r.hasAttribute(t,"data-index");)t=t.parentNode;var i=+t.getAttribute("data-index"),n=this.datasource[i];if(!n.disabled)if(this.layer.hide(),t!==e.currentTarget){if(n)if("function"==typeof n.handler)n.handler.call(this,n,i);this.fire("select",{item:n,index:i})}}function t(){o.apply(this,arguments)}function i(){a.apply(this,arguments),this.layer=new t(this)}var n=require("underscore"),r=require("./lib"),a=require("./Control"),o=require("./Layer");r.inherits(t,o),t.prototype.nodeName="ul",t.prototype.dock={strictWidth:!0},t.prototype.render=function(e){for(var t="",i=0;i<this.control.datasource.length;i++){var n=this.control.helper.getPartClasses("node");if(i===this.control.activeIndex)n.push.apply(n,this.control.helper.getPartClasses("node-active"));if(this.control.datasource[i].disabled)n.push.apply(n,this.control.helper.getPartClasses("node-disabled"));t+='<li data-index="'+i+'" class="'+n.join(" ")+'">',t+=this.control.getItemHTML(this.control.datasource[i])}e.innerHTML=t},t.prototype.initBehavior=function(t){this.control.helper.addDOMEvent(t,"click",e)},i.prototype.type="CommandMenu",i.prototype.itemTemplate="<span>${text}</span>",i.prototype.getItemHTML=function(e){var t={text:n.escape(e.text)};return r.format(this.itemTemplate,t)},i.prototype.initEvents=function(){this.helper.addDOMEvent(this.main,"click",n.bind(this.layer.toggle,this.layer))};var s=require("./painters");return i.prototype.repaint=s.createRepaint(a.prototype.repaint,s.style("width"),s.style("height"),{name:"datasource",paint:function(e){e.layer.repaint()}},s.text("displayText"),{name:["disabled","hidden","readOnly"],paint:function(e,t,i,n){if(t||i||n)e.layer.hide()}}),i.prototype.dispose=function(){if(!this.helper.isInStage("DISPOSED")){if(this.layer)this.layer.dispose(),this.layer=null;a.prototype.dispose.apply(this,arguments)}},r.inherits(i,a),require("./main").register(i),i}),define("esui/CheckBox",["require","underscore","./lib","./InputControl","./painters","./main"],function(require){function e(e){var t=n.g(this.boxId).checked;this.setProperties({checked:t})}function t(){r.apply(this,arguments)}var i=require("underscore"),n=require("./lib"),r=require("./InputControl");return t.prototype={type:"CheckBox",createMain:function(){return document.createElement("label")},getCategory:function(){return"check"},initOptions:function(e){var t={value:this.main.value||"on",checked:this.main.checked||!1};i.extend(t,e),t.name=t.name||this.main.getAttribute("name");var n=t.datasource;if(delete t.datasource,this.setProperties(t),null!=n)if(i.isArray(n))this.checked=i.any(n,function(e){return e.value==this.value},this);else if(this.rawValue==n)this.checked=!0;if(!this.title)this.title=this.main.title||("on"===this.getValue()?"":this.getValue())},initStructure:function(){if("input"===this.main.nodeName.toLowerCase())this.boxId=this.main.id||this.helper.getId("box"),this.helper.replaceMain(),this.main.id=this.helper.getId();else this.boxId=this.helper.getId("box");var e='<input type="checkbox" name="${name}" id="${id}" /><span id="${textId}"></span>';this.main.innerHTML=n.format(e,{name:this.name,id:this.boxId,textId:this.helper.getId("text")})},initEvents:function(){var t=n.g(this.boxId);if(this.helper.addDOMEvent(t,"click",function(i){if(this.fire("click"),!t.addEventListener)e.call(this,i)}),t.addEventListener)this.helper.addDOMEvent(t,"change",e)},setProperties:function(e){var t=r.prototype.setProperties.apply(this,arguments);if(t.hasOwnProperty("checked"))this.fire("change")},getFocusTarget:function(){var e=n.g(this.boxId);return e},updateTitle:function(e){this.title=e,e=i.escape(e),this.helper.getPart("text").innerHTML=e,n.setAttribute(this.boxId,"title",e)},repaint:require("./painters").createRepaint(r.prototype.repaint,{name:["rawValue","checked"],paint:function(e,t,i){var r=e.stringifyValue(t),e=n.g(e.boxId);e.value=r,e.checked=i}},{name:["disabled","readOnly"],paint:function(e,t,i){var e=n.g(e.boxId);e.disabled=t,e.readOnly=i}},{name:"title",paint:function(e,t){e.updateTitle(t)}}),setChecked:function(e){this.setProperties({checked:e})},isChecked:function(){if(this.helper.isInStage("RENDERED")){var e=n.g(this.boxId);return e.checked}else return this.checked}},n.inherits(t,r),require("./main").register(t),t}),define("esui/ControlCollection",["require","underscore"],function(require){function e(){this.length=0}var t=require("underscore");return e.prototype.splice=Array.prototype.splice,e.prototype.add=function(e){var i=t.indexOf(this,e);if(0>i)[].push.call(this,e)},e.prototype.remove=function(e){for(var t=0;t<this.length;t++)if(this[t]===e)return void[].splice.call(this,t,1)},e.prototype.each=function(e,i){t.each(this,function(t,n){e.call(i||t,t,n,this)})},e.prototype.invoke=function(e){var i=[this];return i.push.apply(i,arguments),t.invoke.apply(t,i)},t.each(["enable","disable","setDisabled","show","hide","toggle","addChild","removeChild","set","setProperties","addState","removeState","toggleState","on","off","fire","dispose","destroy","setViewContext","render","repaint","appendTo","insertBefore"],function(t){e.prototype[t]=function(){var e=[t];e.push.apply(e,arguments);var i=this.invoke.apply(this,e);return i&&i[0]}}),t.each(["isDisabled","isHidden","hasState","get","getCategory","getChild","getChildSafely"],function(t){e.prototype[t]=function(){var e=this[0];return e?e[t].apply(e,arguments):void 0}}),e}),define("esui/ViewContext",["require","./ControlCollection","./lib","./SafeWrapper"],function(require){function e(e){o.apply(this,arguments),this.name=e}function t(e,t){o.prototype.add.call(t,e)}function i(e,t){o.prototype.remove.call(t,e)}function n(e){var t=e.get("group");return t?t.split(/[\t\r\n ]/):[]}function r(){return"vt"+s++}function a(e){if(this.controls={},this.groups={},e=e||r(),l.hasOwnProperty(e)){for(var t=1,i=e+"-";l.hasOwnProperty(i+t);)t++;e=i+t}this.id=e,l[this.id]=this}var o=require("./ControlCollection");require("./lib").inherits(e,o),e.prototype.add=void 0,e.prototype.remove=void 0,e.prototype.disposeGroup=function(){for(var e=0;e<this.length;e++)delete this[e];this.length=0};var s=8587523,l={};a.get=function(e){return l[e]||null},a.prototype.add=function(e){var i=this.controls[e.id];if(i){if(i===e)return;i.setViewContext(null)}this.controls[e.id]=e;for(var r=n(e),a=0;a<r.length;a++){var o=r[a];if(o){var s=this.getGroup(o);t(e,s)}else;}e.setViewContext(this)},a.prototype.remove=function(e){delete this.controls[e.id];for(var t=n(e),r=0;r<t.length;r++){var a=t[r];if(a){var o=this.getGroup(a);i(e,o)}else;}e.setViewContext(null)},a.prototype.get=function(e){return this.controls[e]},a.prototype.getControls=function(){return require("./lib").extend({},this.controls)};var u=require("./SafeWrapper");return a.prototype.getSafely=function(e){var t=this.get(e);if(!t)t=new u,t.id=e,t.viewContext=this;return t},a.prototype.getGroup=function(t){if(!t)throw new Error("name is unspecified");var i=this.groups[t];if(!i)i=this.groups[t]=new e(t);return i},a.prototype.clean=function(){for(var e in this.controls)if(this.controls.hasOwnProperty(e)){var t=this.controls[e];if(t.dispose(),t.viewContext&&t.viewContext===this)this.remove(t)}for(var i in this.groups)if(this.groups.hasOwnProperty(i))this.groups[i].disposeGroup(),this.groups[i]=void 0},a.prototype.dispose=function(){this.clean(),delete l[this.id]},a}),define("esui/main",["require","./lib","./ViewContext","./ControlCollection"],function(require){function e(e,t){if("function"==typeof e){var i=e.prototype.type;if(i in t)throw new Error(i+" is exists!");t[i]=e}}function t(e,t,i){var n=i[e];if(n)return delete t.type,new n(t);else return null}var i=require("./lib"),n={};n.version="3.1.0";var r=require("./ViewContext"),a=new r("default");n.getViewContext=function(){return a};var o={uiPrefix:"data-ui",extensionPrefix:"data-ui-extension",customElementPrefix:"esui",instanceAttr:"data-ctrl-id",viewContextAttr:"data-ctrl-view-context",uiClassPrefix:"ui",skinClassPrefix:"skin",stateClassPrefix:"state"};n.config=function(e){i.extend(o,e)},n.getConfig=function(e){return o[e]},n.parseAttribute=function(e,t){if(!e)return{};for(var n={},r=0,a=0;a<e.length;){for(;a<e.length&&":"!==e.charAt(a);)a++;if(a>=e.length)break;var o=i.trim(e.slice(r,a));for(a++,r=a;a<e.length&&";"!==e.charAt(a);)a++;for(var s=a+1;s<e.length;){var l=e.charAt(s);if(";"===l)a=s;if(":"===l)break;s++}var u=i.trim(e.slice(r,a));n[o]=t?t(u):u,a++,r=a}return n},n.getControlByDOM=function(e){if(!e)return null;var t,i=n.getConfig,a=e.getAttribute(i("instanceAttr")),o=e.getAttribute(i("viewContextAttr"));if(a&&o&&(t=r.get(o)))return t.get(a);else return null};var s={};n.register=function(t){e(t,s)},n.create=function(e,i){return t(e,i,s)},n.get=function(e){return a.get(e)},n.getSafely=function(e){return a.getSafely(e)};var l=require("./ControlCollection");n.wrap=function(){for(var e=new l,t=0;t<arguments.length;t++)e.add(arguments[t]);return e},n.init=function(e,t){function i(e){function t(e){return e.toUpperCase()}for(var i=1,n=e.length;n>i;i++)e[i]=e[i].replace(/^[a-z]/,t);return e.join("")}function r(e,t){for(var i in t)if(!(i in e))e[i]=t[i]}function a(e,t,a){if(0===t.length)r(e,n.parseAttribute(a,s));else e[i(t)]=s(a)}e=e||document.body,t=t||{};for(var s=t.valueReplacer||function(e){return e},l=e.getElementsByTagName("*"),u=[],c=0,f=l.length;f>c;c++)if(1===l[c].nodeType)u.push(l[c]);for(var d=n.getConfig("uiPrefix"),h=n.getConfig("extensionPrefix"),p=n.getConfig("customElementPrefix"),m=d.length,g=h.length,v=t.properties||{},y=[],c=0,f=u.length;f>c;c++){var b=u[c];if(!b.getAttribute(o.instanceAttr)){for(var x=b.attributes,w={},C={},k=0,_=x.length;_>k;k++){var T=x[k],M=T.name,S=T.value;if(0===M.indexOf(h)){var L=M.slice(g+1).split("-"),D=L[0];L.shift();var P=C[D];if(!P)P=C[D]={};a(P,L,S)}else if(0===M.indexOf(d)){var L=M.length===m?[]:M.slice(m+1).split("-");a(w,L,S)}}var A=w.type;if(!A){var E=b.nodeName.toLowerCase(),I=E.indexOf(p);if(0===I){var O;O=E.replace(/-(\S)/g,function(e,t){return t.toUpperCase()}),O=O.slice(p.length),w.type=O,A=O}}if(A){var N=w.id,R=N?v[N]:{};for(var H in R)w[H]=s(R[H]);var Y=w.extensions||[];w.extensions=Y;for(var H in C){var P=C[H],j=n.createExtension(P.type,P);j&&Y.push(j)}w.viewContext=t.viewContext,w.renderOptions=t,w.main=b;var z=n.create(A,w);if(z){if(y.push(z),t.parent)t.parent.addChild(z);try{z.render()}catch(B){var F=new Error('Render control "'+(z.id||"anonymous")+'" of type '+z.type+" failed because: "+B.message);throw F.actualError=B,F}}}}else;}return y};var u={};n.registerExtension=function(t){e(t,u)},n.createExtension=function(e,i){return t(e,i,u)};var c={};n.attachExtension=function(e,t){c[e]=t},n.createGlobalExtensions=function(){var e=[];for(var t in c)if(c.hasOwnProperty(t)){var i=n.createExtension(t,c[t]);i&&e.push(i)}return e};var f=[];return n.registerRule=function(e,t){f.push({type:e,priority:t}),f.sort(function(e,t){return e.priority-t.priority})},n.createRulesByControl=function(e){for(var t=[],i=0;i<f.length;i++){var n=f[i].type;if(null!=e.get(n.prototype.type))t.push(new n)}return t},n}),define("esui/helper/children",["require","underscore","../main"],function(require){var e=require("underscore"),t=require("../main"),i={};return i.initChildren=function(i,n){i=i||this.control.main,n=e.extend({},this.control.renderOptions,n),n.viewContext=this.control.viewContext,n.parent=this.control,t.init(i,n)},i.disposeChildren=function(){var t=this.control.children.slice();e.each(t,function(e){e.dispose()}),this.children=[],this.childrenIndex={}},i.disableChildren=function(){e.each(this.control.children,function(e){e.disable()})},i.enableChildren=function(){e.each(this.control.children,function(e){e.enable()})},i}),define("esui/Helper",["require","underscore","./helper/children","./helper/dom","./helper/event","./helper/html","./helper/life","./helper/template"],function(require){function e(e){this.control=e}var t=require("underscore");return t.extend(e.prototype,require("./helper/children"),require("./helper/dom"),require("./helper/event"),require("./helper/html"),require("./helper/life"),require("./helper/template")),e}),define("esui/controlHelper",["require","./lib","./Helper","./painters","underscore","./Layer"],function(require){var e=require("./lib"),t=require("./Helper"),i={};i.getGUID=e.getGUID;var n=["initViewContext","initExtensions","isInStage","changeStage","dispose","beforeDispose","afterDispose","getPartClasses","addPartClasses","removePartClasses","getStateClasses","addStateClasses","removeStateClasses","getId","replaceMain","addDOMEvent","removeDOMEvent","clearDOMEvents"];i.createRepaint=require("./painters").createRepaint,require("underscore").each(n,function(e){i[e]=function(i){var n=i.helper||new t(i),r=[].slice.call(arguments,1);return n[e].apply(n,r)}}),i.extractValueFromInput=function(t,i){var n=t.main;if(e.isInput(n)){if(n.value&&!i.value)i.value=n.value;if(n.name&&!i.name)i.name=n.name;if(n.disabled&&(null===i.disabled||void 0===i.disabled))i.disabled=n.disabled;if(n.readOnly&&(null===i.readOnly||void 0===i.readOnly))i.readOnly=n.readonly||n.readOnly}};var r=i.layer={},a=require("./Layer");return r.create=a.create,r.getZIndex=a.getZIndex,
r.moveToTop=a.moveToTop,r.moveTo=a.moveTo,r.resize=a.resize,r.attachTo=a.attachTo,r.centerToView=a.centerToView,i}),define("esui/InputControl",["require","./lib","./controlHelper","./Control","./Validity","./validator/Validity","./main"],function(require){function e(e){if(e=e?t.extend({},e):{},e.main&&!e.name)e.name=e.main.getAttribute("name");n.call(this,e)}var t=require("./lib"),i=require("./controlHelper"),n=require("./Control"),r=require("./Validity"),a=require("./validator/Validity"),o=require("./main");return e.prototype={constructor:e,ignoreStates:n.prototype.ignoreStates.concat("read-only"),getCategory:function(){return"input"},getFocusTarget:function(){return null},getValue:function(){return this.stringifyValue(this.getRawValue())},setValue:function(e){var t=this.parseValue(e);this.setRawValue(t)},getRawValue:function(){return this.rawValue},setRawValue:function(e){this.setProperties({rawValue:e})},setProperties:function(e){var t=e.value;if(delete e.value,null!=t&&null==e.rawValue)e.rawValue=this.parseValue(t);if(this.hasOwnProperty("readOnly"))this.readOnly=!!this.readOnly;return n.prototype.setProperties.call(this,e)},repaint:i.createRepaint(n.prototype.repaint,{name:"disabled",paint:function(e,t){var i=e.main.nodeName.toLowerCase();if("input"===i||"select"===i||"textarea"===i)e.main.disabled=t}},{name:"readOnly",paint:function(e,t){var i=t?"addState":"removeState";e[i]("read-only");var n=e.main.nodeName.toLowerCase();if("input"===n||"select"===n||"textarea"===n)e.main.readOnly=t}},{name:"hidden",paint:function(e,n){var r=e.getValidityLabel(!0);if(r){var a=o.getConfig("uiClassPrefix"),s=[].concat(a+"-hidden",a+"-validity-hidden",i.getPartClasses(e,"validity-hidden")),l=e.isHidden()?"addClasses":"removeClasses";t[l](r,s)}}}),stringifyValue:function(e){return null!=e?e+"":""},parseValue:function(e){return e},setReadOnly:function(e){e=!!e,this[e?"addState":"removeState"]("read-only")},isReadOnly:function(){return this.hasState("read-only")},getValidationResult:function(){var e=new a,t={validity:e};t=this.fire("beforevalidate",t);for(var i=o.createRulesByControl(this),n=0,r=i.length;r>n;n++){var s=i[n];e.addState(s.getName(),s.check(this.getValue(),this))}if(!e.isValid())t=this.fire("invalid",t);return this.fire("aftervalidate",t),e},checkValidity:function(){var e=this.getValidationResult();return e.isValid()},validate:function(){var e=this.getValidationResult();return this.showValidity(e),e.isValid()},getValidityLabel:function(e){if(!i.isInStage(this,"RENDERED"))return null;var n=this.validityLabel&&this.viewContext.get(this.validityLabel);if(!n&&!e){var a={id:this.id+"-validity",viewContext:this.viewContext};if(n=new r(a),this.main.nextSibling){var o=this.main.nextSibling;n.insertBefore(o)}else n.appendTo(this.main.parentNode);this.validityLabel=n.id}if((8===t.ie||7===t.ie)&&n)t.toggleClass(n.main.parentNode,"fuck-the-ie");return n},showValidity:function(e){if(this.validity)this.removeState("validity-"+this.validity.getValidState());this.validity=e,this.addState("validity-"+e.getValidState());var t=this.getValidityLabel();if(t){var i={target:this,focusTarget:this.getFocusTarget(),validity:e};t.setProperties(i)}},hideValidity:function(){var e=new a;this.showValidity(e)},showValidationMessage:function(e,t){t=t||"";var i=new a;i.setCustomValidState(e),i.setCustomMessage(t),this.showValidity(i)},dispose:function(){if(!i.isInStage(this,"DISPOSED")){var e=this.getValidityLabel(!0);if(e)e.dispose();n.prototype.dispose.apply(this,arguments)}}},t.inherits(e,n),e}),define("esui/Select",["require","underscore","./lib","./InputControl","./Layer","./painters","./main"],function(require){function e(e){for(var t=s.event.getTarget(e),i=this.layer.getElement();t&&t!==i&&!s.hasAttribute(t,"data-index");)t=t.parentNode;if(t&&!this.helper.isPart(t,"item-disabled")){var n=t.getAttribute("data-index");this.set("selectedIndex",+n),this.layer.hide()}}function t(){u.apply(this,arguments)}function i(e){l.apply(this,arguments),this.layer=new t(this)}function n(e){if(null==e.selectedIndex&&null==e.rawValue&&null==e.value)e.selectedIndex=-1;if(null!=e.rawValue)e.value=null,e.selectedIndex=null;else if(null!=e.value)e.selectedIndex=null;if(null==e.selectedIndex&&(null!=e.value||null!=e.rawValue)){e.selectedIndex=-1;for(var t=e.rawValue||e.value,i=0;i<e.datasource.length;i++)if(e.datasource[i].value==t){e.selectedIndex=i;break}delete e.value,delete e.rawValue}if(e.selectedIndex<0||e.selectedIndex>=e.datasource.length)if(e.emptyText)e.selectedIndex=-1;else{e.selectedIndex=-1;for(var i=0;i<e.datasource.length;i++)if(!e.datasource[i].disabled){e.selectedIndex=i;break}}}function r(){this.fire("layerrendered",{layer:this.layer})}function a(e){var t=e.helper.getPart("text"),i=-1===e.selectedIndex?null:e.datasource[e.selectedIndex];t.innerHTML=e.getDisplayHTML(i);var n=e.layer.getElement(!1);if(n)e.layer.syncState(n)}var o=require("underscore"),s=require("./lib"),l=require("./InputControl"),u=require("./Layer");s.inherits(t,u),t.prototype.nodeName="ol",t.prototype.render=function(e){for(var t="",i=0;i<this.control.datasource.length;i++){var n=this.control.datasource[i],r=this.control.helper.getPartClasses("item");if(n.disabled)r.push.apply(r,this.control.helper.getPartClasses("item-disabled"));t+='<li data-index="'+i+'" class="'+r.join(" ")+'">',t+=this.control.getItemHTML(n),t+="</li>"}e.innerHTML=t},t.prototype.initBehavior=function(t){this.control.helper.addDOMEvent(t,"click",e)},t.prototype.syncState=function(e){for(var t=this.control.helper.getPartClasses("item-selected"),i=s.getChildren(e),n=i.length-1;n>=0;n--){var r=i[n];if(n===this.control.selectedIndex)s.addClasses(r,t);else s.removeClasses(r,t)}},t.prototype.dock={strictWidth:!0},i.prototype.type="Select",i.prototype.initOptions=function(e){var t={datasource:[]},i={};if(o.extend(i,t,e),"select"===this.main.nodeName.toLowerCase()){i.datasource=[];for(var n=this.main.getElementsByTagName("option"),r=0,a=n.length;a>r;r++){var s=n[r],l={name:s.name||s.text,value:s.value};if(s.disabled)l.disabled=!0;if(i.datasource.push(l),s.selected&&null==i.selectedIndex&&null==i.value&&null==i.rawValue)i.selectedIndex=s.value?r:0}this.helper.extractOptionsFromInput(this.main,i)}if("string"==typeof i.selectedIndex)i.selectedIndex=+i.selectedIndex;this.setProperties(i)},i.prototype.itemTemplate="<span>${text}</span>",i.prototype.getItemHTML=function(e){var t={text:o.escape(e.name||e.text),value:o.escape(e.value)};return s.format(this.itemTemplate,t)},i.prototype.displayTemplate="${text}",i.prototype.getDisplayHTML=function(e){if(!e)return o.escape(this.emptyText||"");var t={text:o.escape(e.name||e.text),value:o.escape(e.value)};return s.format(this.displayTemplate,t)},i.prototype.initStructure=function(){if("select"===this.main.nodeName.toLowerCase())this.helper.replaceMain();this.main.tabIndex=0,this.main.innerHTML=this.helper.getPartHTML("text","span")},i.prototype.initEvents=function(){this.helper.addDOMEvent(this.main,"click",o.bind(this.layer.toggle,this.layer)),this.layer.on("rendered",o.bind(r,this))},i.prototype.getRawValue=function(){if(this.selectedIndex<0)return null;var e=this.datasource[this.selectedIndex];return e?e.value:null};var c=require("./painters");return i.prototype.repaint=c.createRepaint(l.prototype.repaint,c.style("width"),c.style("height"),{name:"datasource",paint:function(e){e.layer.repaint()}},{name:["selectedIndex","emptyText","datasource"],paint:a},{name:["disabled","hidden","readOnly"],paint:function(e,t,i,n){if(t||i||n)e.layer.hide()}}),i.prototype.updateDatasource=function(e){if(!e)e=this.datasource;this.datasource=e;var t={name:"datasource"};this.repaint([t],{datasource:t})},i.prototype.setProperties=function(e){if(null==e.datasource)e.datasource=this.datasource;if(null==e.value&&null==e.rawValue&&null==e.selectedIndex&&e.datasource===this.datasource)e.selectedIndex=this.selectedIndex;if(!e.hasOwnProperty("emptyText"))e.emptyText=this.emptyText;n(e);var t=l.prototype.setProperties.apply(this,arguments);if(t.hasOwnProperty("selectedIndex"))this.fire("change");return t},i.prototype.dispose=function(){if(!this.helper.isInStage("DISPOSED")){if(this.layer)this.layer.dispose(),this.layer=null;l.prototype.dispose.apply(this,arguments)}},i.prototype.getSelectedItem=function(){return this.get("datasource")[this.get("selectedIndex")]},s.inherits(i,l),require("./main").register(i),i}),define("esui/MonthView",["require","./Button","./Select","./Panel","./lib","./controlHelper","./Control","./main","moment"],function(require){function e(e){z.apply(this,arguments)}function t(e){for(var t=e.viewRange||e.range,i=[],n=t.end.getFullYear(),r=t.begin.getFullYear();n>=r;r++)i.push({text:r,value:r});return i}function i(e,t){var i=e.viewRange||e.range,n=[],r=11,a=0;if(t===i.begin.getFullYear())a=i.begin.getMonth();if(t===i.end.getFullYear())r=i.end.getMonth();for(;r>=a;a++)n.push({text:a+1,value:a});return n}function n(e){var t=['<div class="${headClass}"><table><tr>','<td width="40" align="left">','<div class="${monthBackClass}"',' data-ui-type="Button"',' data-ui-child-name="monthBack"',' data-ui-id="${monthBackId}"',"></div>","</td>","<td>",'<div class="${yearSelectClass}"',' data-ui="type:Select;childName:yearSel;',' id:${yearSelId};"></div>',"</td>","<td>",'<div class="${monthSelectClass}"',' data-ui="type:Select;childName:monthSel;',' id:${monthSelId};"></div>',"</td>",'<td width="40" align="right">','<div class="${monthForClass}"',' data-ui-type="Button"',' data-ui-child-name="monthForward"',' data-ui-id="${monthForwardId}"',"></div>","</td>","</tr></table></div>",'<div id="${monthMainId}" class="${monthMainClass}"></div>'];return t=t.join(""),Y.format(t,{headClass:e.helper.getPartClassName("head"),monthBackId:e.helper.getId("monthBack"),monthForwardId:e.helper.getId("monthForward"),yearSelId:e.helper.getId("yearSel"),monthSelId:e.helper.getId("monthSel"),monthMainId:e.helper.getId("monthMain"),monthMainClass:e.helper.getPartClassName("month"),monthBackClass:e.helper.getPartClassName("month-back"),monthForClass:e.helper.getPartClassName("month-forward"),yearSelectClass:e.helper.getPartClassName("year-select"),monthSelectClass:e.helper.getPartClassName("month-select")})}function r(e){var t=[];if("multi"===e.mode)t.push("");t=t.concat(["一","二","三","四","五","六","日"]);var i='<table border="0" cellpadding="0" cellspacing="0" class="${className}"><thead><tr>',n=[];n.push(Y.format(i,{className:e.helper.getPartClassName("month-main")}));for(var r='<td id="${id}" data-index="${index}" class="${className}">${text}</td>',o=e.helper.getPartClassName("month-title"),s=e.helper.getId("month-title"),l=e.helper.getPartClassName("month-select-all"),u=t.length,c=0;u>c;c++)n.push(Y.format(r,{className:""===t[c]?l:o,text:t[c],index:c,id:s+"-"+c}));n.push("</tr></thead><tbody><tr>");var f='<td data-year="${year}" data-month="${month}" data-date="${date}" class="${className}" id="${id}">${date}</td>',d=e.helper.getPartClassName("month-row-select"),h=e.helper.getId("row-select"),p=0,m='<td id="${id}" class="'+d+'">&gt;</td>',g=0,v=e.year,y=e.month,b=new Date(v,y,1),x=new Date(v,y+1,1),w=1-(b.getDay()+6)%7;b.setDate(w);var C=e.helper.getPartClassName("month-item"),k=e.helper.getPartClassName("month-item-today"),_=e.helper.getPartClassName("month-item-virtual"),T=e.helper.getPartClassName("month-item-disabled"),M=e.range;if("multi"===e.mode)n.push(Y.format(m,{id:h+"-"+p++}));for(;x-b>0||g%7!==0;){if(w>1&&g%7===0)if(n.push("</tr><tr>"),"multi"===e.mode)n.push(Y.format(m,{id:h+"-"+p++}));var S=b.getMonth()!==y,L=!1;if(b<M.begin)L=!0;else if(b>M.end)L=!0;var D=C;if(S)D+=" "+_;else if(F().isSame(b,"day"))D+=" "+k;if(L)D+=" "+T;n.push(Y.format(f,{year:b.getFullYear(),month:b.getMonth(),date:b.getDate(),className:D,id:a(e,b)})),b=new Date(v,y,++w),g++}return e.rowTagNum=p,n.push("</tr></tbody></table>"),n.join("")}function a(e,t){return e.helper.getId(t.getFullYear()+"-"+t.getMonth()+"-"+t.getDate())}function o(e){for(var t=e.target||e.srcElement,i=j.getPartClasses(this,"month-select-all"),n=j.getPartClasses(this,"month-title"),r=j.getPartClasses(this,"month-item"),a=j.getPartClasses(this,"month-row-select"),o=j.getPartClasses(this,"month-item-virtual"),s=j.getPartClasses(this,"month-item-disabled");t&&t!==document.body;){if(Y.hasClass(t,r[0])&&!Y.hasClass(t,o[0])&&!Y.hasClass(t,s[0]))return void _(this,t);else if("multi"===this.mode){if(Y.hasClass(t,a[0]))return void g(this,t);if(Y.hasClass(t,n[0]))return void d(this,t);if(Y.hasClass(t,i[0]))return void y(this)}t=t.parentNode}}function s(e){var t=e.rawValue;e.viewValue={};for(var i=0;i<t.length;i++){var n=t[i],r=n.getFullYear(),a=n.getMonth(),o=n.getDate(),s=r+"-"+a+"-"+o;e.viewValue[s]={isSelected:!0,value:new Date(r,a,o)}}}function l(e,t){var i=j.getPartClasses(e,"month-item-virtual"),n=j.getPartClasses(e,"month-item-disabled");if(!Y.hasClass(t,i[0])&&!Y.hasClass(t,n[0]))return 1;else if(Y.hasClass(t,i[0])&&!Y.hasClass(t,n[0]))return-1;return 0}function u(e,t,i){if(j.removePartClasses(e,"month-row-select-selected",t),i)j.addPartClasses(e,"month-row-select-selected",t)}function c(e){for(var t=e.rowTagNum,i=j.getId(e,"row-select"),n=0;t>n;n++){var r=Y.g(i+"-"+n);f(e,r)}}function f(e,t){for(var i=j.getPartClasses(e,"month-item-selected"),n=t.nextSibling,r=!0,a=0;n;){if(1===l(e,n))if(++a,!Y.hasClass(n,i[0])){r=!1;break}n=n.nextSibling}if(0===a)r=!1;u(e,t,r)}function d(e,t){var i=t.getAttribute("data-index"),n=j.getPartClasses(e,"month-title-selected"),r=!0;if(Y.hasClass(t,n[0]))r=!1,j.removePartClasses(e,"month-title-selected",t);else j.addPartClasses(e,"month-title-selected",t);for(var a=e.rowTagNum,o=j.getId(e,"row-select"),s=e.viewValue,u=[],f=0;a>f;f++){var d=Y.g(o+"-"+f),h=d.parentNode.children[i];if(1===l(e,h)){var p=h.getAttribute("data-date"),m=h.getAttribute("data-month"),g=h.getAttribute("data-year"),y=g+"-"+m+"-"+p;s[y]={isSelected:r,value:new Date(g,m,p)},u.push(y)}}if(u&&u.length>0)b(e),x(e,u,r),c(e),v(e)}function h(e,t,i){if(j.removePartClasses(e,"month-title-selected",t),i)j.addPartClasses(e,"month-title-selected",t)}function p(e){for(var t=j.getId(e,"month-title"),i=1;7>=i;i++){var n=Y.g(t+"-"+i);m(e,n)}}function m(e,t){for(var i=j.getPartClasses(e,"month-item-selected"),n=t.getAttribute("data-index"),r=!0,a=0,o=e.rowTagNum,s=j.getId(e,"row-select"),u=0;o>u;u++){var c=Y.g(s+"-"+u),f=c.parentNode.children[n];if(1===l(e,f))if(++a,!Y.hasClass(f,i[0])){r=!1;break}}if(0===a)r=!1;h(e,t,r)}function g(e,t){var i=t.parentNode,n=j.getPartClasses(e,"month-row-select"),r=j.getPartClasses(e,"month-row-select-selected"),a=j.getPartClasses(e,"month-item-virtual"),o=j.getPartClasses(e,"month-item-disabled"),s=!0;if(Y.hasClass(t,r[0]))s=!1,j.removePartClasses(e,"month-row-select-selected",t);else j.addPartClasses(e,"month-row-select-selected",t);for(var l=i.children,u=e.viewValue,c=[],f=0;f<l.length;f++){var d=l[f];if(1===d.nodeType&&!Y.hasClass(d,n[0])&&!Y.hasClass(d,a[0])&&!Y.hasClass(d,o[0])){var h=d.getAttribute("data-date"),m=d.getAttribute("data-month"),g=d.getAttribute("data-year"),y=g+"-"+m+"-"+h;u[y]={isSelected:s,value:new Date(g,m,h)},c.push(y)}}if(c&&c.length>0)b(e),x(e,c,s),p(e),v(e)}function v(e){for(var t=e.rowTagNum,i=j.getId(e,"row-select"),n=Y.g(j.getId(e,"month-title-0")),r=j.getPartClasses(e,"month-row-select-selected"),a=0,o=0;t>o;o++){var s=Y.g(i+"-"+o);if(Y.hasClass(s,r[0]))a++}if(a===t)j.addPartClasses(e,"month-select-all-selected",n);else j.removePartClasses(e,"month-select-all-selected",n)}function y(e){for(var t=e.rowTagNum,i=j.getId(e,"row-select"),n=0;t>n;n++){var r=Y.g(i+"-"+n);j.removePartClasses(e,"month-row-select-selected",r),g(e,r)}}function b(e){var t=[];for(var i in e.viewValue)if(e.viewValue[i].isSelected)t.push(e.viewValue[i].value);t.sort(function(e,t){return e-t}),e.rawValue=t,e.fire("change")}function x(e,t,i){if(i)C(e,t);else w(e,t)}function w(e,t){for(var i=e,n=0;n<t.length;n++){var r=j.getId(e,t[n]),a=Y.g(r);if(a)Y.removeClasses(a,j.getPartClasses(i,"month-item-selected"))}}function C(e,t){for(var i=e,n=0;n<t.length;n++){var r=j.getId(e,t[n]),a=Y.g(r);if(a)Y.addClasses(a,j.getPartClasses(i,"month-item-selected"))}}function k(e,t,i){if(!t)return!1;var n=j.getPartClasses(e,i);if(Y.hasClass(t,n[0]))return j.removePartClasses(e,i,t),!1;else return j.addPartClasses(e,i,t),!0}function _(e,t){var i=t.getAttribute("data-date"),n=t.getAttribute("data-month"),r=t.getAttribute("data-year"),a=r+"-"+n+"-"+i;if("multi"===e.mode){var o=k(e,t,"month-item-selected");e.viewValue[a]={isSelected:o,value:new Date(r,n,i)},b(e);var s=t.parentNode.firstChild;f(e,s),p(e),v(e)}else{var l=j.getPartClasses(e,"month-item-selected");if(Y.hasClass(t,l[0]))return;var u=new Date(r,n,i);S(e,e.rawValue,u),e.rawValue=u,e.fire("change"),e.fire("itemclick")}}function T(e,t,i){var n=e,r=n.viewRange||n.range,a=12*r.begin.getFullYear()+r.begin.getMonth(),o=12*r.end.getFullYear()+r.end.getMonth(),s=12*t+i,l=new Date(t,i,1);if(i=l.getMonth(),a-s>0)i+=a-s;else if(s-o>0)i-=s-o;return l.setMonth(i),i=l.getMonth(),t=l.getFullYear(),{year:t,month:i}}function M(e,i,n){if(null==i)i=e.year;if(null==n)n=e.month;var r=e,a=T(r,i,n);r.month=a.month,r.year=a.year;var o=r.getChild("yearSel"),s=o.getValue();if(o.setProperties({datasource:t(r),value:r.year}),+s===r.year)o.fire("change")}function S(e,t,i){if(t!==i){if(t){var n=Y.g(a(e,t));if(n)k(e,n,"month-item-selected")}var r=Y.g(a(e,i));if(r)if(l(e,r))k(e,r,"month-item-selected");else return e.rawValue=null,null}return i}function L(e){var t=new Date(e.year,e.month,1),i=F(t).add("month",1);M(e,i.year(),i.month())}function D(e){var t=new Date(e.year,e.month,1),i=F(t).subtract("month",1);M(e,i.year(),i.month())}function P(e,t){var n=parseInt(t.getValue(),10);e.year=n;var r=e.month,a=T(e,n,r);r=a.month,e.month=r;var o=e.getChild("monthSel"),s=o.setProperties({datasource:i(e,e.year),value:e.month});if(!s.hasOwnProperty("rawValue"))A(e,o);e.fire("changeyear")}function A(e,t){var i=parseInt(t.getValue(),10);e.month=i,E(e),e.fire("changemonth")}function E(e){var t=j.getId(e,"monthMain"),i=Y.g(t);i.innerHTML=r(e);var n=i.getElementsByTagName("tr"),a=n[n.length-1];j.addPartClasses(e,"last-row",a),R(e)}function I(e){var t,i;if("string"==typeof e){var n=e.split(",");t=O(n[0]),i=O(n[1])}else t=e.begin,i=e.end;if(t>i)return{begin:i,end:t};else return{begin:t,end:i}}function O(e){function t(e){var t=e.split("-");if(t)return new Date(parseInt(t[0],10),parseInt(t[1],10)-1,parseInt(t[2],10));else return null}e+="";var i=e.split(" "),n=t(i[0]);if(i[1]){var r=i[1].split(":");n.setHours(r[0]),n.setMinutes(r[1]),n.setSeconds(r[2])}return n}function N(e,t){if("single"===t)return O(e);else{for(var i=e.split(","),n=[],r=0;r<i.length-1;r+=2){var a,o=O(i[r]),s=O(i[r+1]);if(o&&s)if(o-s===0)n.push(o);else for(a=o;s>=a;)n.push(a),a=new Date(a.getFullYear(),a.getMonth(),a.getDate()+1);else;}return n}}function R(e){if("multi"!==e.mode)return void S(e,null,e.rawValue);var t=e.viewValue;for(var i in t){var n=Y.g(j.getId(e,i));if(n){var r=l(e,n);if(1===r)if(t[i].isSelected)j.addPartClasses(e,"month-item-selected",n);else j.removePartClasses(e,"month-item-selected",n);else if(0===r)t[i].isSelected=!1,b(e)}}c(e),p(e),v(e)}function H(e,t,i){var n=e.helper.getPartClasses(t+"-layer"),r=i.layer;r.addCustomClasses(n),e.fire("selectlayerrendered",{layer:r})}require("./Button"),require("./Select"),require("./Panel");var Y=require("./lib"),j=require("./controlHelper"),z=require("./Control"),B=require("./main"),F=require("moment");return e.prototype={type:"MonthView",initOptions:function(e){var t={range:{begin:new Date(1982,10,4),end:new Date(2046,10,4)},dateFormat:"YYYY-MM-DD",paramFormat:"YYYY-MM-DD",viewValue:{},mode:"single"};Y.extend(t,e),this.setProperties(t)},setProperties:function(e){if(e.range)e.range=I(e.range);var t=new Date,i=e.mode||this.mode;if(null==e.rawValue)if(e.value)e.rawValue=N(e.value,i);else if(null==this.rawValue)if("single"===i)e.rawValue=t;else e.rawValue=[];var n=e.year,r=e.month;if(!n&&null==r)if("single"===i){if(e.rawValue)n=e.rawValue.getFullYear(),r=e.rawValue.getMonth()+1}else n=t.getFullYear(),r=t.getMonth()+1;if(n&&r)e.year=parseInt(n,10),e.month=parseInt(r,10)-1;else if(e.hasOwnProperty("year")){if(null==this.month)delete e.year}else if(e.hasOwnProperty("month"))if(null==this.year)delete e.month;else e.month=parseInt(r,10)-1;var a=z.prototype.setProperties.apply(this,arguments);if(a.hasOwnProperty("rawValue"))this.fire("change");return a},initStructure:function(){if(this.main.innerHTML=n(this),this.initChildren(this.main),"multi"===this.mode)this.addState("multi-select")},initEvents:function(){var e=this.getChild("monthBack");e.on("click",Y.curry(D,this));var t=this.getChild("monthForward");t.on("click",Y.curry(L,this));var i=this.getChild("monthSel");i.on("change",Y.curry(A,this,i)),i.on("layerrendered",Y.curry(H,this,"month-select"));var n=this.getChild("yearSel");n.on("change",Y.curry(P,this,n)),n.on("layerrendered",Y.curry(H,this,"year-select"));var r=this.helper.getPart("monthMain");j.addDOMEvent(this,r,"click",o)},repaint:j.createRepaint(z.prototype.repaint,{name:["range","rawValue","year","month"],paint:function(e,t,i,n,r){if(i)if("multi"===e.mode)s(e);M(e,e.year,e.month)}},{name:"disabled",paint:function(e,t){var i=e.getChild("monthBack");i.setProperties({disabled:t});var n=e.getChild("monthForward");n.setProperties({disabled:t});var r=e.getChild("monthSel");r.setProperties({disabled:t});var a=e.getChild("yearSel");a.setProperties({disabled:t})}}),disable:function(){this.setProperties({disabled:!0}),this.addState("disabled")},enable:function(){this.setProperties({disabled:!1}),this.removeState("disabled")},setRange:function(e){this.setProperties({range:e})},setRawValue:function(e){this.setProperties({rawValue:e})},getRawValue:function(){return this.rawValue},getValue:function(){return this.stringifyValue(this.rawValue)},stringifyValue:function(e){if("single"===this.mode)return Y.date.format(e,this.paramFormat)||"";else{for(var t=[],i=864e5,n=0;n<e.length;n++)if(0===n)t.push(Y.date.format(e[n],this.paramFormat));else if(e[n]-e[n-1]>i)t.push(Y.date.format(e[n-1],this.paramFormat)),t.push(Y.date.format(e[n],this.paramFormat));else if(n===e.length-1)t.push(Y.date.format(e[n],this.paramFormat));else continue;return t.join(",")}},parseValue:function(e){return N(e,this.mode)},setRawValueWithoutFireChange:function(e){this.rawValue=e,s(this)},getDateItemHTML:function(e){return Y.g(a(this,e))}},Y.inherits(e,z),B.register(e),e}),define("esui/Calendar",["require","./MonthView","underscore","moment","./lib","./main","./InputControl","./Layer","./painters"],function(require){function e(){u.apply(this,arguments)}function t(){l.apply(this,arguments),this.layer=new e(this)}function i(){var e=this.getChild("monthView"),t=e.getRawValue();if(t)this.rawValue=t,n(this),this.fire("change")}function n(e){var t=e.helper.getPart("text");t.innerHTML=r.escape(e.getValue())}require("./MonthView");var r=require("underscore"),a=require("moment"),o=require("./lib"),s=require("./main"),l=require("./InputControl"),u=require("./Layer");return o.inherits(e,u),e.prototype.render=function(e){document.body.appendChild(e),e.innerHTML='<div data-ui-type="MonthView" data-ui-child-name="monthView"></div>';var t=this.control;t.helper.initChildren(e);var n=t.getChild("monthView");if(n.setProperties({rawValue:t.rawValue,range:t.range}),n.on("change",i,t),t.autoHideLayer)n.on("itemclick",r.bind(t.layer.toggle,t.layer))},e.prototype.toggle=function(){var e=this.getElement();if(!e||this.control.helper.isPart(e,"layer-hidden")){var t=this.control,i=t.getChild("monthView");i.setProperties({rawValue:t.rawValue,range:t.range}),this.show()}else this.hide()},t.prototype={type:"Calendar",initOptions:function(e){var t=new Date,i={range:{begin:new Date(1983,8,3),end:new Date(2046,10,4)},dateFormat:"YYYY-MM-DD",paramFormat:"YYYY-MM-DD",rawValue:t,autoHideLayer:!1};if(r.extend(i,e),"false"===e.autoHideLayer)i.autoHideLayer=!1;if(o.isInput(this.main))this.helper.extractOptionsFromInput(this.main,i);if(this.paramFormat=i.paramFormat,e.value)i.rawValue=this.parseValue(i.value);var n=i.range;if("string"==typeof n){var a=n.split(","),s=this.parseValue(a[0]),l=this.parseValue(a[1]);i.range={begin:s,end:l}}this.setProperties(i)},initStructure:function(){if(o.isInput(this.main))this.helper.replaceMain();var e=['<div class="${classes}" id="${id}">${value}</div>','<div class="${arrow}"></div>'];this.main.innerHTML=o.format(e.join(""),{classes:this.helper.getPartClassName("text"),id:this.helper.getId("text"),arrow:this.helper.getPartClassName("arrow")})},initEvents:function(){this.helper.addDOMEvent(this.main,"click",r.bind(this.layer.toggle,this.layer))},repaint:require("./painters").createRepaint(l.prototype.repaint,{name:["rawValue","range"],paint:function(e,t,i){n(e);var r=e.getChild("monthView");if(r)r.setProperties({rawValue:t,range:i})}},{name:["disabled","hidden","readOnly"],paint:function(e,t,i,n){if(t||i||n)e.layer.hide()}}),setRange:function(e){this.setProperties({range:e})},stringifyValue:function(e){return a(e).format(this.dateFormat)||""},parseValue:function(e){var t=a(e,this.paramFormat).toDate();return t},dispose:function(){if(!this.helper.isInStage("DISPOSED")){if(this.layer)this.layer.dispose(),this.layer=null;l.prototype.dispose.apply(this,arguments)}}},o.inherits(t,l),s.register(t),t}),define("esui/painters",["require","underscore","./lib"],function(require){var e=require("underscore"),t=require("./lib"),i={};i.state=function(e){return{name:e,paint:function(e,t){var i=t?"addState":"removeState";e[i](this.name)}}},i.attribute=function(e,t,i){return{name:e,attribute:t||e,value:i,paint:function(e,t){var i=null!=this.value&&"object"==typeof this.value?this.value:{defaultValue:this.value};if(t=null==t?i.defaultValue:t,t=null==t?"":t,i.forceRemove&&t===!1)e.main.removeAttribute(this.attribute);else e.main.setAttribute(this.attribute,t)}}};var n={width:!0,height:!0,top:!0,right:!0,bottom:!0,left:!0,fontSize:!0,padding:!0,paddingTop:!0,paddingRight:!0,paddingBottom:!0,paddingLeft:!0,margin:!0,marginTop:!0,marginRight:!0,marginBottom:!0,marginLeft:!0,borderWidth:!0,borderTopWidth:!0,borderRightWidth:!0,borderBottomWidth:!0,borderLeftWidth:!0};return i.style=function(e,t){return{name:e,property:t||e,paint:function(e,t){if(null!=t){if(n.hasOwnProperty(this.property))t=0===t?"0":t+"px";e.main.style[this.property]=t}}}},i.html=function(e,t,i){return{name:e,element:t||"",generate:i,paint:function(e,t){var i="function"==typeof this.element?this.element(e):this.element?e.helper.getPart(this.element):e.main;if(i){var n="function"==typeof this.generate?this.generate(e,t):t;i.innerHTML=n||""}}}},i.text=function(t,i,n){return{name:t,element:i||"",generate:n,paint:function(t,i){var n="function"==typeof this.element?this.element(t):this.element?t.helper.getPart(this.element):t.main;if(n){var r="function"==typeof this.generate?this.generate(t,i):i;n.innerHTML=e.escape(r||"")}}}},i.delegate=function(e,t,i){return{name:e,member:this.member,method:this.method,paint:function(e,t){e[this.member][this.method](t)}}},i.createRepaint=function(){var e=[].concat.apply([],[].slice.call(arguments));return function(i,n){for(var r=t.extend({},n),a=0;a<e.length;a++){var o=e[a];if("function"!=typeof o){var s=[].concat(o.name),l=!i;if(!l)for(var u=0;u<s.length;u++){var c=s[u];if(n.hasOwnProperty(c)){l=!0;break}}if(l){for(var f=[this],u=0;u<s.length;u++){var c=s[u];f.push(this[c]),delete r[c]}try{o.paint.apply(o,f)}catch(d){var h='"'+s.join('", "')+'"',p=new Error("Failed to paint ["+h+'] for control "'+(this.id||"anonymous")+'" of type '+this.type+" because: "+d.message);throw p.actualError=d,p}}else;}else o.apply(this,arguments)}var m=[];for(var g in r)if(r.hasOwnProperty(g))m.push(r[g]);return m}},i}),define("esui/Button",["require","underscore","./lib","./painters","./Control","./main"],function(require){function e(e){a.apply(this,arguments)}function t(e){var t={};return t.borderTop=parseInt(n.getComputedStyle(e,"borderTopWidth"),10),t.borderBottom=parseInt(n.getComputedStyle(e,"borderBottomWidth"),10),t}var i=require("underscore"),n=require("./lib"),r=require("./painters"),a=require("./Control");return e.prototype={type:"Button",initOptions:function(e){var t={content:"",disabled:!1};if(i.extend(t,e),t.tagName=this.main.nodeName.toLowerCase(),null==t.text)t.text=n.getText(this.main);var r=this.main.firstChild;if(!t.content&&r&&"div"!==r.nodeName.toLowerCase())t.content=this.main.innerHTML;this.setProperties(t)},createMain:function(){var e=document.createElement("div");return e.innerHTML='<button type="button"></button>',e.firstChild},initEvents:function(){this.helper.delegateDOMEvent(this.main,"click")},repaint:r.createRepaint(a.prototype.repaint,r.style("width"),{name:"height",paint:function(e,i){if(i){var n=e.main;n.style.height=i+"px";var r=i;n.style.lineHeight=r+"px";var a=n.offsetHeight;if(a===i){var o=t(n),s=i+o.borderTop+o.borderBottom;n.style.height=s+"px"}}}},r.html("content"),{name:"disabled",paint:function(e,t){var i=e.main.nodeName.toLowerCase();if("button"===i||"input"===i)e.main.disabled=!!t}}),setContent:function(e){this.setProperties({content:e})}},n.inherits(e,a),require("./main").register(e),e}),define("esui/lib/string",["require","underscore"],function(require){var e=require("underscore"),t={},i=/^[\s\xa0\u3000]+|[\u3000\xa0\s]+$/g;return t.trim=function(e){if(!e)return"";else return String(e).replace(i,"")},t.format=function(e,t){if(!e)return"";if(null==t)return e;else return e.replace(/\$\{(.+?)\}/g,function(e,i){var n=t[i];if("function"==typeof n)n=n(i);return null==n?"":n})},t.camelize=function(e){if(!e)return"";else return e.replace(/-([a-z])/g,function(e,t){return t.toUpperCase()})},t.pascalize=function(e){if(!e)return"";else return e.charAt(0).toUpperCase()+t.camelize(e.slice(1))},t.splitTokenList=function(i){if(!i)return[];if(!e.isArray(i))return e.chain(i.split(/[,\s]/)).map(t.trim).compact().value()},t}),define("esui/lib/dom",["require","underscore","./string"],function(require){var e=require("underscore"),t=require("./string"),i={};return i.g=function(e){if(!e)return null;else return"string"==typeof e?document.getElementById(e):e},i.isInput=function(e){var t=e.nodeName.toLowerCase();return"input"===t||"select"===t||"textarea"===t},i.removeNode=function(e){if("string"==typeof e)e=i.g(e);if(e){var t=e.parentNode;if(t)t.removeChild(e)}},i.insertAfter=function(e,t){var i=t.parentNode;if(i)i.insertBefore(e,t.nextSibling);return e},i.insertBefore=function(e,t){var i=t.parentNode;if(i)i.insertBefore(e,t);return e},i.getChildren=function(t){return e.filter(t.children,function(e){return 1===e.nodeType})},i.getComputedStyle=function(e,t){if(!e)return"";var i=9===e.nodeType?e:e.ownerDocument||e.document;if(i.defaultView&&i.defaultView.getComputedStyle){var n=i.defaultView.getComputedStyle(e,null);if(n)return n[t]||n.getPropertyValue(t)}else if(e&&e.currentStyle)return e.currentStyle[t];return""},i.getStyle=function(e,n){return n=t.camelize(n),e.style[n]||(e.currentStyle?e.currentStyle[n]:"")||i.getComputedStyle(e,n)},i.getOffset=function(e){var t=e.getBoundingClientRect(),i={top:t.top,right:t.right,bottom:t.bottom,left:t.left,width:t.right-t.left,height:t.bottom-t.top},n=document.documentElement.clientTop||document.body.clientTop||0,r=document.documentElement.clientLeft||document.body.clientLeft||0,a=window.pageYOffset||document.documentElement.scrollTop,o=window.pageXOffset||document.documentElement.scrollLeft;return i.top=i.top+a-n,i.bottom=i.bottom+a-n,i.left=i.left+o-r,i.right=i.right+o-r,i},i.getText=function(t){var n="";if(3===t.nodeType||4===t.nodeType)n+=t.nodeValue;else if(8!==t.nodeType)e.each(t.childNodes,function(e){n+=i.getText(e)});return n},i.dom={},i.dom.first=function(e){if(e=i.g(e),e.firstElementChild)return e.firstElementChild;for(var t=e.firstChild;t;t=t.nextSibling)if(1===t.nodeType)return t;return null},i.dom.last=function(e){if(e=i.g(e),e.lastElementChild)return e.lastElementChild;for(var t=e.lastChild;t;t=t.previousSibling)if(1===t.nodeType)return t;
return null},i.dom.next=function(e){if(e=i.g(e),e.nextElementSibling)return e.nextElementSibling;for(var t=e.nextSibling;t;t=t.nextSibling)if(1===t.nodeType)return t;return null},i.dom.contains=function(e,t){return e=i.g(e),t=i.g(t),e.contains?e!==t&&e.contains(t):!!(16&e.compareDocumentPosition(t))},i}),define("esui/lib/attribute",["require","./dom"],function(require){var e=require("./dom"),t={};t.hasAttribute=function(e,t){if(e.hasAttribute)return e.hasAttribute(t);else return e.attributes&&e.attributes[t]&&e.attributes[t].specified};var i=function(){var e={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",rowspan:"rowSpan",valign:"vAlign",usemap:"useMap",frameborder:"frameBorder"},t=document.createElement("div");t.innerHTML='<label for="test" class="test"></label>';var i=t.getElementsByTagName("label")[0];if("test"===i.getAttribute("className"))e["class"]="className";else e.className="class";if("test"===i.getAttribute("for"))e.htmlFor="for";else e["for"]="htmlFor";return e}();return t.setAttribute=function(t,n,r){if(t=e.g(t),"style"===n)t.style.cssText=r;else n=i[n]||n,t.setAttribute(n,r);return t},t.getAttribute=function(t,n){if(t=e.g(t),"style"===n)return t.style.cssText;else return n=i[n]||n,t.getAttribute(n)},t.removeAttribute=function(t,n){t=e.g(t),n=i[n]||n,t.removeAttribute(n)},t}),define("esui/lib",["require","underscore","./lib/attribute","./lib/class","./lib/date","./lib/dom","./lib/event","./lib/lang","./lib/page","./lib/string"],function(require){var e={},t=require("underscore");if(/msie (\d+\.\d+)/i.test(navigator.userAgent))e.ie=document.documentMode||+RegExp.$1;return t.extend(e,require("./lib/attribute"),require("./lib/class"),require("./lib/date"),require("./lib/dom"),require("./lib/event"),require("./lib/lang"),require("./lib/page"),require("./lib/string")),e}),define("esui/BoxGroup",["require","underscore","./lib","./InputControl","./painters","./main"],function(require){function e(){s.apply(this,arguments)}function t(e,t){for(var i=e.getElementsByTagName("input"),n=e.getElementsByTagName("label"),r={},a=n.length-1;a>=0;a--){var s=n[a],l=o.getAttribute(s,"for");if(l)r[l]=s}for(var u=[],c=[],a=0,f=i.length;f>a;a++){var d=i[a];if(d.type===t.boxType&&(t.name||"")===d.name){var h={value:d.value},s=d.id&&r[d.id];if(h.title=s?o.getText(s):"",!h.title)h.title=d.title||("on"===d.value?d.value:"");if(u.push(h),null!==d.getAttribute("checked"))c.push(d.value)}}if(t.datasource=u,!t.rawValue&&!t.value)t.rawValue=c}function i(e){var t=e.parentNode,i=this.helper.getPartClasses("wrapper-checked");if(e.checked)o.addClasses(t,i);else o.removeClasses(t,i)}function n(){a.each(this.getBoxElements(),i,this);var e=a.chain(this.getBoxElements()).where({checked:!0}).pluck("value").value();this.rawValue=e,this.fire("change")}function r(e,t,i){e.helper.clearDOMEvents();for(var r="",s=[].concat(e.helper.getPartClasses(i),e.helper.getPartClasses("wrapper")),u=o.toDictionary(e.rawValue),c=e.name||o.getGUID(),f=0;f<t.length;f++){var d=t[f],h="";if(u[d.value])h+=" "+e.helper.getPartClassName("wrapper-checked");var p={wrapperClass:s.join(" ")+h,id:e.helper.getId("box-"+f),type:e.boxType,name:c,title:o.trim(d.title||d.name||d.text),value:d.value,checked:u[d.value]?' checked="checked"':""};r+=o.format(l,p)}e.main.innerHTML=r;var m=e.main.addEventListener?"change":"click";a.each(e.getBoxElements(),function(e){this.helper.addDOMEvent(e,m,n)},e)}var a=require("underscore"),o=require("./lib"),s=require("./InputControl");e.prototype.type="BoxGroup",e.prototype.initOptions=function(e){var i={datasource:[],orientation:"horizontal",boxType:"radio"};a.extend(i,e);var n=i.datasource;if(!n.length)t(this.main,i);if(!i.hasOwnProperty("rawValue")&&!i.hasOwnProperty("value"))if("radio"===i.boxType&&n.length)i.rawValue=[n[0].value];else i.rawValue=[];this.setProperties(i)};var l=['<label title="${title}" class="${wrapperClass}">','    <input type="${type}" name="${name}" id="${id}" title="${title}" value="${value}"${checked} />',"    <span>${title}</span>","</label>"];return l=l.join(""),e.prototype.setProperties=function(e){if((e.datasource||e.boxType)&&!e.rawValue&&!e.value&&(!this.rawValue||!this.rawValue.length))e.rawValue=[];var t=s.prototype.setProperties.apply(this,arguments);if(t.hasOwnProperty("rawValue"))this.fire("change")},e.prototype.repaint=require("./painters").createRepaint(s.prototype.repaint,{name:["datasource","boxType"],paint:r},{name:["disabled","readOnly"],paint:function(e,t,i){a.each(e.getBoxElements(),function(e){e.disabled=t,e.readOnly=i})}},{name:"rawValue",paint:function(e,t){t=t||[],e.rawValue=t;for(var n={},r=0;r<t.length;r++)n[t[r]]=!0;a.each(e.getBoxElements(),function(t){t.checked=n.hasOwnProperty(t.value),i.call(e,t)})}},{name:"orientation",paint:function(e,t){e.removeState("vertical"),e.removeState("horizontal"),e.addState(t)}}),e.prototype.parseValue=function(e){return e.split(",")},e.prototype.getBoxElements=function(){return a.where(this.main.getElementsByTagName("input"),{type:this.boxType})},o.inherits(e,s),require("./main").register(e),e}),function(){function e(e){function t(t,i,n,r,a,o){for(;a>=0&&o>a;a+=e){var s=r?r[a]:a;n=i(n,t[s],s,t)}return n}return function(i,n,r,a){n=y(n,a,4);var o=!k(i)&&v.keys(i),s=(o||i).length,l=e>0?0:s-1;if(arguments.length<3)r=i[o?o[l]:l],l+=e;return t(i,n,r,o,l,s)}}function t(e){return function(t,i,n){i=b(i,n);for(var r=null!=t&&t.length,a=e>0?0:r-1;a>=0&&r>a;a+=e)if(i(t[a],a,t))return a;return-1}}function i(e,t){var i=L.length,n=e.constructor,r=v.isFunction(n)&&n.prototype||o,a="constructor";if(v.has(e,a)&&!v.contains(t,a))t.push(a);for(;i--;)if(a=L[i],a in e&&e[a]!==r[a]&&!v.contains(t,a))t.push(a)}var n=this,r=n._,a=Array.prototype,o=Object.prototype,s=Function.prototype,l=a.push,u=a.slice,c=o.toString,f=o.hasOwnProperty,d=Array.isArray,h=Object.keys,p=s.bind,m=Object.create,g=function(){},v=function(e){if(e instanceof v)return e;if(!(this instanceof v))return new v(e);else return void(this._wrapped=e)};if("undefined"!=typeof exports){if("undefined"!=typeof module&&module.exports)exports=module.exports=v;exports._=v}else n._=v;v.VERSION="1.8.2";var y=function(e,t,i){if(void 0===t)return e;switch(null==i?3:i){case 1:return function(i){return e.call(t,i)};case 2:return function(i,n){return e.call(t,i,n)};case 3:return function(i,n,r){return e.call(t,i,n,r)};case 4:return function(i,n,r,a){return e.call(t,i,n,r,a)}}return function(){return e.apply(t,arguments)}},b=function(e,t,i){if(null==e)return v.identity;if(v.isFunction(e))return y(e,t,i);if(v.isObject(e))return v.matcher(e);else return v.property(e)};v.iteratee=function(e,t){return b(e,t,1/0)};var x=function(e,t){return function(i){var n=arguments.length;if(2>n||null==i)return i;for(var r=1;n>r;r++)for(var a=arguments[r],o=e(a),s=o.length,l=0;s>l;l++){var u=o[l];if(!t||void 0===i[u])i[u]=a[u]}return i}},w=function(e){if(!v.isObject(e))return{};if(m)return m(e);g.prototype=e;var t=new g;return g.prototype=null,t},C=Math.pow(2,53)-1,k=function(e){var t=e&&e.length;return"number"==typeof t&&t>=0&&C>=t};v.each=v.forEach=function(e,t,i){t=y(t,i);var n,r;if(k(e))for(n=0,r=e.length;r>n;n++)t(e[n],n,e);else{var a=v.keys(e);for(n=0,r=a.length;r>n;n++)t(e[a[n]],a[n],e)}return e},v.map=v.collect=function(e,t,i){t=b(t,i);for(var n=!k(e)&&v.keys(e),r=(n||e).length,a=Array(r),o=0;r>o;o++){var s=n?n[o]:o;a[o]=t(e[s],s,e)}return a},v.reduce=v.foldl=v.inject=e(1),v.reduceRight=v.foldr=e(-1),v.find=v.detect=function(e,t,i){var n;if(k(e))n=v.findIndex(e,t,i);else n=v.findKey(e,t,i);if(void 0!==n&&-1!==n)return e[n];else return void 0},v.filter=v.select=function(e,t,i){var n=[];return t=b(t,i),v.each(e,function(e,i,r){if(t(e,i,r))n.push(e)}),n},v.reject=function(e,t,i){return v.filter(e,v.negate(b(t)),i)},v.every=v.all=function(e,t,i){t=b(t,i);for(var n=!k(e)&&v.keys(e),r=(n||e).length,a=0;r>a;a++){var o=n?n[a]:a;if(!t(e[o],o,e))return!1}return!0},v.some=v.any=function(e,t,i){t=b(t,i);for(var n=!k(e)&&v.keys(e),r=(n||e).length,a=0;r>a;a++){var o=n?n[a]:a;if(t(e[o],o,e))return!0}return!1},v.contains=v.includes=v.include=function(e,t,i){if(!k(e))e=v.values(e);return v.indexOf(e,t,"number"==typeof i&&i)>=0},v.invoke=function(e,t){var i=u.call(arguments,2),n=v.isFunction(t);return v.map(e,function(e){var r=n?t:e[t];return null==r?r:r.apply(e,i)})},v.pluck=function(e,t){return v.map(e,v.property(t))},v.where=function(e,t){return v.filter(e,v.matcher(t))},v.findWhere=function(e,t){return v.find(e,v.matcher(t))},v.max=function(e,t,i){var n,r,a=-(1/0),o=-(1/0);if(null==t&&null!=e){e=k(e)?e:v.values(e);for(var s=0,l=e.length;l>s;s++)if(n=e[s],n>a)a=n}else t=b(t,i),v.each(e,function(e,i,n){if(r=t(e,i,n),r>o||r===-(1/0)&&a===-(1/0))a=e,o=r});return a},v.min=function(e,t,i){var n,r,a=1/0,o=1/0;if(null==t&&null!=e){e=k(e)?e:v.values(e);for(var s=0,l=e.length;l>s;s++)if(n=e[s],a>n)a=n}else t=b(t,i),v.each(e,function(e,i,n){if(r=t(e,i,n),o>r||r===1/0&&a===1/0)a=e,o=r});return a},v.shuffle=function(e){for(var t,i=k(e)?e:v.values(e),n=i.length,r=Array(n),a=0;n>a;a++){if(t=v.random(0,a),t!==a)r[a]=r[t];r[t]=i[a]}return r},v.sample=function(e,t,i){if(null==t||i){if(!k(e))e=v.values(e);return e[v.random(e.length-1)]}return v.shuffle(e).slice(0,Math.max(0,t))},v.sortBy=function(e,t,i){return t=b(t,i),v.pluck(v.map(e,function(e,i,n){return{value:e,index:i,criteria:t(e,i,n)}}).sort(function(e,t){var i=e.criteria,n=t.criteria;if(i!==n){if(i>n||void 0===i)return 1;if(n>i||void 0===n)return-1}return e.index-t.index}),"value")};var _=function(e){return function(t,i,n){var r={};return i=b(i,n),v.each(t,function(n,a){var o=i(n,a,t);e(r,n,o)}),r}};v.groupBy=_(function(e,t,i){if(v.has(e,i))e[i].push(t);else e[i]=[t]}),v.indexBy=_(function(e,t,i){e[i]=t}),v.countBy=_(function(e,t,i){if(v.has(e,i))e[i]++;else e[i]=1}),v.toArray=function(e){if(!e)return[];if(v.isArray(e))return u.call(e);if(k(e))return v.map(e,v.identity);else return v.values(e)},v.size=function(e){if(null==e)return 0;else return k(e)?e.length:v.keys(e).length},v.partition=function(e,t,i){t=b(t,i);var n=[],r=[];return v.each(e,function(e,i,a){(t(e,i,a)?n:r).push(e)}),[n,r]},v.first=v.head=v.take=function(e,t,i){if(null==e)return void 0;if(null==t||i)return e[0];else return v.initial(e,e.length-t)},v.initial=function(e,t,i){return u.call(e,0,Math.max(0,e.length-(null==t||i?1:t)))},v.last=function(e,t,i){if(null==e)return void 0;if(null==t||i)return e[e.length-1];else return v.rest(e,Math.max(0,e.length-t))},v.rest=v.tail=v.drop=function(e,t,i){return u.call(e,null==t||i?1:t)},v.compact=function(e){return v.filter(e,v.identity)};var T=function(e,t,i,n){for(var r=[],a=0,o=n||0,s=e&&e.length;s>o;o++){var l=e[o];if(k(l)&&(v.isArray(l)||v.isArguments(l))){if(!t)l=T(l,t,i);var u=0,c=l.length;for(r.length+=c;c>u;)r[a++]=l[u++]}else if(!i)r[a++]=l}return r};v.flatten=function(e,t){return T(e,t,!1)},v.without=function(e){return v.difference(e,u.call(arguments,1))},v.uniq=v.unique=function(e,t,i,n){if(null==e)return[];if(!v.isBoolean(t))n=i,i=t,t=!1;if(null!=i)i=b(i,n);for(var r=[],a=[],o=0,s=e.length;s>o;o++){var l=e[o],u=i?i(l,o,e):l;if(t){if(!o||a!==u)r.push(l);a=u}else if(i){if(!v.contains(a,u))a.push(u),r.push(l)}else if(!v.contains(r,l))r.push(l)}return r},v.union=function(){return v.uniq(T(arguments,!0,!0))},v.intersection=function(e){if(null==e)return[];for(var t=[],i=arguments.length,n=0,r=e.length;r>n;n++){var a=e[n];if(!v.contains(t,a)){for(var o=1;i>o&&v.contains(arguments[o],a);o++);if(o===i)t.push(a)}else;}return t},v.difference=function(e){var t=T(arguments,!0,!0,1);return v.filter(e,function(e){return!v.contains(t,e)})},v.zip=function(){return v.unzip(arguments)},v.unzip=function(e){for(var t=e&&v.max(e,"length").length||0,i=Array(t),n=0;t>n;n++)i[n]=v.pluck(e,n);return i},v.object=function(e,t){for(var i={},n=0,r=e&&e.length;r>n;n++)if(t)i[e[n]]=t[n];else i[e[n][0]]=e[n][1];return i},v.indexOf=function(e,t,i){var n=0,r=e&&e.length;if("number"==typeof i)n=0>i?Math.max(0,r+i):i;else if(i&&r)return n=v.sortedIndex(e,t),e[n]===t?n:-1;if(t!==t)return v.findIndex(u.call(e,n),v.isNaN);for(;r>n;n++)if(e[n]===t)return n;return-1},v.lastIndexOf=function(e,t,i){var n=e?e.length:0;if("number"==typeof i)n=0>i?n+i+1:Math.min(n,i+1);if(t!==t)return v.findLastIndex(u.call(e,0,n),v.isNaN);for(;--n>=0;)if(e[n]===t)return n;return-1},v.findIndex=t(1),v.findLastIndex=t(-1),v.sortedIndex=function(e,t,i,n){i=b(i,n,1);for(var r=i(t),a=0,o=e.length;o>a;){var s=Math.floor((a+o)/2);if(i(e[s])<r)a=s+1;else o=s}return a},v.range=function(e,t,i){if(arguments.length<=1)t=e||0,e=0;i=i||1;for(var n=Math.max(Math.ceil((t-e)/i),0),r=Array(n),a=0;n>a;a++,e+=i)r[a]=e;return r};var M=function(e,t,i,n,r){if(!(n instanceof t))return e.apply(i,r);var a=w(e.prototype),o=e.apply(a,r);if(v.isObject(o))return o;else return a};v.bind=function(e,t){if(p&&e.bind===p)return p.apply(e,u.call(arguments,1));if(!v.isFunction(e))throw new TypeError("Bind must be called on a function");var i=u.call(arguments,2),n=function(){return M(e,n,t,this,i.concat(u.call(arguments)))};return n},v.partial=function(e){var t=u.call(arguments,1),i=function(){for(var n=0,r=t.length,a=Array(r),o=0;r>o;o++)a[o]=t[o]===v?arguments[n++]:t[o];for(;n<arguments.length;)a.push(arguments[n++]);return M(e,i,this,this,a)};return i},v.bindAll=function(e){var t,i,n=arguments.length;if(1>=n)throw new Error("bindAll must be passed function names");for(t=1;n>t;t++)i=arguments[t],e[i]=v.bind(e[i],e);return e},v.memoize=function(e,t){var i=function(n){var r=i.cache,a=""+(t?t.apply(this,arguments):n);if(!v.has(r,a))r[a]=e.apply(this,arguments);return r[a]};return i.cache={},i},v.delay=function(e,t){var i=u.call(arguments,2);return setTimeout(function(){return e.apply(null,i)},t)},v.defer=v.partial(v.delay,v,1),v.throttle=function(e,t,i){var n,r,a,o=null,s=0;if(!i)i={};var l=function(){if(s=i.leading===!1?0:v.now(),o=null,a=e.apply(n,r),!o)n=r=null};return function(){var u=v.now();if(!s&&i.leading===!1)s=u;var c=t-(u-s);if(n=this,r=arguments,0>=c||c>t){if(o)clearTimeout(o),o=null;if(s=u,a=e.apply(n,r),!o)n=r=null}else if(!o&&i.trailing!==!1)o=setTimeout(l,c);return a}},v.debounce=function(e,t,i){var n,r,a,o,s,l=function(){var u=v.now()-o;if(t>u&&u>=0)n=setTimeout(l,t-u);else if(n=null,!i)if(s=e.apply(a,r),!n)a=r=null};return function(){a=this,r=arguments,o=v.now();var u=i&&!n;if(!n)n=setTimeout(l,t);if(u)s=e.apply(a,r),a=r=null;return s}},v.wrap=function(e,t){return v.partial(t,e)},v.negate=function(e){return function(){return!e.apply(this,arguments)}},v.compose=function(){var e=arguments,t=e.length-1;return function(){for(var i=t,n=e[t].apply(this,arguments);i--;)n=e[i].call(this,n);return n}},v.after=function(e,t){return function(){if(--e<1)return t.apply(this,arguments);else return void 0}},v.before=function(e,t){var i;return function(){if(--e>0)i=t.apply(this,arguments);if(1>=e)t=null;return i}},v.once=v.partial(v.before,2);var S=!{toString:null}.propertyIsEnumerable("toString"),L=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];v.keys=function(e){if(!v.isObject(e))return[];if(h)return h(e);var t=[];for(var n in e)if(v.has(e,n))t.push(n);if(S)i(e,t);return t},v.allKeys=function(e){if(!v.isObject(e))return[];var t=[];for(var n in e)t.push(n);if(S)i(e,t);return t},v.values=function(e){for(var t=v.keys(e),i=t.length,n=Array(i),r=0;i>r;r++)n[r]=e[t[r]];return n},v.mapObject=function(e,t,i){t=b(t,i);for(var n,r=v.keys(e),a=r.length,o={},s=0;a>s;s++)n=r[s],o[n]=t(e[n],n,e);return o},v.pairs=function(e){for(var t=v.keys(e),i=t.length,n=Array(i),r=0;i>r;r++)n[r]=[t[r],e[t[r]]];return n},v.invert=function(e){for(var t={},i=v.keys(e),n=0,r=i.length;r>n;n++)t[e[i[n]]]=i[n];return t},v.functions=v.methods=function(e){var t=[];for(var i in e)if(v.isFunction(e[i]))t.push(i);return t.sort()},v.extend=x(v.allKeys),v.extendOwn=v.assign=x(v.keys),v.findKey=function(e,t,i){t=b(t,i);for(var n,r=v.keys(e),a=0,o=r.length;o>a;a++)if(n=r[a],t(e[n],n,e))return n},v.pick=function(e,t,i){var n,r,a={},o=e;if(null==o)return a;if(v.isFunction(t))r=v.allKeys(o),n=y(t,i);else r=T(arguments,!1,!1,1),n=function(e,t,i){return t in i},o=Object(o);for(var s=0,l=r.length;l>s;s++){var u=r[s],c=o[u];if(n(c,u,o))a[u]=c}return a},v.omit=function(e,t,i){if(v.isFunction(t))t=v.negate(t);else{var n=v.map(T(arguments,!1,!1,1),String);t=function(e,t){return!v.contains(n,t)}}return v.pick(e,t,i)},v.defaults=x(v.allKeys,!0),v.clone=function(e){if(!v.isObject(e))return e;else return v.isArray(e)?e.slice():v.extend({},e)},v.tap=function(e,t){return t(e),e},v.isMatch=function(e,t){var i=v.keys(t),n=i.length;if(null==e)return!n;for(var r=Object(e),a=0;n>a;a++){var o=i[a];if(t[o]!==r[o]||!(o in r))return!1}return!0};var D=function(e,t,i,n){if(e===t)return 0!==e||1/e===1/t;if(null==e||null==t)return e===t;if(e instanceof v)e=e._wrapped;if(t instanceof v)t=t._wrapped;var r=c.call(e);if(r!==c.call(t))return!1;switch(r){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":if(+e!==+e)return+t!==+t;else return 0===+e?1/+e===1/t:+e===+t;case"[object Date]":case"[object Boolean]":return+e===+t}var a="[object Array]"===r;if(!a){if("object"!=typeof e||"object"!=typeof t)return!1;var o=e.constructor,s=t.constructor;if(o!==s&&!(v.isFunction(o)&&o instanceof o&&v.isFunction(s)&&s instanceof s)&&"constructor"in e&&"constructor"in t)return!1}i=i||[],n=n||[];for(var l=i.length;l--;)if(i[l]===e)return n[l]===t;if(i.push(e),n.push(t),a){if(l=e.length,l!==t.length)return!1;for(;l--;)if(!D(e[l],t[l],i,n))return!1}else{var u,f=v.keys(e);if(l=f.length,v.keys(t).length!==l)return!1;for(;l--;)if(u=f[l],!v.has(t,u)||!D(e[u],t[u],i,n))return!1}return i.pop(),n.pop(),!0};if(v.isEqual=function(e,t){return D(e,t)},v.isEmpty=function(e){if(null==e)return!0;if(k(e)&&(v.isArray(e)||v.isString(e)||v.isArguments(e)))return 0===e.length;else return 0===v.keys(e).length},v.isElement=function(e){return!(!e||1!==e.nodeType)},v.isArray=d||function(e){return"[object Array]"===c.call(e)},v.isObject=function(e){var t=typeof e;return"function"===t||"object"===t&&!!e},v.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(e){v["is"+e]=function(t){return c.call(t)==="[object "+e+"]"}}),!v.isArguments(arguments))v.isArguments=function(e){return v.has(e,"callee")};if("function"!=typeof/./&&"object"!=typeof Int8Array)v.isFunction=function(e){return"function"==typeof e||!1};v.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},v.isNaN=function(e){return v.isNumber(e)&&e!==+e},v.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"===c.call(e)},v.isNull=function(e){return null===e},v.isUndefined=function(e){return void 0===e},v.has=function(e,t){return null!=e&&f.call(e,t)},v.noConflict=function(){return n._=r,this},v.identity=function(e){return e},v.constant=function(e){return function(){return e}},v.noop=function(){},v.property=function(e){return function(t){return null==t?void 0:t[e]}},v.propertyOf=function(e){return null==e?function(){}:function(t){return e[t]}},v.matcher=v.matches=function(e){return e=v.extendOwn({},e),function(t){return v.isMatch(t,e)}},v.times=function(e,t,i){var n=Array(Math.max(0,e));t=y(t,i,1);for(var r=0;e>r;r++)n[r]=t(r);return n},v.random=function(e,t){if(null==t)t=e,e=0;return e+Math.floor(Math.random()*(t-e+1))},v.now=Date.now||function(){return(new Date).getTime()};var P={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},A=v.invert(P),E=function(e){var t=function(t){return e[t]},i="(?:"+v.keys(e).join("|")+")",n=RegExp(i),r=RegExp(i,"g");return function(e){return e=null==e?"":""+e,n.test(e)?e.replace(r,t):e}};v.escape=E(P),v.unescape=E(A),v.result=function(e,t,i){var n=null==e?void 0:e[t];if(void 0===n)n=i;return v.isFunction(n)?n.call(e):n};var I=0;v.uniqueId=function(e){var t=++I+"";return e?e+t:t},v.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var O=/(.)^/,N={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},R=/\\|'|\r|\n|\u2028|\u2029/g,H=function(e){return"\\"+N[e]};v.template=function(e,t,i){if(!t&&i)t=i;t=v.defaults({},t,v.templateSettings);var n=RegExp([(t.escape||O).source,(t.interpolate||O).source,(t.evaluate||O).source].join("|")+"|$","g"),r=0,a="__p+='";if(e.replace(n,function(t,i,n,o,s){if(a+=e.slice(r,s).replace(R,H),r=s+t.length,i)a+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'";else if(n)a+="'+\n((__t=("+n+"))==null?'':__t)+\n'";else if(o)a+="';\n"+o+"\n__p+='";return t}),a+="';\n",!t.variable)a="with(obj||{}){\n"+a+"}\n";a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{var o=new Function(t.variable||"obj","_",a)}catch(s){throw s.source=a,s}var l=function(e){return o.call(this,e,v)},u=t.variable||"obj";return l.source="function("+u+"){\n"+a+"}",l},v.chain=function(e){var t=v(e);return t._chain=!0,t};var Y=function(e,t){return e._chain?v(t).chain():t};if(v.mixin=function(e){v.each(v.functions(e),function(t){var i=v[t]=e[t];v.prototype[t]=function(){var e=[this._wrapped];return l.apply(e,arguments),Y(this,i.apply(v,e))}})},v.mixin(v),v.each(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=a[e];v.prototype[e]=function(){var i=this._wrapped;if(t.apply(i,arguments),("shift"===e||"splice"===e)&&0===i.length)delete i[0];return Y(this,i)}}),v.each(["concat","join","slice"],function(e){var t=a[e];v.prototype[e]=function(){return Y(this,t.apply(this._wrapped,arguments))}}),v.prototype.value=function(){return this._wrapped},v.prototype.valueOf=v.prototype.toJSON=v.prototype.value,v.prototype.toString=function(){return""+this._wrapped},"function"==typeof define&&define.amd)define("underscore/underscore",[],function(){return v})}.call(this),define("underscore",["underscore/underscore"],function(e){return e}),define("bat-ria/extension/underscore",["require","underscore"],function(require){function e(){t.mixin(i)}var t=require("underscore"),i={};return i.purify=function n(e,i,r){i=i||{};var a={};return t.each(e,function(e,t){var o=null==e||""===e,s=i.hasOwnProperty(t)&&i[t]===e;if(!o&&!s)if(r&&"object"==typeof e)a[t]=n(e,i[t],r);else a[t]=e}),a},i.filterObject=function(e,i,n){var r={};if(null==e)return r;else return t.each(e,function(t,a){if(i.call(n,t,a,e))r[a]=t}),r},i.mapObject=function(e,i,n){var r={};if(null==e)return r;else return t.each(e,function(e,t){r[t]=i.call(n,e)}),r},i.mapKey=function(e,i){var n={};if(null==e)return n;else return t.each(e,function(e,t){if(i[t])n[i[t]]=e;else n[t]=e}),n},i.trim=function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},i.pascalize=function(e){if(e+="",/^[A-Z\-_]+$/.test(e))e=e.toLowerCase();return e=e.replace(/[\s-_]+(.)/g,function(e,t){return t.toUpperCase()}),e=e.charAt(0).toUpperCase()+e.slice(1)},i.camelize=function(e){return e=i.pascalize(e),e.charAt(0).toLowerCase()+e.slice(1)},i.dasherize=function(e){e=i.pascalize(e);var t=!1;if(/[A-Z]{2,}$/.test(e))t=!0;if(e=e.replace(/[A-Z]{2,}/g,function(e){return e.charAt(0)+(t?e.slice(1).toLowerCase():e.slice(1,-1).toLowerCase()+e.charAt(e.length-1))}),e=e.replace(/[A-Z]/g,function(e){return"-"+e.toLowerCase()}),"-"===e.charAt(0))e=e.slice(1);if("-"===e.charAt(e.length-1))e=e.slice(0,-1);return e},i.constanize=function(e){return e=i.dasherize(e),e=e.replace(/-/g,"_"),e.toUpperCase()},i.pluralize=function(e){return e.replace(/y$/,"ie")+"s"},i.formatNumber=function(e,t,i,n){if("number"!=typeof arguments[1])n=arguments[2],i=arguments[1],t=0;if(n=n||"",i=i||"",null==e||isNaN(e))return n+i;e=parseFloat(e).toFixed(t);var r=e.split("."),a=r[0],o=r[1];a=a.replace(/(\d)(?=(?:\d{3})+$)/g,"$1,");var s=n+a;if(o)s+="."+o;return s},i.pad=function(e,t,i){e+="";var n=i-e.length;if(n>0){var r=new Array(n+1).join(t);return r+e}else return e},i.padRight=function(e,t,i){e+="";var n=i-e.length;if(n>0){var r=new Array(n+1).join(t);return e+r}else return e},i.deepClone=function(e){if(!t.isObject(e)||t.isFunction(e))return e;if(t.isArray(e))return t.map(e,i.deepClone);var n={};return t.each(e,function(e,t){n[t]=i.deepClone(e)}),n},i.typeOf=function(e){return Object.prototype.toString.call(e).slice(8,-1)},{activate:t.once(e)}}),define("dep",[],function(){});